<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- | Utility for 'Typeable'.</span><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Util.Typeable</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Util.Typeable.html#gcastE"><span class="hs-identifier hs-var">gcastE</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqP"><span class="hs-identifier hs-var">eqP</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqParam1"><span class="hs-identifier hs-var">eqParam1</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqParam2"><span class="hs-identifier hs-var">eqParam2</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqParam3"><span class="hs-identifier hs-var">eqParam3</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqExt"><span class="hs-identifier hs-var">eqExt</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#compareExt"><span class="hs-identifier hs-var">compareExt</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#castIgnoringPhantom"><span class="hs-identifier hs-var">castIgnoringPhantom</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Util.Typeable.html#eqTypeIgnoringPhantom"><span class="hs-identifier hs-var">eqTypeIgnoringPhantom</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-comment">-- * Re-exports</span><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">:~:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">eqT</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:~:</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">eqT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">gcast</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeRep</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Type.Reflection</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Refl</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Coerce</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">coerce</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Fmt</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">+||</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">||+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- | Like 'gcast', casts some container's elements,</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- producing informative error on mismatch.</span><span>
</span><a name="line-27"></a><span class="hs-identifier">gcastE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935631"><a href="#local-6989586621679935631"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679935632"><a href="#local-6989586621679935632"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679935633"><a href="#local-6989586621679935633"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935632"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935633"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935631"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935633"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935632"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><a name="gcastE"><a href="Util.Typeable.html#gcastE"><span class="hs-identifier">gcastE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybeToRight</span><span> </span><a href="#local-6989586621679935634"><span class="hs-identifier hs-var">errMsg</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">gcast</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>    </span><a name="local-6989586621679935634"><a href="#local-6989586621679935634"><span class="hs-identifier">errMsg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Type mismatch: expected &quot;</span><span> </span><span class="hs-operator hs-var">+||</span><span> </span><span class="hs-identifier hs-var">typeRep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935632"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||+</span><span>
</span><a name="line-31"></a><span>                               </span><span class="hs-string">&quot;, got &quot;</span><span> </span><span class="hs-operator hs-var">+||</span><span> </span><span class="hs-identifier hs-var">typeRep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||+</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- | 'Proxy' version of 'eqT'.</span><span>
</span><a name="line-34"></a><span class="hs-identifier">eqP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935629"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935630"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679935629"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679935630"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-operator hs-type">:~:</span><span> </span><a href="#local-6989586621679935630"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="eqP"><a href="Util.Typeable.html#eqP"><span class="hs-identifier">eqP</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679935635"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679935636"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935635"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935636"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- | Suppose you have a data type `X` with parameter `a` and you have</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- two values: `x1 :: X a1` and `x2 :: X a2`. You can't compare them</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- using '==', because they have different types. However, you can</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- compare them using 'eqParam1' as long as both parameters are</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- 'Typeable'.</span><span>
</span><a name="line-42"></a><span class="hs-identifier">eqParam1</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-43"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935626"><a href="#local-6989586621679935626"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935627"><a href="#local-6989586621679935627"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679935628"><a href="#local-6989586621679935628"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-44"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935626"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-45"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935627"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-46"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935628"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935626"><span class="hs-identifier hs-type">a1</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935628"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935626"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935628"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935627"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-51"></a><a name="eqParam1"><a href="Util.Typeable.html#eqParam1"><span class="hs-identifier">eqParam1</span></a></a><span> </span><a name="local-6989586621679935637"><a href="#local-6989586621679935637"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679935638"><a href="#local-6989586621679935638"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935626"><span class="hs-identifier hs-type">a1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935627"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935637"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679935638"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- | Version of 'eqParam1' for types with 2 parameters.</span><span>
</span><a name="line-56"></a><span class="hs-identifier">eqParam2</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-57"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935621"><a href="#local-6989586621679935621"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935622"><a href="#local-6989586621679935622"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679935623"><a href="#local-6989586621679935623"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679935624"><a href="#local-6989586621679935624"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679935625"><a href="#local-6989586621679935625"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-58"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935621"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-59"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935622"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-60"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935623"><span class="hs-identifier hs-type">b1</span></a><span>
</span><a name="line-61"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935624"><span class="hs-identifier hs-type">b2</span></a><span>
</span><a name="line-62"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935625"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935621"><span class="hs-identifier hs-type">a1</span></a><span> </span><a href="#local-6989586621679935624"><span class="hs-identifier hs-type">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935625"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935621"><span class="hs-identifier hs-type">a1</span></a><span> </span><a href="#local-6989586621679935623"><span class="hs-identifier hs-type">b1</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935625"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935622"><span class="hs-identifier hs-type">a2</span></a><span> </span><a href="#local-6989586621679935624"><span class="hs-identifier hs-type">b2</span></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-67"></a><a name="eqParam2"><a href="Util.Typeable.html#eqParam2"><span class="hs-identifier">eqParam2</span></a></a><span> </span><a name="local-6989586621679935639"><a href="#local-6989586621679935639"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679935640"><a href="#local-6989586621679935640"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935621"><span class="hs-identifier hs-type">a1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935622"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935623"><span class="hs-identifier hs-type">b1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935624"><span class="hs-identifier hs-type">b2</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935639"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679935640"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Version of 'eqParam1' for types with 3 parameters.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">eqParam3</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-74"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935614"><a href="#local-6989586621679935614"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935615"><a href="#local-6989586621679935615"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679935616"><a href="#local-6989586621679935616"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679935617"><a href="#local-6989586621679935617"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679935618"><a href="#local-6989586621679935618"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679935619"><a href="#local-6989586621679935619"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-6989586621679935620"><a href="#local-6989586621679935620"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-75"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935614"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-76"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935615"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-77"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935616"><span class="hs-identifier hs-type">b1</span></a><span>
</span><a name="line-78"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935617"><span class="hs-identifier hs-type">b2</span></a><span>
</span><a name="line-79"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935618"><span class="hs-identifier hs-type">c1</span></a><span>
</span><a name="line-80"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935619"><span class="hs-identifier hs-type">c2</span></a><span>
</span><a name="line-81"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935620"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935614"><span class="hs-identifier hs-type">a1</span></a><span> </span><a href="#local-6989586621679935616"><span class="hs-identifier hs-type">b1</span></a><span> </span><a href="#local-6989586621679935618"><span class="hs-identifier hs-type">c1</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935620"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935614"><span class="hs-identifier hs-type">a1</span></a><span> </span><a href="#local-6989586621679935616"><span class="hs-identifier hs-type">b1</span></a><span> </span><a href="#local-6989586621679935618"><span class="hs-identifier hs-type">c1</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935620"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679935615"><span class="hs-identifier hs-type">a2</span></a><span> </span><a href="#local-6989586621679935617"><span class="hs-identifier hs-type">b2</span></a><span> </span><a href="#local-6989586621679935619"><span class="hs-identifier hs-type">c2</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-86"></a><a name="eqParam3"><a href="Util.Typeable.html#eqParam3"><span class="hs-identifier">eqParam3</span></a></a><span> </span><a name="local-6989586621679935641"><a href="#local-6989586621679935641"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679935642"><a href="#local-6989586621679935642"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935614"><span class="hs-identifier hs-type">a1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935615"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-88"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935616"><span class="hs-identifier hs-type">b1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935617"><span class="hs-identifier hs-type">b2</span></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935618"><span class="hs-identifier hs-type">c1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935619"><span class="hs-identifier hs-type">c2</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935641"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679935642"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | Compare two entries of completely different types.</span><span>
</span><a name="line-93"></a><span class="hs-identifier">eqExt</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-94"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935612"><a href="#local-6989586621679935612"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935613"><a href="#local-6989586621679935613"><span class="hs-identifier">a2</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-95"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935612"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-96"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935613"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-97"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679935612"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-98"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935612"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935613"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-102"></a><a name="eqExt"><a href="Util.Typeable.html#eqExt"><span class="hs-identifier">eqExt</span></a></a><span> </span><a name="local-6989586621679935643"><a href="#local-6989586621679935643"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935644"><a href="#local-6989586621679935644"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935612"><span class="hs-identifier hs-type">a1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935613"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935643"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679935644"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Extension of 'eqExt' to 'compare' function.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">compareExt</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-108"></a><span>     </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935610"><a href="#local-6989586621679935610"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679935611"><a href="#local-6989586621679935611"><span class="hs-identifier">a2</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-109"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935610"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-110"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935611"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-111"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679935610"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-112"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935610"><span class="hs-identifier hs-type">a1</span></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935611"><span class="hs-identifier hs-type">a2</span></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-116"></a><a name="compareExt"><a href="Util.Typeable.html#compareExt"><span class="hs-identifier">compareExt</span></a></a><span> </span><a name="local-6989586621679935645"><a href="#local-6989586621679935645"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679935646"><a href="#local-6989586621679935646"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">eqT</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935610"><span class="hs-identifier hs-type">a1</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935611"><span class="hs-identifier hs-type">a2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">typeRep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935610"><span class="hs-identifier hs-type">a1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">typeRep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935611"><span class="hs-identifier hs-type">a2</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935645"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679935646"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">{- | Cast to a type with phantom type argument without matching this argument.
The phantom type must be the last type argument of the type.

Example of use: imagine a type

@
data MyType a = MyType
@

Normally, if object of this type was hidden under existential quantification with
'Typeable' constraint, then in order to get it back with 'cast' you need to know
the exact type of the hidden object, including its phantom type parameter.
With 'castIgnoringPhantom' you get a way to extract this object no matter which
phantom argument it had.
-}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">castIgnoringPhantom</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935606"><a href="#local-6989586621679935606"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679935607"><a href="#local-6989586621679935607"><span class="hs-identifier">x</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-138"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935607"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935606"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-139"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935608"><a href="#local-6989586621679935608"><span class="hs-identifier">phantom1</span></a></a><span> </span><a name="local-6989586621679935609"><a href="#local-6989586621679935609"><span class="hs-identifier">phantom2</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Coercible</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935606"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679935608"><span class="hs-identifier hs-type">phantom1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935606"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679935609"><span class="hs-identifier hs-type">phantom2</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679935607"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935606"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="Util.Typeable.html#DummyPhantomType"><span class="hs-identifier hs-type">DummyPhantomType</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><a name="castIgnoringPhantom"><a href="Util.Typeable.html#castIgnoringPhantom"><span class="hs-identifier">castIgnoringPhantom</span></a></a><span> </span><a name="local-6989586621679935647"><a href="#local-6989586621679935647"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-identifier hs-var">Refl.App</span><span> </span><a name="local-6989586621679935648"><a href="#local-6989586621679935648"><span class="hs-identifier">x1Rep</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Refl.typeOf</span><span> </span><a href="#local-6989586621679935647"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679935649"><a href="#local-6989586621679935649"><span class="hs-identifier">cRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Refl.typeRep</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935606"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-identifier hs-var">Refl.HRefl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Refl.eqTypeRep</span><span> </span><a href="#local-6989586621679935648"><span class="hs-identifier hs-var">x1Rep</span></a><span> </span><a href="#local-6989586621679935649"><span class="hs-identifier hs-var">cRep</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">coerce</span><span> </span><a href="#local-6989586621679935647"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="DummyPhantomType"><a href="Util.Typeable.html#DummyPhantomType"><span class="hs-identifier">DummyPhantomType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679935601"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Match given type against another type of @* -&gt; *@ kind without caring</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- about its type argument.</span><span>
</span><a name="line-152"></a><span class="hs-identifier">eqTypeIgnoringPhantom</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935602"><a href="#local-6989586621679935602"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679935603"><a href="#local-6989586621679935603"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679935604"><a href="#local-6989586621679935604"><span class="hs-identifier">r</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-154"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935603"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935602"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679935605"><a href="#local-6989586621679935605"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679935605"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">c</span><span> </span><a href="#local-6989586621679935605"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">:~:</span><span> </span><a href="#local-6989586621679935603"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679935605"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679935604"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679935604"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-156"></a><a name="eqTypeIgnoringPhantom"><a href="Util.Typeable.html#eqTypeIgnoringPhantom"><span class="hs-identifier">eqTypeIgnoringPhantom</span></a></a><span> </span><a name="local-6989586621679935650"><a href="#local-6989586621679935650"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-identifier hs-var">Refl.App</span><span> </span><a name="local-6989586621679935651"><a href="#local-6989586621679935651"><span class="hs-identifier">x1Rep</span></a></a><span> </span><a name="local-6989586621679935652"><a href="#local-6989586621679935652"><span class="hs-identifier">xArgRep</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Refl.typeRep</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935603"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-158"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679935653"><a href="#local-6989586621679935653"><span class="hs-identifier">cRep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Refl.typeRep</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679935602"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-159"></a><span>  </span><span class="hs-identifier hs-var">Refl.HRefl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Refl.eqTypeRep</span><span> </span><a href="#local-6989586621679935651"><span class="hs-identifier hs-var">x1Rep</span></a><span> </span><a href="#local-6989586621679935653"><span class="hs-identifier hs-var">cRep</span></a><span>
</span><a name="line-160"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Refl.withTypeable</span><span> </span><a href="#local-6989586621679935652"><span class="hs-identifier hs-var">xArgRep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679935650"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-identifier hs-var">Proxy</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a></pre></body></html>