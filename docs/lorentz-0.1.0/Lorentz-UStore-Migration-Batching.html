<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lorentz.UStore.Migration.Batching</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Lorentz.UStore.Migration.Batching.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">lorentz-0.1.0: EDSL for the Michelson Language</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Lorentz.UStore.Migration.Batching</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Separate-lambdas batching</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Different approaches to batching.</p><p>For now we do not support perfect batching because operation size evaluation
 (as well as gas consumption evaluation) is not implemented yet.
 The only non-trivial batching implementation we provide is
 <code><a href="Lorentz-UStore-Migration-Batching.html#v:mbSeparateLambdas" title="Lorentz.UStore.Migration.Batching">mbSeparateLambdas</a></code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:SlBatchType">SlBatchType</a><ul class="subs"><li>= <a href="#v:SlbtData">SlbtData</a></li><li>| <a href="#v:SlbtLambda">SlbtLambda</a></li><li>| <a href="#v:SlbtCustom">SlbtCustom</a></li><li>| <a href="#v:SlbtUnknown">SlbtUnknown</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SlBatchInfo">SlBatchInfo</a> = <a href="#v:SlBatchInfo">SlBatchInfo</a> {<ul class="subs"><li><a href="#v:slbiType">slbiType</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a></li><li><a href="#v:slbiActions">slbiActions</a> :: [<a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a>]</li></ul>}</li><li class="src short"><a href="#v:mbSeparateLambdas">mbSeparateLambdas</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> [] <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchInfo" title="Lorentz.UStore.Migration.Batching">SlBatchInfo</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Separate-lambdas batching</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SlBatchType" class="def">SlBatchType</a> <a href="src/Lorentz.UStore.Migration.Batching.html#SlBatchType" class="link">Source</a> <a href="#t:SlBatchType" class="selflink">#</a></p><div class="doc"><p>Type of batch.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SlbtData" class="def">SlbtData</a></td><td class="doc"><p>Addition of any type of data.</p></td></tr><tr><td class="src"><a id="v:SlbtLambda" class="def">SlbtLambda</a></td><td class="doc"><p>Addition of code.</p></td></tr><tr><td class="src"><a id="v:SlbtCustom" class="def">SlbtCustom</a></td><td class="doc"><p>Several joined actions of different types.</p></td></tr><tr><td class="src"><a id="v:SlbtUnknown" class="def">SlbtUnknown</a></td><td class="doc"><p>No information to chooseType about batching.
 This means that the given action does not contain <code><a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a></code>.</p></td></tr></table></div><div class="subs instances"><details id="i:SlBatchType" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SlBatchType:Eq:1"></span> <a href="Lorentz-Prelude.html#t:Eq" title="Lorentz.Prelude">Eq</a> <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a></span> <a href="src/Lorentz.UStore.Migration.Batching.html#line-36" class="link">Source</a> <a href="#t:SlBatchType" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SlBatchType:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Batching.html">Lorentz.UStore.Migration.Batching</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="Lorentz-Value.html#t:Bool" title="Lorentz.Value">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="Lorentz-Value.html#t:Bool" title="Lorentz.Value">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SlBatchType:Show:2"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a></span> <a href="src/Lorentz.UStore.Migration.Batching.html#line-36" class="link">Source</a> <a href="#t:SlBatchType" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SlBatchType:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Batching.html">Lorentz.UStore.Migration.Batching</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SlBatchInfo" class="def">SlBatchInfo</a> <a href="src/Lorentz.UStore.Migration.Batching.html#SlBatchInfo" class="link">Source</a> <a href="#t:SlBatchInfo" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SlBatchInfo" class="def">SlBatchInfo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:slbiType" class="def">slbiType</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchType" title="Lorentz.UStore.Migration.Batching">SlBatchType</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:slbiActions" class="def">slbiActions</a> :: [<a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a>]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:SlBatchInfo" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SlBatchInfo:Buildable:1"></span> <a href="../fmt-0.6.1.2/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchInfo" title="Lorentz.UStore.Migration.Batching">SlBatchInfo</a></span> <a href="src/Lorentz.UStore.Migration.Batching.html#line-46" class="link">Source</a> <a href="#t:SlBatchInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SlBatchInfo:Buildable:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Batching.html">Lorentz.UStore.Migration.Batching</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchInfo" title="Lorentz.UStore.Migration.Batching">SlBatchInfo</a> -&gt; <a href="../fmt-0.6.1.2/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:mbSeparateLambdas" class="def">mbSeparateLambdas</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> [] <a href="Lorentz-UStore-Migration-Batching.html#t:SlBatchInfo" title="Lorentz.UStore.Migration.Batching">SlBatchInfo</a> <a href="src/Lorentz.UStore.Migration.Batching.html#mbSeparateLambdas" class="link">Source</a> <a href="#v:mbSeparateLambdas" class="selflink">#</a></p><div class="doc"><p>Puts all data updates in one batch, and all lambdas in separate batches,
 one per batch.</p><p>The reason for such behaviour is that in production contracts amount of
 changed data (be it in contract initialization or contract upgrade) is small,
 while stored entrypoints are huge and addition of even one entrypoint often
 barely fits into gas limit.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>