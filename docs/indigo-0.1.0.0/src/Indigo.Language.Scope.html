<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- | Machinery to provide ability to return values from Indigo statements.</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Indigo.Language.Scope</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen"><span class="hs-identifier hs-type">ScopeCodeGen</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack"><span class="hs-identifier hs-type">ScopeOutStack</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#ScopeRetVars"><span class="hs-identifier hs-type">ScopeRetVars</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#ScopeRetExprs"><span class="hs-identifier hs-type">ScopeRetExprs</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#compileScope"><span class="hs-identifier hs-var">compileScope</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#finalizeStatement"><span class="hs-identifier hs-var">finalizeStatement</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Kind</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC.TypeLits</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Lit</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Indigo.Expr.html"><span class="hs-identifier">Indigo.Expr</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Indigo.Lorentz.html"><span class="hs-identifier">Indigo.Lorentz</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Indigo.Prelude.html"><span class="hs-identifier">Indigo.Prelude</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Indigo.State.html"><span class="hs-identifier">Indigo.State</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">(</span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-type">GenCode</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#IndigoM"><span class="hs-identifier hs-type">IndigoM</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#MetaData"><span class="hs-identifier hs-type">MetaData</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#TypeValue"><span class="hs-identifier hs-type">TypeValue</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#return"><span class="hs-identifier hs-var">return</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Indigo.State.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Lorentz.Instr</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- Machinery to return values from statements (like 'if', 'case', 'while', etc) starts here.</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- You are allowed to return unit, one expression or tuple of expressions.</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- For instance:</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- (a, b) &lt;- if flag</span><span>
</span><a name="line-30"></a><span class="hs-comment">--           then do</span><span>
</span><a name="line-31"></a><span class="hs-comment">--                  anotherFlag &lt;- newVar True</span><span>
</span><a name="line-32"></a><span class="hs-comment">--                  return (5 +. var, anotherFlag ||. True)</span><span>
</span><a name="line-33"></a><span class="hs-comment">--           else return (0, anotherVar)</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- is a valid construction.</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- Pay attention to the fact, that '5 +. var' has type 'Expr Integer', but 0 is just Integer,</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- and 'anotherFlag ||. True' has type `Expr Bool`, however, `anotherVar` has type `Var Bool`,</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- and anyway this code will be still compile.</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- This is done intentionally to avoid burden of converting values</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- to expressions (or variables) manually.</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- So you can write the same constructions as in a regular language.</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- | To avoid overlapping instances</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- we need somehow distinguish single value from tuples</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- because instances</span><span>
</span><a name="line-45"></a><span class="hs-comment">--   instance Something a where</span><span>
</span><a name="line-46"></a><span class="hs-comment">--   instance Something (a, b) overlaps</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- and adding {-# OVERLAPPING #-} doesn't rescue in some cases,</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- especially in case of type families defined in `Something`.</span><span>
</span><a name="line-49"></a><span class="hs-keyword">data</span><span> </span><a name="BranchRetKind"><a href="Indigo.Language.Scope.html#BranchRetKind"><span class="hs-identifier">BranchRetKind</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-50"></a><span>    </span><a name="Unit"><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier">Unit</span></a></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">-- ^ If value is unit (don't return anything)</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SingleVal"><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier">SingleVal</span></a></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-comment">-- ^ If it's a single value (not tuple)</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tuple"><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier">Tuple</span></a></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-comment">-- ^ If it's tuple (we don't care how many elements are in)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | This type family returns promoted value of type BranchRetKind</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- or cause a compilation errors, if tuple with too many elements is used.</span><span>
</span><a name="line-59"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ClassifyBranchReturn"><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier">ClassifyBranchReturn</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679318655"><a href="#local-6989586621679318655"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier hs-type">Unit</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-comment">-- These type errors is an attempt to make compile error clear</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-comment">-- in case if one tries to return tuple with more elements from a statement</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-identifier hs-type">Lit.TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Lit.Text</span><span> </span><span class="hs-string">&quot;Tuple with 4 elements is not supported yet as returning value&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-identifier hs-type">Lit.TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Lit.Text</span><span> </span><span class="hs-string">&quot;Tuple with 5 elements is not supported yet as returning value&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier hs-type">Lit.TypeError</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier hs-type">Lit.Text</span><span> </span><span class="hs-string">&quot;Tuple with 6 elements is not supported yet as returning value&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-comment">-- I hope nobody will try to return as a value tuples with more elements</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-identifier">ClassifyBranchReturn</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier hs-type">SingleVal</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Type class which unions all related management of computations in a scope,</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- like in 'if' branch, in 'case' body, etc.</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- Particularly, it takes care of the  computation of expressions</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- returning from a scope to leave the scope safely.</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- Basically, this type class encapsulates generation of Lorentz code which looks like:</span><span>
</span><a name="line-79"></a><span class="hs-comment">--   branch_code #</span><span>
</span><a name="line-80"></a><span class="hs-comment">--     we get some arbitrary type of a stack here, lets call it @xs@</span><span>
</span><a name="line-81"></a><span class="hs-comment">--   compute_returning_expressions #</span><span>
</span><a name="line-82"></a><span class="hs-comment">--     we get type of stack [e1, e2, ... ek] ++ xs</span><span>
</span><a name="line-83"></a><span class="hs-comment">--   cleanup_xs_to_inp</span><span>
</span><a name="line-84"></a><span class="hs-comment">--     we get [e1, e2, e3, ..., ek] ++ inp</span><span>
</span><a name="line-85"></a><span class="hs-keyword">class</span><span> </span><a name="ScopeCodeGen%27"><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier">ScopeCodeGen'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679318648"><a href="#local-6989586621679318648"><span class="hs-identifier">retKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Indigo.Language.Scope.html#BranchRetKind"><span class="hs-identifier hs-type">BranchRetKind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318649"><a href="#local-6989586621679318649"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-comment">-- | Type family reflecting the output stack of the resulting statement.</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ScopeOutStack%27"><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier">ScopeOutStack'</span></a></a><span> </span><a name="local-6989586621679318648"><a href="#local-6989586621679318648"><span class="hs-identifier">retKind</span></a></a><span> </span><a name="local-6989586621679318649"><a href="#local-6989586621679318649"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679318650"><a href="#local-6989586621679318650"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Kind.Type</span><span class="hs-special">]</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-comment">-- | Type family reflecting the output value of the resulting statement.</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ScopeRetVars%27"><a href="Indigo.Language.Scope.html#ScopeRetVars%27"><span class="hs-identifier">ScopeRetVars'</span></a></a><span> </span><a name="local-6989586621679318648"><a href="#local-6989586621679318648"><span class="hs-identifier">retKind</span></a></a><span> </span><a name="local-6989586621679318649"><a href="#local-6989586621679318649"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-comment">-- | Tuple looking like `(Expr x, Expr y, ..)`, which corresponds</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-comment">-- to expressions returning from the scope.</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- 'ScopeRetVars'' and 'ScopeRetExprs'' are twin types because</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- the former just adds 'Var' over each expression from the later one.</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ScopeRetExprs%27"><a href="Indigo.Language.Scope.html#ScopeRetExprs%27"><span class="hs-identifier">ScopeRetExprs'</span></a></a><span> </span><a name="local-6989586621679318648"><a href="#local-6989586621679318648"><span class="hs-identifier">retKind</span></a></a><span> </span><a name="local-6989586621679318649"><a href="#local-6989586621679318649"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind.Type</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-comment">-- | Produces an Indigo computation, which puts on a stack</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-comment">-- evaluated returnen expressions from the leaving scope.</span><span>
</span><a name="line-98"></a><span>  </span><a name="compileScopeReturn%27"><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier">compileScopeReturn'</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Indigo.State.html#IndigoM"><span class="hs-identifier hs-type">IndigoM</span></a><span> </span><a href="#local-6989586621679318651"><span class="hs-identifier hs-type">xs</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier hs-type">ScopeOutStack'</span></a><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318651"><span class="hs-identifier hs-type">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>  </span><span class="hs-comment">-- | Drop unused cells of a stack from the leaving scope,</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-comment">-- which are after evaluated expressions.</span><span>
</span><a name="line-102"></a><span>  </span><a name="liftClear%27"><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier">liftClear'</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">xs</span><span> </span><span class="hs-operator hs-type">:-&gt;</span><span> </span><a href="#local-6989586621679318653"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ScopeOutStack'</span><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318652"><span class="hs-identifier hs-type">xs</span></a><span> </span><span class="hs-operator">:-&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier hs-type">ScopeOutStack'</span></a><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318653"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-comment">-- | Push a variables in MetaData, which refer to generated expressions,</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-comment">-- and generate 'gcClear' for the whole statement</span><span>
</span><a name="line-106"></a><span>  </span><a name="finalizeStatement%27"><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier">finalizeStatement'</span></a></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Indigo.State.html#MetaData"><span class="hs-identifier hs-type">MetaData</span></a><span> </span><a href="#local-6989586621679318654"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">inp</span><span> </span><span class="hs-operator hs-type">:-&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier hs-type">ScopeOutStack'</span></a><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318654"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-type">GenCode</span></a><span> </span><a href="#local-6989586621679318654"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier hs-type">ScopeOutStack'</span></a><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318654"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeRetVars%27"><span class="hs-identifier hs-type">ScopeRetVars'</span></a><span> </span><a href="#local-6989586621679318648"><span class="hs-identifier hs-type">retKind</span></a><span> </span><a href="#local-6989586621679318649"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-keyword">type</span><span> </span><a name="ScopeOutStack"><a href="Indigo.Language.Scope.html#ScopeOutStack"><span class="hs-identifier">ScopeOutStack</span></a></a><span> </span><a name="local-6989586621679318646"><a href="#local-6989586621679318646"><span class="hs-identifier">ret</span></a></a><span> </span><a name="local-6989586621679318647"><a href="#local-6989586621679318647"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack%27"><span class="hs-identifier hs-type">ScopeOutStack'</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318646"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318646"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318647"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><a name="ScopeRetVars"><a href="Indigo.Language.Scope.html#ScopeRetVars"><span class="hs-identifier">ScopeRetVars</span></a></a><span> </span><a name="local-6989586621679318645"><a href="#local-6989586621679318645"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Language.Scope.html#ScopeRetVars%27"><span class="hs-identifier hs-type">ScopeRetVars'</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318645"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318645"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">type</span><span> </span><a name="ScopeRetExprs"><a href="Indigo.Language.Scope.html#ScopeRetExprs"><span class="hs-identifier">ScopeRetExprs</span></a></a><span> </span><a name="local-6989586621679318644"><a href="#local-6989586621679318644"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Language.Scope.html#ScopeRetExprs%27"><span class="hs-identifier hs-type">ScopeRetExprs'</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318644"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318644"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">type</span><span> </span><a name="ScopeCodeGen"><a href="Indigo.Language.Scope.html#ScopeCodeGen"><span class="hs-identifier">ScopeCodeGen</span></a></a><span> </span><a name="local-6989586621679318643"><a href="#local-6989586621679318643"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318643"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318643"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Concatenate a scope code, generation of returning expressions,</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- and clean up of redundant cells from a stack</span><span>
</span><a name="line-118"></a><span class="hs-identifier">compileScope</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679318714"><a href="#local-6989586621679318714"><span class="hs-identifier">ret</span></a></a><span> </span><a name="local-6989586621679318715"><a href="#local-6989586621679318715"><span class="hs-identifier">inp</span></a></a><span> </span><a name="local-6989586621679318716"><a href="#local-6989586621679318716"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen"><span class="hs-identifier hs-type">ScopeCodeGen</span></a><span> </span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-type">GenCode</span></a><span> </span><a href="#local-6989586621679318715"><span class="hs-identifier hs-type">inp</span></a><span> </span><a href="#local-6989586621679318716"><span class="hs-identifier hs-type">xs</span></a><span> </span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">inp</span><span> </span><span class="hs-operator hs-type">:-&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack"><span class="hs-identifier hs-type">ScopeOutStack</span></a><span> </span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318715"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><a name="compileScope"><a href="Indigo.Language.Scope.html#compileScope"><span class="hs-identifier">compileScope</span></a></a><span> </span><a name="local-6989586621679318717"><a href="#local-6989586621679318717"><span class="hs-identifier">gc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-identifier">gcCode</span><span> </span><a href="#local-6989586621679318717"><span class="hs-identifier hs-var">gc</span></a><span> </span><span class="hs-operator hs-var">#</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-identifier">gcCode</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runIndigoM</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier hs-var">compileScopeReturn'</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcOut</span><span> </span><a href="#local-6989586621679318717"><span class="hs-identifier hs-var">gc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcMeta</span><span> </span><a href="#local-6989586621679318717"><span class="hs-identifier hs-var">gc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">#</span><span>
</span><a name="line-125"></a><span>  </span><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier hs-var">liftClear'</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679318714"><span class="hs-identifier hs-type">ret</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcClear</span><span> </span><a href="#local-6989586621679318717"><span class="hs-identifier hs-var">gc</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | Specify type of @finalizeStatement'@</span><span>
</span><a name="line-128"></a><span class="hs-identifier">finalizeStatement</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679318712"><a href="#local-6989586621679318712"><span class="hs-identifier">ret</span></a></a><span> </span><a name="local-6989586621679318713"><a href="#local-6989586621679318713"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeCodeGen"><span class="hs-identifier hs-type">ScopeCodeGen</span></a><span> </span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Indigo.State.html#MetaData"><span class="hs-identifier hs-type">MetaData</span></a><span> </span><a href="#local-6989586621679318713"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">inp</span><span> </span><span class="hs-operator hs-type">:-&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeOutStack"><span class="hs-identifier hs-type">ScopeOutStack</span></a><span> </span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318713"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-type">GenCode</span></a><span> </span><a href="#local-6989586621679318713"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeOutStack"><span class="hs-identifier hs-type">ScopeOutStack</span></a><span> </span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span> </span><a href="#local-6989586621679318713"><span class="hs-identifier hs-type">inp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ScopeRetVars"><span class="hs-identifier hs-type">ScopeRetVars</span></a><span> </span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><a name="finalizeStatement"><a href="Indigo.Language.Scope.html#finalizeStatement"><span class="hs-identifier">finalizeStatement</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier hs-var">finalizeStatement'</span></a><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#ClassifyBranchReturn"><span class="hs-identifier hs-type">ClassifyBranchReturn</span></a><span> </span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679318712"><span class="hs-identifier hs-type">ret</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- Type instances for ScopeCodeGen'.</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- Perhaps, they could be implemented more succinctly</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- and expressed inductively via previous instances,</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- but I don't think it makes sense to spend a lot of time to shorten them.</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">type</span><span> </span><a name="TypeValueExpr"><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier">TypeValueExpr</span></a></a><span> </span><a name="local-6989586621679318642"><a href="#local-6989586621679318642"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Indigo.State.html#TypeValue"><span class="hs-identifier hs-type">TypeValue</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318642"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.Expr.html#ToExpr"><span class="hs-identifier hs-type">ToExpr</span></a><span> </span><a href="#local-6989586621679318642"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">instance</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier hs-type">Unit</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeOutStack'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier hs-type">Unit</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318711"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679318711"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetVars'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier hs-type">Unit</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetExprs'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Unit"><span class="hs-identifier hs-type">Unit</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>  </span><a name="local-8214565720324093543"><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier">compileScopeReturn'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720324093544"><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier">liftClear'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720324093545"><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier">finalizeStatement'</span></a></a><span> </span><a name="local-6989586621679318709"><a href="#local-6989586621679318709"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679318710"><a href="#local-6989586621679318710"><span class="hs-identifier">code</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-var">GenCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318709"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-6989586621679318710"><span class="hs-identifier hs-var">code</span></a><span> </span><span class="hs-identifier hs-var">L.nop</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier hs-type">SingleVal</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeOutStack'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier hs-type">SingleVal</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span> </span><a href="#local-6989586621679318708"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679318708"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetVars'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier hs-type">SingleVal</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetExprs'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#SingleVal"><span class="hs-identifier hs-type">SingleVal</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318703"><span class="hs-identifier hs-type">single</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span>  </span><a name="local-8214565720324093543"><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier">compileScopeReturn'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span>
</span><a name="line-157"></a><span>  </span><a name="local-8214565720324093544"><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier">liftClear'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.dip</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-8214565720324093545"><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier">finalizeStatement'</span></a></a><span> </span><a name="local-6989586621679318704"><a href="#local-6989586621679318704"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679318705"><a href="#local-6989586621679318705"><span class="hs-identifier">code</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318706"><a href="#local-6989586621679318706"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318707"><a href="#local-6989586621679318707"><span class="hs-identifier">newMd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318704"><span class="hs-identifier hs-var">md</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-160"></a><span>    </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-var">GenCode</span></a><span> </span><a href="#local-6989586621679318706"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679318707"><span class="hs-identifier hs-var">newMd</span></a><span> </span><a href="#local-6989586621679318705"><span class="hs-identifier hs-var">code</span></a><span> </span><span class="hs-identifier hs-var">L.drop</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeOutStack'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318702"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679318702"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetVars'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetExprs'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318692"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318693"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span>  </span><a name="local-8214565720324093543"><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier">compileScopeReturn'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679318694"><a href="#local-6989586621679318694"><span class="hs-identifier">e1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318695"><a href="#local-6989586621679318695"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span> </span><a href="#local-6989586621679318695"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="Indigo.State.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span> </span><a href="#local-6989586621679318694"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-168"></a><span>  </span><a name="local-8214565720324093544"><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier">liftClear'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.dip</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">L.dip</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-comment">-- Is L.dip . L.dip cheaper than L.dipN ?</span><span>
</span><a name="line-170"></a><span>  </span><a name="local-8214565720324093545"><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier">finalizeStatement'</span></a></a><span> </span><a name="local-6989586621679318696"><a href="#local-6989586621679318696"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679318697"><a href="#local-6989586621679318697"><span class="hs-identifier">code</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318698"><a href="#local-6989586621679318698"><span class="hs-identifier">var2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318699"><a href="#local-6989586621679318699"><span class="hs-identifier">newMd1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318696"><span class="hs-identifier hs-var">md</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318700"><a href="#local-6989586621679318700"><span class="hs-identifier">var1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318701"><a href="#local-6989586621679318701"><span class="hs-identifier">newMd2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318699"><span class="hs-identifier hs-var">newMd1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-173"></a><span>    </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-var">GenCode</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318700"><span class="hs-identifier hs-var">var1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318698"><span class="hs-identifier hs-var">var2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318701"><span class="hs-identifier hs-var">newMd2</span></a><span> </span><a href="#local-6989586621679318697"><span class="hs-identifier hs-var">code</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.drop</span><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">L.drop</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Language.Scope.html#TypeValueExpr"><span class="hs-identifier hs-type">TypeValueExpr</span></a><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Indigo.Language.Scope.html#ScopeCodeGen%27"><span class="hs-identifier hs-type">ScopeCodeGen'</span></a><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeOutStack'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318691"><span class="hs-identifier hs-type">inp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-type">ExprType</span><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679318691"><span class="hs-identifier hs-type">inp</span></a><span>
</span><a name="line-177"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetVars'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Indigo.State.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ScopeRetExprs'</span><span> </span><span class="hs-special">'</span><a href="Indigo.Language.Scope.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318677"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318678"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="Indigo.Expr.html#ExprType"><span class="hs-identifier hs-type">ExprType</span></a><span> </span><a href="#local-6989586621679318679"><span class="hs-identifier hs-type">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>  </span><a name="local-8214565720324093543"><a href="Indigo.Language.Scope.html#compileScopeReturn%27"><span class="hs-identifier">compileScopeReturn'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679318680"><a href="#local-6989586621679318680"><span class="hs-identifier">e1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318681"><a href="#local-6989586621679318681"><span class="hs-identifier">e2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318682"><a href="#local-6989586621679318682"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span> </span><a href="#local-6989586621679318682"><span class="hs-identifier hs-var">e3</span></a><span> </span><a href="Indigo.State.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span> </span><a href="#local-6989586621679318681"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="Indigo.State.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Indigo.Expr.html#compileToExpr"><span class="hs-identifier hs-var">compileToExpr</span></a><span> </span><a href="#local-6989586621679318680"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-181"></a><span>  </span><a name="local-8214565720324093544"><a href="Indigo.Language.Scope.html#liftClear%27"><span class="hs-identifier">liftClear'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.dipN</span><span> </span><span class="hs-glyph">@</span><span class="hs-number">3</span><span>
</span><a name="line-182"></a><span>  </span><a name="local-8214565720324093545"><a href="Indigo.Language.Scope.html#finalizeStatement%27"><span class="hs-identifier">finalizeStatement'</span></a></a><span> </span><a name="local-6989586621679318683"><a href="#local-6989586621679318683"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679318684"><a href="#local-6989586621679318684"><span class="hs-identifier">code</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318685"><a href="#local-6989586621679318685"><span class="hs-identifier">var3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318686"><a href="#local-6989586621679318686"><span class="hs-identifier">newMd1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318683"><span class="hs-identifier hs-var">md</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318687"><a href="#local-6989586621679318687"><span class="hs-identifier">var2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318688"><a href="#local-6989586621679318688"><span class="hs-identifier">newMd2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318686"><span class="hs-identifier hs-var">newMd1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679318689"><a href="#local-6989586621679318689"><span class="hs-identifier">var1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679318690"><a href="#local-6989586621679318690"><span class="hs-identifier">newMd3</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Indigo.State.html#pushRefMd"><span class="hs-identifier hs-var">pushRefMd</span></a><span> </span><a href="#local-6989586621679318688"><span class="hs-identifier hs-var">newMd2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-186"></a><span>    </span><a href="Indigo.State.html#GenCode"><span class="hs-identifier hs-var">GenCode</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679318689"><span class="hs-identifier hs-var">var1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318687"><span class="hs-identifier hs-var">var2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679318685"><span class="hs-identifier hs-var">var3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679318690"><span class="hs-identifier hs-var">newMd3</span></a><span> </span><a href="#local-6989586621679318684"><span class="hs-identifier hs-var">code</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.drop</span><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">L.drop</span><span> </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">L.drop</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a></pre></body></html>