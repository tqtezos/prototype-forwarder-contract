<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Dependent.Sum</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Constraint.Extras</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Type.Equality</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:~:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Data.GADT.Show.html"><span class="hs-identifier">Data.GADT.Show</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Data.GADT.Compare.html"><span class="hs-identifier">Data.GADT.Compare</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Read</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- |A basic dependent sum type; the first component is a tag that specifies</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- the type of the second;  for example, think of a GADT such as:</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- &gt; data Tag a where</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- &gt;    AString :: Tag String</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- &gt;    AnInt   :: Tag Int</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- Then, we have the following valid expressions of type @Applicative f =&gt; DSum Tag f@:</span><span>
</span><a name="line-36"></a><span class="hs-comment">--</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- &gt; AString ==&gt; &quot;hello!&quot;</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- &gt; AnInt   ==&gt; 42</span><span>
</span><a name="line-39"></a><span class="hs-comment">--</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- And we can write functions that consume @DSum Tag f@ values by matching,</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- such as:</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- &gt; toString :: DSum Tag Identity -&gt; String</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- &gt; toString (AString :=&gt; Identity str) = str</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- &gt; toString (AnInt   :=&gt; Identity int) = show int</span><span>
</span><a name="line-46"></a><span class="hs-comment">--</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- By analogy to the (key =&gt; value) construction for dictionary entries in</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- many dynamic languages, we use (key :=&gt; value) as the constructor for</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- dependent sums.  The :=&gt; and ==&gt; operators have very low precedence and</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- bind to the right, so if the @Tag@ GADT is extended with an additional</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- constructor @Rec :: Tag (DSum Tag Identity)@, then @Rec ==&gt; AnInt ==&gt; 3 + 4@</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- is parsed as would be expected (@Rec ==&gt; (AnInt ==&gt; (3 + 4))@) and has type</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- @DSum Identity Tag@.  Its precedence is just above that of '$', so</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- @foo bar $ AString ==&gt; &quot;eep&quot;@ is equivalent to @foo bar (AString ==&gt; &quot;eep&quot;)@.</span><span>
</span><a name="line-55"></a><span class="hs-keyword">data</span><span> </span><a name="DSum"><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier">DSum</span></a></a><span> </span><a name="local-6989586621679041339"><a href="#local-6989586621679041339"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041340"><a href="#local-6989586621679041340"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041341"><a href="#local-6989586621679041341"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="#local-6989586621679041339"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041341"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a name="%3A%3D%3E"><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator">:=&gt;</span></a></a><span> </span><a href="#local-6989586621679041340"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041341"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span class="hs-special">,</span><span> </span><a href="Data.Dependent.Sum.html#%3D%3D%3E"><span class="hs-operator hs-var">==&gt;</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-special">(</span><span class="hs-operator">==&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679041388"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041389"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041390"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041390"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier hs-type">DSum</span></a><span> </span><a href="#local-6989586621679041389"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041388"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-60"></a><a name="local-6989586621679041391"><a href="#local-6989586621679041391"><span class="hs-identifier">k</span></a></a><span> </span><a name="%3D%3D%3E"><a href="Data.Dependent.Sum.html#%3D%3D%3E"><span class="hs-operator">==&gt;</span></a></a><span> </span><a name="local-6989586621679041392"><a href="#local-6989586621679041392"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041391"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679041392"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041365"><a href="#local-6989586621679041365"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041366"><a href="#local-6989586621679041366"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GShow"><span class="hs-identifier hs-type">GShow</span></a><span> </span><a href="#local-6989586621679041365"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679041365"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041366"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier hs-type">DSum</span></a><span> </span><a href="#local-6989586621679041365"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041366"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>    </span><a name="local-8214565720323790327"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679041367"><a href="#local-6989586621679041367"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679041368"><a href="#local-6989586621679041368"><span class="hs-identifier">tag</span></a></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a name="local-6989586621679041369"><a href="#local-6989586621679041369"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041367"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Data.GADT.Show.html#gshowsPrec"><span class="hs-identifier hs-var">gshowsPrec</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679041368"><span class="hs-identifier hs-var">tag</span></a><span>
</span><a name="line-65"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; :=&gt; &quot;</span><span>
</span><a name="line-66"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041366"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041368"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679041369"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041354"><a href="#local-6989586621679041354"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041355"><a href="#local-6989586621679041355"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GRead"><span class="hs-identifier hs-type">GRead</span></a><span> </span><a href="#local-6989586621679041354"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679041354"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041355"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-special">(</span><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier hs-type">DSum</span></a><span> </span><a href="#local-6989586621679041354"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041355"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-70"></a><span>    </span><a name="local-8214565720323790031"><span class="hs-identifier">readsPrec</span></a><span> </span><a name="local-6989586621679041356"><a href="#local-6989586621679041356"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041356"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679041357"><a href="#local-6989586621679041357"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-71"></a><span>        </span><span class="hs-identifier hs-var">concat</span><span>
</span><a name="line-72"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">getGReadResult</span><span> </span><a href="#local-6989586621679041358"><span class="hs-identifier hs-var">withTag</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679041362"><a href="#local-6989586621679041362"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-73"></a><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041362"><span class="hs-identifier hs-var">tag</span></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a href="#local-6989586621679041363"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679041364"><span class="hs-identifier hs-var">rest''</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041363"><a href="#local-6989586621679041363"><span class="hs-identifier">val</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679041364"><a href="#local-6989586621679041364"><span class="hs-identifier">rest''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041355"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041362"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readsPrec</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679041361"><span class="hs-identifier hs-var">rest'</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-76"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041358"><a href="#local-6989586621679041358"><span class="hs-identifier">withTag</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679041359"><a href="#local-6989586621679041359"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.GADT.Show.html#greadsPrec"><span class="hs-identifier hs-var">greadsPrec</span></a><span> </span><a href="#local-6989586621679041356"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679041357"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-77"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041360"><a href="#local-6989586621679041360"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679041361"><a href="#local-6989586621679041361"><span class="hs-identifier">rest'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-number">5</span><span> </span><a href="#local-6989586621679041359"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-78"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679041360"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot; :=&gt; &quot;</span><span>
</span><a name="line-79"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041348"><a href="#local-6989586621679041348"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041349"><a href="#local-6989586621679041349"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GEq"><span class="hs-identifier hs-type">GEq</span></a><span> </span><a href="#local-6989586621679041348"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041348"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041349"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier hs-type">DSum</span></a><span> </span><a href="#local-6989586621679041348"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041349"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679041350"><a href="#local-6989586621679041350"><span class="hs-identifier">t1</span></a></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a name="local-6989586621679041351"><a href="#local-6989586621679041351"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679041352"><a href="#local-6989586621679041352"><span class="hs-identifier">t2</span></a></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a name="local-6989586621679041353"><a href="#local-6989586621679041353"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.GADT.Compare.html#geq"><span class="hs-identifier hs-var">geq</span></a><span> </span><a href="#local-6989586621679041350"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679041352"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-84"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041349"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041350"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041351"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679041353"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041342"><a href="#local-6989586621679041342"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041343"><a href="#local-6989586621679041343"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GCompare"><span class="hs-identifier hs-type">GCompare</span></a><span> </span><a href="#local-6989586621679041342"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041342"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041343"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679041342"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041343"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="Data.Dependent.Sum.html#DSum"><span class="hs-identifier hs-type">DSum</span></a><span> </span><a href="#local-6989586621679041342"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041343"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-8214565720323790499"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679041344"><a href="#local-6989586621679041344"><span class="hs-identifier">t1</span></a></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a name="local-6989586621679041345"><a href="#local-6989586621679041345"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041346"><a href="#local-6989586621679041346"><span class="hs-identifier">t2</span></a></a><span> </span><a href="Data.Dependent.Sum.html#%3A%3D%3E"><span class="hs-operator hs-var">:=&gt;</span></a><span> </span><a name="local-6989586621679041347"><a href="#local-6989586621679041347"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.GADT.Compare.html#gcompare"><span class="hs-identifier hs-var">gcompare</span></a><span> </span><a href="#local-6989586621679041344"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679041346"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-88"></a><span>        </span><a href="Data.GADT.Compare.html#GLT"><span class="hs-identifier hs-var">GLT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-89"></a><span>        </span><a href="Data.GADT.Compare.html#GGT"><span class="hs-identifier hs-var">GGT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-90"></a><span>        </span><a href="Data.GADT.Compare.html#GEQ"><span class="hs-identifier hs-var">GEQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041343"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041344"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041343"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041344"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041345"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679041347"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">ShowTag</span><span> </span><span class="hs-pragma">&quot;Instead of 'ShowTag tag f', use '(GShow tag, Has' Show tag f)'&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-93"></a><span class="hs-keyword">type</span><span> </span><a name="ShowTag"><a href="Data.Dependent.Sum.html#ShowTag"><span class="hs-identifier">ShowTag</span></a></a><span> </span><a name="local-6989586621679041337"><a href="#local-6989586621679041337"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041338"><a href="#local-6989586621679041338"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GShow"><span class="hs-identifier hs-type">GShow</span></a><span> </span><a href="#local-6989586621679041337"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679041337"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041338"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">showTaggedPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041385"><a href="#local-6989586621679041385"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041386"><a href="#local-6989586621679041386"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041387"><a href="#local-6989586621679041387"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GShow"><span class="hs-identifier hs-type">GShow</span></a><span> </span><a href="#local-6989586621679041385"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679041385"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041386"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041385"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041387"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041386"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041387"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ShowS</span><span>
</span><a name="line-96"></a><a name="showTaggedPrec"><a href="Data.Dependent.Sum.html#showTaggedPrec"><span class="hs-identifier">showTaggedPrec</span></a></a><span> </span><a name="local-6989586621679041393"><a href="#local-6989586621679041393"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041393"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-identifier hs-var">showsPrec</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">ReadTag</span><span> </span><span class="hs-pragma">&quot;Instead of 'ReadTag tag f', use '(GRead tag, Has' Read tag f)'&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-99"></a><span class="hs-keyword">type</span><span> </span><a name="ReadTag"><a href="Data.Dependent.Sum.html#ReadTag"><span class="hs-identifier">ReadTag</span></a></a><span> </span><a name="local-6989586621679041335"><a href="#local-6989586621679041335"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041336"><a href="#local-6989586621679041336"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GRead"><span class="hs-identifier hs-type">GRead</span></a><span> </span><a href="#local-6989586621679041335"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679041335"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041336"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">readTaggedPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041382"><a href="#local-6989586621679041382"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041383"><a href="#local-6989586621679041383"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041384"><a href="#local-6989586621679041384"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Show.html#GRead"><span class="hs-identifier hs-type">GRead</span></a><span> </span><a href="#local-6989586621679041382"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679041382"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041383"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041382"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041384"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ReadS</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041383"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041384"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><a name="readTaggedPrec"><a href="Data.Dependent.Sum.html#readTaggedPrec"><span class="hs-identifier">readTaggedPrec</span></a></a><span> </span><a name="local-6989586621679041394"><a href="#local-6989586621679041394"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041383"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041394"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-identifier hs-var">readsPrec</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">EqTag</span><span> </span><span class="hs-pragma">&quot;Instead of 'EqTag tag f', use '(GEq tag, Has' Eq tag f)'&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-105"></a><span class="hs-keyword">type</span><span> </span><a name="EqTag"><a href="Data.Dependent.Sum.html#EqTag"><span class="hs-identifier">EqTag</span></a></a><span> </span><a name="local-6989586621679041333"><a href="#local-6989586621679041333"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041334"><a href="#local-6989586621679041334"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GEq"><span class="hs-identifier hs-type">GEq</span></a><span> </span><a href="#local-6989586621679041333"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041333"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041334"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-identifier">eqTaggedPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041379"><a href="#local-6989586621679041379"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041380"><a href="#local-6989586621679041380"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041381"><a href="#local-6989586621679041381"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GEq"><span class="hs-identifier hs-type">GEq</span></a><span> </span><a href="#local-6989586621679041379"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041379"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041380"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041379"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041379"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041380"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041380"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-108"></a><a name="eqTaggedPrec"><a href="Data.Dependent.Sum.html#eqTaggedPrec"><span class="hs-identifier">eqTaggedPrec</span></a></a><span> </span><a name="local-6989586621679041395"><a href="#local-6989586621679041395"><span class="hs-identifier">tag1</span></a></a><span> </span><a name="local-6989586621679041396"><a href="#local-6989586621679041396"><span class="hs-identifier">tag2</span></a></a><span> </span><a name="local-6989586621679041397"><a href="#local-6989586621679041397"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679041398"><a href="#local-6989586621679041398"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041395"><span class="hs-identifier hs-var">tag1</span></a><span> </span><span class="hs-special">`</span><a href="Data.GADT.Compare.html#geq"><span class="hs-identifier hs-var">geq</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679041396"><span class="hs-identifier hs-var">tag2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Refl</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041380"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041395"><span class="hs-identifier hs-var">tag1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679041397"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679041398"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-identifier">eqTagged</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041376"><a href="#local-6989586621679041376"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041377"><a href="#local-6989586621679041377"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041378"><a href="#local-6989586621679041378"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Data.Dependent.Sum.html#EqTag"><span class="hs-identifier hs-type">EqTag</span></a><span> </span><a href="#local-6989586621679041376"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041377"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041376"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041376"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041377"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041377"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-113"></a><a name="eqTagged"><a href="Data.Dependent.Sum.html#eqTagged"><span class="hs-identifier">eqTagged</span></a></a><span> </span><a name="local-6989586621679041399"><a href="#local-6989586621679041399"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679041400"><a href="#local-6989586621679041400"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679041401"><a href="#local-6989586621679041401"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041377"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041399"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041400"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679041401"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">OrdTag</span><span> </span><span class="hs-pragma">&quot;Instead of 'OrdTag tag f', use '(GCompare tag, Has' Eq tag f, Has' Ord tag f)'&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-116"></a><span class="hs-keyword">type</span><span> </span><a name="OrdTag"><a href="Data.Dependent.Sum.html#OrdTag"><span class="hs-identifier">OrdTag</span></a></a><span> </span><a name="local-6989586621679041331"><a href="#local-6989586621679041331"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041332"><a href="#local-6989586621679041332"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GCompare"><span class="hs-identifier hs-type">GCompare</span></a><span> </span><a href="#local-6989586621679041331"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041331"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041332"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679041331"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041332"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">compareTaggedPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041373"><a href="#local-6989586621679041373"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041374"><a href="#local-6989586621679041374"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041375"><a href="#local-6989586621679041375"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Data.GADT.Compare.html#GCompare"><span class="hs-identifier hs-type">GCompare</span></a><span> </span><a href="#local-6989586621679041373"><span class="hs-identifier hs-type">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679041373"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Has'</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679041373"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041373"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041373"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-119"></a><a name="compareTaggedPrec"><a href="Data.Dependent.Sum.html#compareTaggedPrec"><span class="hs-identifier">compareTaggedPrec</span></a></a><span> </span><a name="local-6989586621679041402"><a href="#local-6989586621679041402"><span class="hs-identifier">tag1</span></a></a><span> </span><a name="local-6989586621679041403"><a href="#local-6989586621679041403"><span class="hs-identifier">tag2</span></a></a><span> </span><a name="local-6989586621679041404"><a href="#local-6989586621679041404"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679041405"><a href="#local-6989586621679041405"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041402"><span class="hs-identifier hs-var">tag1</span></a><span> </span><span class="hs-special">`</span><a href="Data.GADT.Compare.html#gcompare"><span class="hs-identifier hs-var">gcompare</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679041403"><span class="hs-identifier hs-var">tag2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-120"></a><span>  </span><a href="Data.GADT.Compare.html#GLT"><span class="hs-identifier hs-var">GLT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-121"></a><span>  </span><a href="Data.GADT.Compare.html#GEQ"><span class="hs-identifier hs-var">GEQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041402"><span class="hs-identifier hs-var">tag1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041374"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041402"><span class="hs-identifier hs-var">tag1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679041404"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679041405"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-122"></a><span>  </span><a href="Data.GADT.Compare.html#GGT"><span class="hs-identifier hs-var">GGT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">compareTagged</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679041370"><a href="#local-6989586621679041370"><span class="hs-identifier">tag</span></a></a><span> </span><a name="local-6989586621679041371"><a href="#local-6989586621679041371"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679041372"><a href="#local-6989586621679041372"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Data.Dependent.Sum.html#OrdTag"><span class="hs-identifier hs-type">OrdTag</span></a><span> </span><a href="#local-6989586621679041370"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041371"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679041370"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041372"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041370"><span class="hs-identifier hs-type">tag</span></a><span> </span><a href="#local-6989586621679041372"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041371"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041372"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041371"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041372"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-125"></a><a name="compareTagged"><a href="Data.Dependent.Sum.html#compareTagged"><span class="hs-identifier">compareTagged</span></a></a><span> </span><a name="local-6989586621679041406"><a href="#local-6989586621679041406"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679041407"><a href="#local-6989586621679041407"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679041408"><a href="#local-6989586621679041408"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041371"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041406"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">has'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679041371"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679041406"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679041407"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679041408"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a></pre></body></html>