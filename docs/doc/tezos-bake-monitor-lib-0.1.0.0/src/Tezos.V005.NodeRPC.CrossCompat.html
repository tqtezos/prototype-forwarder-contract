<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Tezos.V005.NodeRPC.CrossCompat</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Getter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">to</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">^.</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lens</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.~</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">view</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mzero</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Aeson</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">(</span><span class="hs-identifier hs-var">parseJSON</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">(</span><span class="hs-identifier hs-var">toJSON</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Value</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Object</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Tezos.V004.Types.html"><span class="hs-identifier">Tezos.V004.Types</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V004</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Tezos.V005.Types.html"><span class="hs-identifier">Tezos.V005.Types</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V005</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Tezos.V005.Block.html"><span class="hs-identifier">Tezos.V005.Block</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#BlockLike"><span class="hs-identifier hs-type">BlockLike</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Tezos.V004.Block.html#HasProtocolHash"><span class="hs-identifier hs-type">HasProtocolHash</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Tezos.V004.Block.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Tezos.V004.Block.html#HasBlockHeaderFull"><span class="hs-identifier hs-type">HasBlockHeaderFull</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Tezos.V004.Block.html#HasBlockMetadata"><span class="hs-identifier hs-type">HasBlockMetadata</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Tezos.V005.BalanceUpdate.html"><span class="hs-identifier">Tezos.V005.BalanceUpdate</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V004.BalanceUpdate.html#HasBalanceUpdates"><span class="hs-identifier hs-type">HasBalanceUpdates</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- These kinds of unions here only work with these specific schema changes</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- between V004 and V005 don't have a subset relationship. If a version</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- change just added/ removed fields, you could easily end up parsing into</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- the smaller set because it succeeds unless you order the alternatives in</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- decending order of field set size.</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- If we're already apologising for shortcomings here know that this method</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- should be replaced with some method in the NodeRPC that forces you to</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- know the protocol before asking for a block. This would force everyone</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- to do a block header call before getting a block, but this is probably</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- better long term so we don't have any annoying confusing errors.</span><span>
</span><a name="line-26"></a><span class="hs-comment">--</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- Also these strings of Parser alternatives have really bad error</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- messages, because you end up just getting the error message of the last</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- parser if it bottoms out of all of them. If we continue with this encoding</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- we probably want a better combinator than &lt;|&gt;</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">-- See the comments at the top of V005.Account to see what changed.</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">data</span><span> </span><a name="AccountCrossCompat"><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountCrossCompat"><span class="hs-identifier">AccountCrossCompat</span></a></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="AccountV004"><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV004"><span class="hs-identifier">AccountV004</span></a></a><span> </span><a href="Tezos.V004.Account.html#Account"><span class="hs-identifier hs-type">V004.Account</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AccountV005"><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV005"><span class="hs-identifier">AccountV005</span></a></a><span> </span><a href="Tezos.V005.Account.html#Account"><span class="hs-identifier hs-type">V005.Account</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- The user needs a way to get the delegate PKH out regardless of version.</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- This forces both accounts to agree on their PKH type. In this case they</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- currently do agree and this is probably OK for now.</span><span>
</span><a name="line-42"></a><span class="hs-identifier">accountCrossCompat_delegatePkh</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Getter</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountCrossCompat"><span class="hs-identifier hs-type">AccountCrossCompat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Tezos.V004.PublicKeyHash.html#PublicKeyHash"><span class="hs-identifier hs-type">V004.PublicKeyHash</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><a name="accountCrossCompat_delegatePkh"><a href="Tezos.V005.NodeRPC.CrossCompat.html#accountCrossCompat_delegatePkh"><span class="hs-identifier">accountCrossCompat_delegatePkh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">to</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-44"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV004"><span class="hs-identifier hs-var">AccountV004</span></a><span> </span><a name="local-6989586621680519536"><a href="#local-6989586621680519536"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519536"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Tezos.V004.Account.html#account_delegate"><span class="hs-identifier hs-var">V004.account_delegate</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Tezos.V004.Account.html#accountDelegate_value"><span class="hs-identifier hs-var">V004.accountDelegate_value</span></a><span>
</span><a name="line-45"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV005"><span class="hs-identifier hs-var">AccountV005</span></a><span> </span><a name="local-6989586621680519537"><a href="#local-6989586621680519537"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519537"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Tezos.V005.Account.html#account_delegate"><span class="hs-identifier hs-var">V005.account_delegate</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountCrossCompat"><span class="hs-identifier hs-type">AccountCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>  </span><a name="local-8214565720323786234"><span class="hs-identifier">parseJSON</span></a><span> </span><a name="local-6989586621680519534"><a href="#local-6989586621680519534"><span class="hs-identifier">jv</span></a></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV005"><span class="hs-identifier hs-var">AccountV005</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519534"><span class="hs-identifier hs-var">jv</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV004"><span class="hs-identifier hs-var">AccountV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519534"><span class="hs-identifier hs-var">jv</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountCrossCompat"><span class="hs-identifier hs-type">AccountCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>  </span><a name="local-8214565720323786100"><span class="hs-identifier">toJSON</span></a><span> </span><a name="local-6989586621680519531"><a href="#local-6989586621680519531"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680519531"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-54"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV004"><span class="hs-identifier hs-var">AccountV004</span></a><span> </span><a name="local-6989586621680519532"><a href="#local-6989586621680519532"><span class="hs-identifier">a4</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519532"><span class="hs-identifier hs-var">a4</span></a><span>
</span><a name="line-55"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#AccountV005"><span class="hs-identifier hs-var">AccountV005</span></a><span> </span><a name="local-6989586621680519533"><a href="#local-6989586621680519533"><span class="hs-identifier">a5</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519533"><span class="hs-identifier hs-var">a5</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">----</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">data</span><span> </span><a name="ManagerKeyCrossCompat"><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyCrossCompat"><span class="hs-identifier">ManagerKeyCrossCompat</span></a></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ManagerKeyV004"><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV004"><span class="hs-identifier">ManagerKeyV004</span></a></a><span> </span><a href="Tezos.V004.Account.html#ManagerKey"><span class="hs-identifier hs-type">V004.ManagerKey</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ManagerKeyV005"><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV005"><span class="hs-identifier">ManagerKeyV005</span></a></a><span> </span><a href="Tezos.V005.Account.html#ManagerKey"><span class="hs-identifier hs-type">V005.ManagerKey</span></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">managerKeyCrossCompat_key</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Getter</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyCrossCompat"><span class="hs-identifier hs-type">ManagerKeyCrossCompat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Tezos.V004.PublicKey.html#PublicKey"><span class="hs-identifier hs-type">V004.PublicKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><a name="managerKeyCrossCompat_key"><a href="Tezos.V005.NodeRPC.CrossCompat.html#managerKeyCrossCompat_key"><span class="hs-identifier">managerKeyCrossCompat_key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">to</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-66"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV004"><span class="hs-identifier hs-var">ManagerKeyV004</span></a><span> </span><a name="local-6989586621680519538"><a href="#local-6989586621680519538"><span class="hs-identifier">mk</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519538"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Tezos.V004.Account.html#managerKey_key"><span class="hs-identifier hs-var">V004.managerKey_key</span></a><span>
</span><a name="line-67"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV005"><span class="hs-identifier hs-var">ManagerKeyV005</span></a><span> </span><a name="local-6989586621680519539"><a href="#local-6989586621680519539"><span class="hs-identifier">pk</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519539"><span class="hs-identifier hs-var">pk</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyCrossCompat"><span class="hs-identifier hs-type">ManagerKeyCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-70"></a><span>  </span><a name="local-8214565720323786234"><span class="hs-identifier">parseJSON</span></a><span> </span><a name="local-6989586621680519530"><a href="#local-6989586621680519530"><span class="hs-identifier">jv</span></a></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV005"><span class="hs-identifier hs-var">ManagerKeyV005</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519530"><span class="hs-identifier hs-var">jv</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV004"><span class="hs-identifier hs-var">ManagerKeyV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519530"><span class="hs-identifier hs-var">jv</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyCrossCompat"><span class="hs-identifier hs-type">ManagerKeyCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>  </span><a name="local-8214565720323786100"><span class="hs-identifier">toJSON</span></a><span> </span><a name="local-6989586621680519527"><a href="#local-6989586621680519527"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680519527"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-76"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV004"><span class="hs-identifier hs-var">ManagerKeyV004</span></a><span> </span><a name="local-6989586621680519528"><a href="#local-6989586621680519528"><span class="hs-identifier">mk4</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519528"><span class="hs-identifier hs-var">mk4</span></a><span>
</span><a name="line-77"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#ManagerKeyV005"><span class="hs-identifier hs-var">ManagerKeyV005</span></a><span> </span><a name="local-6989586621680519529"><a href="#local-6989586621680519529"><span class="hs-identifier">mk5</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519529"><span class="hs-identifier hs-var">mk5</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">---</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">data</span><span> </span><a name="BlockCrossCompat"><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier">BlockCrossCompat</span></a></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="BlockV004"><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier">BlockV004</span></a></a><span> </span><a href="Tezos.V004.Block.html#Block"><span class="hs-identifier hs-type">V004.Block</span></a><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BlockV005"><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier">BlockV005</span></a></a><span> </span><a href="Tezos.V005.Block.html#Block"><span class="hs-identifier hs-type">V005.Block</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-identifier">blockCrossCata</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#Block"><span class="hs-identifier hs-type">V004.Block</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519535"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.Block.html#Block"><span class="hs-identifier hs-type">V005.Block</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519535"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519535"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-87"></a><a name="blockCrossCata"><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier">blockCrossCata</span></a></a><span> </span><a name="local-6989586621680519540"><a href="#local-6989586621680519540"><span class="hs-identifier">f4</span></a></a><span> </span><a name="local-6989586621680519541"><a href="#local-6989586621680519541"><span class="hs-identifier">f5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-88"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><a name="local-6989586621680519542"><a href="#local-6989586621680519542"><span class="hs-identifier">b4</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519540"><span class="hs-identifier hs-var">f4</span></a><span> </span><a href="#local-6989586621680519542"><span class="hs-identifier hs-var">b4</span></a><span>
</span><a name="line-89"></a><span>  </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><a name="local-6989586621680519543"><a href="#local-6989586621680519543"><span class="hs-identifier">b5</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680519541"><span class="hs-identifier hs-var">f5</span></a><span> </span><a href="#local-6989586621680519543"><span class="hs-identifier hs-var">b5</span></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.Block.html#HasProtocolHash"><span class="hs-identifier hs-type">HasProtocolHash</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-92"></a><span>  </span><a name="local-8214565720324678073"><a href="Tezos.V004.Block.html#protocolHash"><span class="hs-identifier">protocolHash</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#protocolHash"><span class="hs-identifier hs-var">protocolHash</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#protocolHash"><span class="hs-identifier hs-var">protocolHash</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519525"><a href="#local-6989586621680519525"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519526"><a href="#local-6989586621680519526"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span>
</span><a name="line-95"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#protocolHash"><span class="hs-identifier hs-var">protocolHash</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519526"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#protocolHash"><span class="hs-identifier hs-var">protocolHash</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519526"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>      </span><a href="#local-6989586621680519525"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.Block.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-100"></a><span>  </span><a name="local-8214565720324678071"><a href="Tezos.V004.Block.html#chainIdL"><span class="hs-identifier">chainIdL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#chainIdL"><span class="hs-identifier hs-var">chainIdL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#chainIdL"><span class="hs-identifier hs-var">chainIdL</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519523"><a href="#local-6989586621680519523"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519524"><a href="#local-6989586621680519524"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span>
</span><a name="line-103"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#chainIdL"><span class="hs-identifier hs-var">chainIdL</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519524"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#chainIdL"><span class="hs-identifier hs-var">chainIdL</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519524"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>      </span><a href="#local-6989586621680519523"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.Block.html#HasBlockMetadata"><span class="hs-identifier hs-type">HasBlockMetadata</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-8214565720324678069"><a href="Tezos.V004.Block.html#blockMetadata"><span class="hs-identifier">blockMetadata</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#blockMetadata"><span class="hs-identifier hs-var">blockMetadata</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#blockMetadata"><span class="hs-identifier hs-var">blockMetadata</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519521"><a href="#local-6989586621680519521"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519522"><a href="#local-6989586621680519522"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span>
</span><a name="line-111"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#blockMetadata"><span class="hs-identifier hs-var">blockMetadata</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519522"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#blockMetadata"><span class="hs-identifier hs-var">blockMetadata</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519522"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>      </span><a href="#local-6989586621680519521"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.Block.html#HasBlockHeaderFull"><span class="hs-identifier hs-type">HasBlockHeaderFull</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-116"></a><span>  </span><a name="local-8214565720324678067"><a href="Tezos.V004.Block.html#blockHeaderFull"><span class="hs-identifier">blockHeaderFull</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#blockHeaderFull"><span class="hs-identifier hs-var">blockHeaderFull</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#blockHeaderFull"><span class="hs-identifier hs-var">blockHeaderFull</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519519"><a href="#local-6989586621680519519"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519520"><a href="#local-6989586621680519520"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span>
</span><a name="line-119"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#blockHeaderFull"><span class="hs-identifier hs-var">blockHeaderFull</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519520"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>      </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#blockHeaderFull"><span class="hs-identifier hs-var">blockHeaderFull</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519520"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>      </span><a href="#local-6989586621680519519"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.Block.html#BlockLike"><span class="hs-identifier hs-type">BlockLike</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>  </span><a name="local-8214565720324678075"><a href="Tezos.V004.Block.html#hash"><span class="hs-identifier">hash</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#hash"><span class="hs-identifier hs-var">hash</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#hash"><span class="hs-identifier hs-var">hash</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519430"><a href="#local-6989586621680519430"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519431"><a href="#local-6989586621680519431"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#hash"><span class="hs-identifier hs-var">hash</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519431"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#hash"><span class="hs-identifier hs-var">hash</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519431"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519430"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-8214565720324678076"><a href="Tezos.V004.Block.html#predecessor"><span class="hs-identifier">predecessor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#predecessor"><span class="hs-identifier hs-var">predecessor</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#predecessor"><span class="hs-identifier hs-var">predecessor</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519511"><a href="#local-6989586621680519511"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519512"><a href="#local-6989586621680519512"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#predecessor"><span class="hs-identifier hs-var">predecessor</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519512"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#predecessor"><span class="hs-identifier hs-var">predecessor</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519512"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519511"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720324678077"><a href="Tezos.V004.Block.html#level"><span class="hs-identifier">level</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#level"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#level"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519513"><a href="#local-6989586621680519513"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519514"><a href="#local-6989586621680519514"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#level"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519514"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#level"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519514"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519513"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>  </span><a name="local-8214565720324678078"><a href="Tezos.V004.Block.html#fitness"><span class="hs-identifier">fitness</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#fitness"><span class="hs-identifier hs-var">fitness</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#fitness"><span class="hs-identifier hs-var">fitness</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519515"><a href="#local-6989586621680519515"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519516"><a href="#local-6989586621680519516"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#fitness"><span class="hs-identifier hs-var">fitness</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519516"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#fitness"><span class="hs-identifier hs-var">fitness</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519516"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519515"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>  </span><a name="local-8214565720324678079"><a href="Tezos.V004.Block.html#timestamp"><span class="hs-identifier">timestamp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lens</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><a href="Tezos.V004.Block.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680519517"><a href="#local-6989586621680519517"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680519518"><a href="#local-6989586621680519518"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519518"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Tezos.V004.Block.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621680519518"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519517"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><a href="Tezos.V004.BalanceUpdate.html#HasBalanceUpdates"><span class="hs-identifier hs-type">HasBalanceUpdates</span></a><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><a name="local-8214565720324257130"><a href="Tezos.V004.BalanceUpdate.html#balanceUpdates"><span class="hs-identifier">balanceUpdates</span></a></a><span> </span><a name="local-6989586621680519320"><a href="#local-6989586621680519320"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680519321"><a href="#local-6989586621680519321"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#blockCrossCata"><span class="hs-identifier hs-var">blockCrossCata</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Tezos.V004.BalanceUpdate.html#balanceUpdates"><span class="hs-identifier hs-var">balanceUpdates</span></a><span> </span><a href="#local-6989586621680519320"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Tezos.V004.BalanceUpdate.html#balanceUpdates"><span class="hs-identifier hs-var">balanceUpdates</span></a><span> </span><a href="#local-6989586621680519320"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680519321"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-8214565720323786234"><span class="hs-identifier">parseJSON</span></a><span> </span><a name="local-6989586621680519317"><a href="#local-6989586621680519317"><span class="hs-identifier">jv</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Object</span><span> </span><a name="local-6989586621680519318"><a href="#local-6989586621680519318"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-6989586621680519319"><a href="#local-6989586621680519319"><span class="hs-identifier">pv</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680519318"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-operator hs-var">.:</span><span> </span><span class="hs-string">&quot;protocol&quot;</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680519319"><span class="hs-identifier hs-var">pv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-147"></a><span>      </span><span class="hs-comment">-- TODO: This ought to be better.</span><span>
</span><a name="line-148"></a><span>      </span><span class="hs-string">&quot;PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V005 Bugfix</span><span>
</span><a name="line-149"></a><span>      </span><span class="hs-string">&quot;PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V005 / Babylon</span><span>
</span><a name="line-150"></a><span>      </span><span class="hs-string">&quot;Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V004 / Athens</span><span>
</span><a name="line-151"></a><span>      </span><span class="hs-string">&quot;PsddFKi32cMJ2qPjf43Qv5GDWLDPZb3T3bF6fLKiF5HtvHNU7aP&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V003</span><span>
</span><a name="line-152"></a><span>      </span><span class="hs-string">&quot;PsYLVpVvgbLhAhoqAkMFUo6gudkJ9weNXhUYCiLDzcUpFpkk8Wt&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V002</span><span>
</span><a name="line-153"></a><span>      </span><span class="hs-string">&quot;PtCJ7pwoxe8JasnHY8YonnLYjcVHmhiARPJvqcC6VfHT5s8k8sY&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span> </span><span class="hs-comment">-- V001</span><span>
</span><a name="line-154"></a><span>      </span><span class="hs-comment">-- We parse anything that we don't know on V005. This may catch some weird genesis blocks</span><span>
</span><a name="line-155"></a><span>      </span><span class="hs-comment">-- and it'll catch newer protocols if we are too slow to update.</span><span>
</span><a name="line-156"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseJSON</span><span> </span><a href="#local-6989586621680519317"><span class="hs-identifier hs-var">jv</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span>  </span><span class="hs-identifier">parseJSON</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mzero</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockCrossCompat"><span class="hs-identifier hs-type">BlockCrossCompat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720323786100"><span class="hs-identifier">toJSON</span></a><span> </span><a name="local-6989586621680519314"><a href="#local-6989586621680519314"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680519314"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-162"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV004"><span class="hs-identifier hs-var">BlockV004</span></a><span> </span><a name="local-6989586621680519315"><a href="#local-6989586621680519315"><span class="hs-identifier">b4</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519315"><span class="hs-identifier hs-var">b4</span></a><span>
</span><a name="line-163"></a><span>    </span><a href="Tezos.V005.NodeRPC.CrossCompat.html#BlockV005"><span class="hs-identifier hs-var">BlockV005</span></a><span> </span><a name="local-6989586621680519316"><a href="#local-6989586621680519316"><span class="hs-identifier">b5</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-6989586621680519316"><span class="hs-identifier hs-var">b5</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- MichelinePrimitive</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- This added a new primitive &quot;APPLY&quot; into this enum. I've made the executive decision</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- to just treat all blocks as V005 since the only time we'd care is if we were creating</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- a new Michelson expression, using APPLY and somehow wanting to write pre-babylon...</span><span>
</span><a name="line-169"></a></pre></body></html>