<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Michelson.TypeCheck.Instr</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Michelson.TypeCheck.Instr.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">morley-1.0.0: Developer tools for the Michelson Language</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Michelson.TypeCheck.Instr</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module, providing functions for conversion from
 instruction and value representation from <code>Michelson.Type</code> module
 to strictly-typed GADT-based representation from <code>Michelson.Value</code> module.</p><p>This conversion is labeled as type check because that's what we are obliged
 to do on our way.</p><p>Type check algorithm relies on the property of Michelson language that each
 instruction on a given input stack type produces a definite output stack
 type.
 Michelson contract defines concrete types for storage and parameter, from
 which input stack type is deduced. Then this type is being combined with
 each subsequent instruction, producing next stack type after each
 application.</p><p>Function <code>typeCheck</code> takes list of instructions and returns value of type
 <code>Instr inp out</code> along with <code>HST inp</code> and <code>HST out</code> all wrapped into
 <code>SomeInstr</code> data type. This wrapping is done to satsify Haskell type
 system (which has no support for dependent types).
 Functions <code>typeCheckInstr</code>, <code>typeCheckValue</code> behave similarly.</p><p>When a recursive call is made within <code>typeCheck</code>, <code>typeCheckInstr</code> or
 <code>typeCheckValue</code>, result of a call is unwrapped from <code>SomeInstr</code> and type
 information from <code>HST inp</code> and <code>HST out</code> is being used to assert that
 recursive call returned instruction of expected type
 (error is thrown otherwise).</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:typeCheckContract">typeCheckContract</a> :: <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Contract" title="Michelson.Untyped.Aliases">Contract</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> <a href="Michelson-TypeCheck-Types.html#t:SomeContract" title="Michelson.TypeCheck.Types">SomeContract</a></li><li class="src short"><a href="#v:typeCheckValue">typeCheckValue</a> :: <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t =&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="Michelson-Typed-Annotation.html#t:Notes" title="Michelson.Typed.Annotation">Notes</a> t -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheckInstr" title="Michelson.TypeCheck.TypeCheck">TypeCheckInstr</a> <a href="Michelson-TypeCheck-Types.html#t:SomeNotedValue" title="Michelson.TypeCheck.Types">SomeNotedValue</a></li><li class="src short"><a href="#v:typeVerifyValue">typeVerifyValue</a> :: <span class="keyword">forall</span> t. (<a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t, <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t) =&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheckInstr" title="Michelson.TypeCheck.TypeCheck">TypeCheckInstr</a> (<a href="Michelson-Typed-Aliases.html#t:Value" title="Michelson.Typed.Aliases">Value</a> t)</li><li class="src short"><a href="#v:typeCheckList">typeCheckList</a> :: <a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> inp =&gt; [<a href="Michelson-Untyped-Instr.html#t:ExpandedOp" title="Michelson.Untyped.Instr">ExpandedOp</a>] -&gt; <a href="Michelson-TypeCheck-Types.html#t:HST" title="Michelson.TypeCheck.Types">HST</a> inp -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheck" title="Michelson.TypeCheck.TypeCheck">TypeCheck</a> (<a href="Michelson-TypeCheck-Types.html#t:SomeInstr" title="Michelson.TypeCheck.Types">SomeInstr</a> inp)</li><li class="src short"><a href="#v:typeVerifyTopLevelType">typeVerifyTopLevelType</a> :: (<a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t, <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t, <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a>) =&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> (<a href="Michelson-Typed-Aliases.html#t:Value" title="Michelson.Typed.Aliases">Value</a> t)</li><li class="src short"><a href="#v:typeCheckTopLevelType">typeCheckTopLevelType</a> :: <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Type.html#t:Type" title="Michelson.Untyped.Type">Type</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> <a href="Michelson-Typed-Aliases.html#t:SomeValue" title="Michelson.Typed.Aliases">SomeValue</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:typeCheckContract" class="def">typeCheckContract</a> :: <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Contract" title="Michelson.Untyped.Aliases">Contract</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> <a href="Michelson-TypeCheck-Types.html#t:SomeContract" title="Michelson.TypeCheck.Types">SomeContract</a> <a href="src/Michelson.TypeCheck.Instr.html#typeCheckContract" class="link">Source</a> <a href="#v:typeCheckContract" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:typeCheckValue" class="def">typeCheckValue</a> :: <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t =&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="Michelson-Typed-Annotation.html#t:Notes" title="Michelson.Typed.Annotation">Notes</a> t -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheckInstr" title="Michelson.TypeCheck.TypeCheck">TypeCheckInstr</a> <a href="Michelson-TypeCheck-Types.html#t:SomeNotedValue" title="Michelson.TypeCheck.Types">SomeNotedValue</a> <a href="src/Michelson.TypeCheck.Instr.html#typeCheckValue" class="link">Source</a> <a href="#v:typeCheckValue" class="selflink">#</a></p><div class="doc"><p>Function <code>typeCheckValue</code> converts a single Michelson value
 given in representation from <code>Michelson.Untyped</code> module hierarchy to
 representation in strictly typed GADT.</p><p>As a second argument, <code>typeCheckValue</code> accepts expected type of value.</p><p>Type checking algorithm pattern-matches on parse value representation,
 expected type <code>t</code> and constructs <code>Val t</code> value.</p><p>If there was no match on a given pair of value and expected type,
 that is interpreted as input of wrong type and type check finishes with
 error.</p></div></div><div class="top"><p class="src"><a id="v:typeVerifyValue" class="def">typeVerifyValue</a> :: <span class="keyword">forall</span> t. (<a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t, <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t) =&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheckInstr" title="Michelson.TypeCheck.TypeCheck">TypeCheckInstr</a> (<a href="Michelson-Typed-Aliases.html#t:Value" title="Michelson.Typed.Aliases">Value</a> t) <a href="src/Michelson.TypeCheck.Instr.html#typeVerifyValue" class="link">Source</a> <a href="#v:typeVerifyValue" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Michelson-TypeCheck-Instr.html#v:typeCheckValue" title="Michelson.TypeCheck.Instr">typeCheckValue</a></code>, but returns value of a desired type.</p></div></div><div class="top"><p class="src"><a id="v:typeCheckList" class="def">typeCheckList</a> :: <a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> inp =&gt; [<a href="Michelson-Untyped-Instr.html#t:ExpandedOp" title="Michelson.Untyped.Instr">ExpandedOp</a>] -&gt; <a href="Michelson-TypeCheck-Types.html#t:HST" title="Michelson.TypeCheck.Types">HST</a> inp -&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TypeCheck" title="Michelson.TypeCheck.TypeCheck">TypeCheck</a> (<a href="Michelson-TypeCheck-Types.html#t:SomeInstr" title="Michelson.TypeCheck.Types">SomeInstr</a> inp) <a href="src/Michelson.TypeCheck.Instr.html#typeCheckList" class="link">Source</a> <a href="#v:typeCheckList" class="selflink">#</a></p><div class="doc"><p>Function <code>typeCheckList</code> converts list of Michelson instructions
 given in representation from <code>Michelson.Type</code> module to representation
 in strictly typed GADT.</p><p>Types are checked along the way which is neccessary to construct a
 strictly typed value.</p><p>As a second argument, <code>typeCheckList</code> accepts input stack type representation.</p></div></div><div class="top"><p class="src"><a id="v:typeVerifyTopLevelType" class="def">typeVerifyTopLevelType</a> :: (<a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t, <a href="Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> t, <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a>) =&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> (<a href="Michelson-Typed-Aliases.html#t:Value" title="Michelson.Typed.Aliases">Value</a> t) <a href="src/Michelson.TypeCheck.Instr.html#typeVerifyTopLevelType" class="link">Source</a> <a href="#v:typeVerifyTopLevelType" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:typeCheckTopLevelType" class="def">typeCheckTopLevelType</a> :: <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; <a href="Michelson-TypeCheck-TypeCheck.html#t:TcOriginatedContracts" title="Michelson.TypeCheck.TypeCheck">TcOriginatedContracts</a> -&gt; <a href="Michelson-Untyped-Type.html#t:Type" title="Michelson.Untyped.Type">Type</a> -&gt; <a href="Michelson-Untyped-Aliases.html#t:Value" title="Michelson.Untyped.Aliases">Value</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Michelson-TypeCheck-Error.html#t:TCError" title="Michelson.TypeCheck.Error">TCError</a> <a href="Michelson-Typed-Aliases.html#t:SomeValue" title="Michelson.Typed.Aliases">SomeValue</a> <a href="src/Michelson.TypeCheck.Instr.html#typeCheckTopLevelType" class="link">Source</a> <a href="#v:typeCheckTopLevelType" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>