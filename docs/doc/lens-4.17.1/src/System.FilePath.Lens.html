<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-cpp">#ifndef MIN_VERSION_base
#define MIN_VERSION_base(x,y,z) 1
#endif
</span><span>
</span><a name="line-7"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Module      :  System.FilePath.Lens</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Copyright   :  (C) 2012-16 Edward Kmett</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Portability :  Rank2Types</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.FilePath.Lens</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-comment">-- * Operators</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%2F%3E~"><span class="hs-operator hs-var">&lt;/&gt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%2F%3E~"><span class="hs-operator hs-var">&lt;&lt;/&gt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E~"><span class="hs-operator hs-var">&lt;&lt;&lt;/&gt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C.%3E~"><span class="hs-operator hs-var">&lt;.&gt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C.%3E~"><span class="hs-operator hs-var">&lt;&lt;.&gt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E~"><span class="hs-operator hs-var">&lt;&lt;&lt;.&gt;~</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;/&gt;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;&lt;/&gt;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;&lt;&lt;/&gt;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C.%3E%3D"><span class="hs-operator hs-var">&lt;.&gt;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C.%3E%3D"><span class="hs-operator hs-var">&lt;&lt;.&gt;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E%3D"><span class="hs-operator hs-var">&lt;&lt;&lt;.&gt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-comment">-- * Lenses</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#basename"><span class="hs-identifier hs-var">basename</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#directory"><span class="hs-identifier hs-var">directory</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#extension"><span class="hs-identifier hs-var">extension</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#filename"><span class="hs-identifier hs-var">filename</span></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">State</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.FilePath</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;/&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;.&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitExtension</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeBaseName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeDirectory</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeExtension</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeFileName</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.Lens.Indexed.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- $setup</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- &gt;&gt;&gt; :set -XNoOverloadedStrings</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">{- NB: Be very careful if you are planning to modify the doctest output in
this module! Path separators are OS-dependent (\\ with Windows, / with Posix),
so we take great care to avoid using separators in doctest output so that they
will be valid on all operating systems.

If you find yourself wanting to test a function that uses path separators in
the output, it would be wise to:

1. Compare the tested expression and the expected results explicitly using (==).
2. Always use the &lt;/&gt; function (and derived combinators) to construct path
   separators instead of typing them manually. That is, don't type out
   &quot;foo/bar&quot;, but rather &quot;foo&quot; &lt;/&gt; &quot;bar&quot;.

This way we can avoid leaking path separators into the output. See the doctest
example for (&lt;/&gt;~) for an example of how to do this.
-}</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">4</span><span> </span><a href="System.FilePath.Lens.html#%3C%2F%3E~"><span class="hs-operator hs-var">&lt;/&gt;~</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%2F%3E~"><span class="hs-operator hs-var">&lt;&lt;/&gt;~</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E~"><span class="hs-operator hs-var">&lt;&lt;&lt;/&gt;~</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C.%3E~"><span class="hs-operator hs-var">&lt;.&gt;~</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C.%3E~"><span class="hs-operator hs-var">&lt;&lt;.&gt;~</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E~"><span class="hs-operator hs-var">&lt;&lt;&lt;.&gt;~</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><a href="System.FilePath.Lens.html#%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;/&gt;=</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;&lt;/&gt;=</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E%3D"><span class="hs-operator hs-var">&lt;&lt;&lt;/&gt;=</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C.%3E%3D"><span class="hs-operator hs-var">&lt;.&gt;=</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C.%3E%3D"><span class="hs-operator hs-var">&lt;&lt;.&gt;=</span></a><span class="hs-special">,</span><span> </span><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E%3D"><span class="hs-operator hs-var">&lt;&lt;&lt;.&gt;=</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Modify the path by adding another path.</span><span>
</span><a name="line-63"></a><span class="hs-comment">--</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- &gt;&gt;&gt; (both &lt;/&gt;~ &quot;bin&quot; $ (&quot;hello&quot;,&quot;world&quot;)) == (&quot;hello&quot; &lt;/&gt; &quot;bin&quot;, &quot;world&quot; &lt;/&gt; &quot;bin&quot;)</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-66"></a><span class="hs-comment">--</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- ('&lt;/&gt;~') :: 'Setter' s a 'FilePath' 'FilePath' -&gt; 'FilePath' -&gt; s -&gt; a</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- ('&lt;/&gt;~') :: 'Iso' s a 'FilePath' 'FilePath' -&gt; 'FilePath' -&gt; s -&gt; a</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- ('&lt;/&gt;~') :: 'Lens' s a 'FilePath' 'FilePath' -&gt; 'FilePath' -&gt; s -&gt; a</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- ('&lt;/&gt;~') :: 'Traversal' s a 'FilePath' 'FilePath' -&gt; 'FilePath' -&gt; s -&gt; a</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-73"></a><span class="hs-special">(</span><span class="hs-operator">&lt;/&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Setter.html#ASetter"><span class="hs-identifier hs-type">ASetter</span></a><span> </span><a href="#local-6989586621679415525"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415526"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415525"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415526"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-74"></a><a name="local-6989586621679415527"><a href="#local-6989586621679415527"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%2F%3E~"><a href="System.FilePath.Lens.html#%3C%2F%3E~"><span class="hs-operator">&lt;/&gt;~</span></a></a><span> </span><a name="local-6989586621679415528"><a href="#local-6989586621679415528"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a><span> </span><a href="#local-6989586621679415527"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><a href="#local-6989586621679415528"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;/&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Modify the target(s) of a 'Lens'', 'Iso'', 'Setter'' or 'Traversal'' by adding a path.</span><span>
</span><a name="line-79"></a><span class="hs-comment">--</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- &gt;&gt;&gt; execState (both &lt;/&gt;= &quot;bin&quot;) (&quot;hello&quot;,&quot;world&quot;) == (&quot;hello&quot; &lt;/&gt; &quot;bin&quot;, &quot;world&quot; &lt;/&gt; &quot;bin&quot;)</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- ('&lt;/&gt;=') :: 'MonadState' s m =&gt; 'Setter'' s 'FilePath' -&gt; 'FilePath' -&gt; m ()</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- ('&lt;/&gt;=') :: 'MonadState' s m =&gt; 'Iso'' s 'FilePath' -&gt; 'FilePath' -&gt; m ()</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- ('&lt;/&gt;=') :: 'MonadState' s m =&gt; 'Lens'' s 'FilePath' -&gt; 'FilePath' -&gt; m ()</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- ('&lt;/&gt;=') :: 'MonadState' s m =&gt; 'Traversal'' s 'FilePath' -&gt; 'FilePath' -&gt; m ()</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-89"></a><span class="hs-special">(</span><span class="hs-operator">&lt;/&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415523"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415524"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Setter.html#ASetter%27"><span class="hs-identifier hs-type">ASetter'</span></a><span> </span><a href="#local-6989586621679415523"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415524"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><a name="local-6989586621679415661"><a href="#local-6989586621679415661"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%2F%3E%3D"><a href="System.FilePath.Lens.html#%3C%2F%3E%3D"><span class="hs-operator">&lt;/&gt;=</span></a></a><span> </span><a name="local-6989586621679415662"><a href="#local-6989586621679415662"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State.modify</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415661"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="System.FilePath.Lens.html#%3C%2F%3E~"><span class="hs-operator hs-var">&lt;/&gt;~</span></a><span> </span><a href="#local-6989586621679415662"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;/&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | Add a path onto the end of the target of a 'Lens' and return the result</span><span>
</span><a name="line-95"></a><span class="hs-comment">--</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- When you do not need the result of the operation, ('&lt;/&gt;~') is more flexible.</span><span>
</span><a name="line-97"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;/&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#LensLike"><span class="hs-identifier hs-type">LensLike</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415521"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415522"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415521"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415522"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><a name="local-6989586621679415663"><a href="#local-6989586621679415663"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%2F%3E~"><a href="System.FilePath.Lens.html#%3C%3C%2F%3E~"><span class="hs-operator">&lt;&lt;/&gt;~</span></a></a><span> </span><a name="local-6989586621679415664"><a href="#local-6989586621679415664"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415663"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%3C%25~"><span class="hs-operator hs-var">&lt;%~</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><a href="#local-6989586621679415664"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;/&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | Add a path onto the end of the target of a 'Lens' into</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- your monad's state and return the result.</span><span>
</span><a name="line-104"></a><span class="hs-comment">--</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- When you do not need the result of the operation, ('&lt;/&gt;=') is more flexible.</span><span>
</span><a name="line-106"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;/&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415519"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415520"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Type.html#LensLike%27"><span class="hs-identifier hs-type">LensLike'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415519"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415520"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-107"></a><a name="local-6989586621679415665"><a href="#local-6989586621679415665"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%2F%3E%3D"><a href="System.FilePath.Lens.html#%3C%3C%2F%3E%3D"><span class="hs-operator">&lt;&lt;/&gt;=</span></a></a><span> </span><a name="local-6989586621679415666"><a href="#local-6989586621679415666"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415665"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%3C%25%3D"><span class="hs-operator hs-var">&lt;%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><a href="#local-6989586621679415666"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;/&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;&lt;/&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Optical%27"><span class="hs-identifier hs-type">Optical'</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415517"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415518"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415517"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679415518"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415518"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><a name="local-6989586621679415667"><a href="#local-6989586621679415667"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%3C%2F%3E~"><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E~"><span class="hs-operator">&lt;&lt;&lt;/&gt;~</span></a></a><span> </span><a name="local-6989586621679415668"><a href="#local-6989586621679415668"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415667"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679415669"><a href="#local-6989586621679415669"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415669"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415669"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><a href="#local-6989586621679415668"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;&lt;/&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;&lt;/&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415515"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415516"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Type.html#LensLike%27"><span class="hs-identifier hs-type">LensLike'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415515"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415516"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-116"></a><a name="local-6989586621679415670"><a href="#local-6989586621679415670"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%3C%2F%3E%3D"><a href="System.FilePath.Lens.html#%3C%3C%3C%2F%3E%3D"><span class="hs-operator">&lt;&lt;&lt;/&gt;=</span></a></a><span> </span><a name="local-6989586621679415671"><a href="#local-6989586621679415671"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415670"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679415672"><a href="#local-6989586621679415672"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415672"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415672"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><a href="#local-6989586621679415671"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;&lt;/&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Modify the path by adding an extension.</span><span>
</span><a name="line-120"></a><span class="hs-comment">--</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- &gt;&gt;&gt; both &lt;.&gt;~ &quot;txt&quot; $ (&quot;hello&quot;,&quot;world&quot;)</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- (&quot;hello.txt&quot;,&quot;world.txt&quot;)</span><span>
</span><a name="line-123"></a><span class="hs-comment">--</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- ('&lt;.&gt;~') :: 'Setter' s a 'FilePath' 'FilePath' -&gt; 'String' -&gt; s -&gt; a</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- ('&lt;.&gt;~') :: 'Iso' s a 'FilePath' 'FilePath' -&gt; 'String' -&gt; s -&gt; a</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- ('&lt;.&gt;~') :: 'Lens' s a 'FilePath' 'FilePath' -&gt; 'String' -&gt; s -&gt; a</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- ('&lt;.&gt;~') :: 'Traversal' s a 'FilePath' 'FilePath' -&gt; 'String' -&gt; s -&gt; a</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-130"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Setter.html#ASetter"><span class="hs-identifier hs-type">ASetter</span></a><span> </span><a href="#local-6989586621679415513"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415514"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415513"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415514"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-131"></a><a name="local-6989586621679415673"><a href="#local-6989586621679415673"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C.%3E~"><a href="System.FilePath.Lens.html#%3C.%3E~"><span class="hs-operator">&lt;.&gt;~</span></a></a><span> </span><a name="local-6989586621679415674"><a href="#local-6989586621679415674"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a><span> </span><a href="#local-6989586621679415673"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679415674"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;.&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- | Modify the target(s) of a 'Lens'', 'Iso'', 'Setter'' or 'Traversal'' by adding an extension.</span><span>
</span><a name="line-135"></a><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- &gt;&gt;&gt; execState (both &lt;.&gt;= &quot;txt&quot;) (&quot;hello&quot;,&quot;world&quot;)</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- (&quot;hello.txt&quot;,&quot;world.txt&quot;)</span><span>
</span><a name="line-138"></a><span class="hs-comment">--</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- ('&lt;.&gt;=') :: 'MonadState' s m =&gt; 'Setter'' s 'FilePath' -&gt; 'String' -&gt; m ()</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- ('&lt;.&gt;=') :: 'MonadState' s m =&gt; 'Iso'' s 'FilePath' -&gt; 'String' -&gt; m ()</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- ('&lt;.&gt;=') :: 'MonadState' s m =&gt; 'Lens'' s 'FilePath' -&gt; 'String' -&gt; m ()</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- ('&lt;.&gt;=') :: 'MonadState' s m =&gt; 'Traversal'' s 'FilePath' -&gt; 'String' -&gt; m ()</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-145"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415511"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415512"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Setter.html#ASetter%27"><span class="hs-identifier hs-type">ASetter'</span></a><span> </span><a href="#local-6989586621679415511"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415512"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><a name="local-6989586621679415675"><a href="#local-6989586621679415675"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C.%3E%3D"><a href="System.FilePath.Lens.html#%3C.%3E%3D"><span class="hs-operator">&lt;.&gt;=</span></a></a><span> </span><a name="local-6989586621679415676"><a href="#local-6989586621679415676"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State.modify</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415675"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="System.FilePath.Lens.html#%3C.%3E~"><span class="hs-operator hs-var">&lt;.&gt;~</span></a><span> </span><a href="#local-6989586621679415676"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;.&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Add an extension onto the end of the target of a 'Lens' and return the result</span><span>
</span><a name="line-150"></a><span class="hs-comment">--</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- &gt;&gt;&gt; _1 &lt;&lt;.&gt;~ &quot;txt&quot; $ (&quot;hello&quot;,&quot;world&quot;)</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- (&quot;hello.txt&quot;,(&quot;hello.txt&quot;,&quot;world&quot;))</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- When you do not need the result of the operation, ('&lt;.&gt;~') is more flexible.</span><span>
</span><a name="line-155"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;.&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#LensLike"><span class="hs-identifier hs-type">LensLike</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415509"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415509"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415510"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><a name="local-6989586621679415677"><a href="#local-6989586621679415677"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C.%3E~"><a href="System.FilePath.Lens.html#%3C%3C.%3E~"><span class="hs-operator">&lt;&lt;.&gt;~</span></a></a><span> </span><a name="local-6989586621679415678"><a href="#local-6989586621679415678"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415677"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%3C%25~"><span class="hs-operator hs-var">&lt;%~</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679415678"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;.&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Add an extension onto the end of the target of a 'Lens' into</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- your monad's state and return the result.</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- &gt;&gt;&gt; evalState (_1 &lt;&lt;.&gt;= &quot;txt&quot;) (&quot;hello&quot;,&quot;world&quot;)</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- &quot;hello.txt&quot;</span><span>
</span><a name="line-165"></a><span class="hs-comment">--</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- When you do not need the result of the operation, ('&lt;.&gt;=') is more flexible.</span><span>
</span><a name="line-167"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;.&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415507"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415508"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Type.html#LensLike%27"><span class="hs-identifier hs-type">LensLike'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415507"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415508"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-168"></a><a name="local-6989586621679415679"><a href="#local-6989586621679415679"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C.%3E%3D"><a href="System.FilePath.Lens.html#%3C%3C.%3E%3D"><span class="hs-operator">&lt;&lt;.&gt;=</span></a></a><span> </span><a name="local-6989586621679415680"><a href="#local-6989586621679415680"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415679"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%3C%25%3D"><span class="hs-operator hs-var">&lt;%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679415680"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;.&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | Add an extension onto the end of the target of a 'Lens' but</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- return the old value</span><span>
</span><a name="line-173"></a><span class="hs-comment">--</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- &gt;&gt;&gt; _1 &lt;&lt;&lt;.&gt;~ &quot;txt&quot; $ (&quot;hello&quot;,&quot;world&quot;)</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- (&quot;hello&quot;,(&quot;hello.txt&quot;,&quot;world&quot;))</span><span>
</span><a name="line-176"></a><span class="hs-comment">--</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- When you do not need the old value, ('&lt;.&gt;~') is more flexible.</span><span>
</span><a name="line-178"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;&lt;.&gt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Optical%27"><span class="hs-identifier hs-type">Optical'</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415505"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415506"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415505"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679415506"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415506"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><a name="local-6989586621679415681"><a href="#local-6989586621679415681"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%3C.%3E~"><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E~"><span class="hs-operator">&lt;&lt;&lt;.&gt;~</span></a></a><span> </span><a name="local-6989586621679415682"><a href="#local-6989586621679415682"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415681"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679415683"><a href="#local-6989586621679415683"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415683"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415683"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679415682"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;&lt;.&gt;~</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;&lt;.&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679415503"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679415504"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Lens.Type.html#LensLike%27"><span class="hs-identifier hs-type">LensLike'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679415503"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679415504"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-183"></a><a name="local-6989586621679415684"><a href="#local-6989586621679415684"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%3C.%3E%3D"><a href="System.FilePath.Lens.html#%3C%3C%3C.%3E%3D"><span class="hs-operator">&lt;&lt;&lt;.&gt;=</span></a></a><span> </span><a name="local-6989586621679415685"><a href="#local-6989586621679415685"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679415684"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Control.Lens.Lens.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679415686"><a href="#local-6989586621679415686"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415686"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679415686"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679415685"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&lt;&lt;.&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- | A 'Lens' for reading and writing to the basename</span><span>
</span><a name="line-187"></a><span class="hs-comment">--</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- Note: This is 'not' a legal 'Lens' unless the outer 'FilePath' has both a directory</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- and filename component and the generated basenames are not null and contain no directory</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- separators.</span><span>
</span><a name="line-191"></a><span class="hs-comment">--</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- &gt;&gt;&gt; (basename .~ &quot;filename&quot; $ &quot;path&quot; &lt;/&gt; &quot;name.png&quot;) == &quot;path&quot; &lt;/&gt; &quot;filename.png&quot;</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-194"></a><span class="hs-identifier">basename</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-195"></a><a name="basename"><a href="System.FilePath.Lens.html#basename"><span class="hs-identifier">basename</span></a></a><span> </span><a name="local-6989586621679415687"><a href="#local-6989586621679415687"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679415688"><a href="#local-6989586621679415688"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><span class="hs-identifier hs-var">takeExtension</span><span> </span><a href="#local-6989586621679415688"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeDirectory</span><span> </span><a href="#local-6989586621679415688"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&lt;/&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679415687"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeBaseName</span><span> </span><a href="#local-6989586621679415688"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">basename</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | A 'Lens' for reading and writing to the directory</span><span>
</span><a name="line-200"></a><span class="hs-comment">--</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- Note: this is /not/ a legal 'Lens' unless the outer 'FilePath' already has a directory component,</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- and generated directories are not null.</span><span>
</span><a name="line-203"></a><span class="hs-comment">--</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- &gt;&gt;&gt; ((&quot;long&quot; &lt;/&gt; &quot;path&quot; &lt;/&gt; &quot;name.txt&quot;) ^. directory) == &quot;long&quot; &lt;/&gt; &quot;path&quot;</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-206"></a><span class="hs-identifier">directory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-207"></a><a name="directory"><a href="System.FilePath.Lens.html#directory"><span class="hs-identifier">directory</span></a></a><span> </span><a name="local-6989586621679415689"><a href="#local-6989586621679415689"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679415690"><a href="#local-6989586621679415690"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;/&gt;</span><span> </span><span class="hs-identifier hs-var">takeFileName</span><span> </span><a href="#local-6989586621679415690"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679415689"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeDirectory</span><span> </span><a href="#local-6989586621679415690"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">directory</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- | A 'Lens' for reading and writing to the extension</span><span>
</span><a name="line-212"></a><span class="hs-comment">--</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- Note: This is /not/ a legal 'Lens', unless you are careful to ensure that generated</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- extension 'FilePath' components are either null or start with 'System.FilePath.extSeparator'</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- and do not contain any internal 'System.FilePath.extSeparator's.</span><span>
</span><a name="line-216"></a><span class="hs-comment">--</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- &gt;&gt;&gt; (extension .~ &quot;.png&quot; $ &quot;path&quot; &lt;/&gt; &quot;name.txt&quot;) == &quot;path&quot; &lt;/&gt; &quot;name.png&quot;</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-219"></a><span class="hs-identifier">extension</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-220"></a><a name="extension"><a href="System.FilePath.Lens.html#extension"><span class="hs-identifier">extension</span></a></a><span> </span><a name="local-6989586621679415691"><a href="#local-6989586621679415691"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679415692"><a href="#local-6989586621679415692"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679415693"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679415691"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679415694"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-221"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679415693"><a href="#local-6989586621679415693"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679415694"><a href="#local-6989586621679415694"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitExtension</span><span> </span><a href="#local-6989586621679415692"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-223"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">extension</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | A 'Lens' for reading and writing to the full filename</span><span>
</span><a name="line-227"></a><span class="hs-comment">--</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- Note: This is /not/ a legal 'Lens', unless you are careful to ensure that generated</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- filename 'FilePath' components are not null and do not contain any</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- elements of 'System.FilePath.pathSeparators's.</span><span>
</span><a name="line-231"></a><span class="hs-comment">--</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- &gt;&gt;&gt; (filename .~ &quot;name.txt&quot; $ &quot;path&quot; &lt;/&gt; &quot;name.png&quot;) == &quot;path&quot; &lt;/&gt; &quot;name.txt&quot;</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-234"></a><span class="hs-identifier">filename</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-235"></a><a name="filename"><a href="System.FilePath.Lens.html#filename"><span class="hs-identifier">filename</span></a></a><span> </span><a name="local-6989586621679415695"><a href="#local-6989586621679415695"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679415696"><a href="#local-6989586621679415696"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeDirectory</span><span> </span><a href="#local-6989586621679415696"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&lt;/&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679415695"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeFileName</span><span> </span><a href="#local-6989586621679415696"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">filename</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-237"></a></pre></body></html>