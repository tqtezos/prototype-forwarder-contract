<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lorentz.UStore.Migration.Base</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Lorentz.UStore.Migration.Base.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">lorentz-0.1.0: EDSL for the Michelson Language</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Lorentz.UStore.Migration.Base</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1"><code>UStore</code> utilities</a></li><li><a href="#g:2">Basic migration primitives</a><ul><li><a href="#g:3">Simple migrations</a></li><li><a href="#g:4">Batched migrations</a></li></ul></li><li><a href="#g:5">Manual migrations</a></li><li><a href="#g:6">Extras</a></li><li><a href="#g:7">Internals</a></li><li><a href="#section.orphans">Orphan instances</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Basic migration primitives.</p><p>All primitives in one scheme:</p><p>MigrationBlocks
                   (batched migrations writing)
                    /|          ||
           muBlock //           || mkUStoreBatchedMigration
                  //            ||
                 //             ||
             MUStore            ||         UStore template value
    (simple migration writing)  ||       (storage initialization)
                    \          ||         //
                     \         ||        //
    mkUStoreMigration \        ||       // fillUStore
                       |       /      |/
                         UStoreMigration
                        (whole migration)
                              ||    \
                              ||     \
            migrationToScript ||      \ compileMigration
                              ||       \                    MigrationBatching
                              ||        \                (way to slice migration)
                              ||         \                    //
                              ||          \                  //
                              ||           |                |/
                              ||         UStoreMigrationCompiled
                              ||           (sliced migration)
                              ||          //                 \
                              ||    migrationToScripts        \ buildMigrationPlan
                              ||        //                     \ migrationStagesNum
                              ||       //                       \ ...
                              /      |/                         |
                        MigrationScript                    Information about migration
                    (part of migration which            (migration plan, stages number...)
                  fits into Tezos transaction)</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:SomeUTemplate">SomeUTemplate</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:UStore_">UStore_</a> = <a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:MigrationScript">MigrationScript</a> (oldStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) = <a href="#v:MigrationScript">MigrationScript</a> {<ul class="subs"><li><a href="#v:unMigrationScript">unMigrationScript</a> :: <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a></li></ul>}</li><li class="src short"><a href="#v:maNameL">maNameL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li class="src short"><a href="#v:maScriptL">maScriptL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a></li><li class="src short"><a href="#v:maActionsDescL">maActionsDescL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:MigrationScriptFrom">MigrationScriptFrom</a> oldStore = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:MigrationScriptTo">MigrationScriptTo</a> newStore = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> newStore</li><li class="src short"><span class="keyword">type</span> <a href="#t:MigrationScript_">MigrationScript_</a> = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:MigrationAtom">MigrationAtom</a> = <a href="#v:MigrationAtom">MigrationAtom</a> {<ul class="subs"><li><a href="#v:maName">maName</a> :: <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li><a href="#v:maScript">maScript</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a></li><li><a href="#v:maActionsDesc">maActionsDesc</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:UStoreMigration">UStoreMigration</a> (oldTempl :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTempl :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <span class="keyword">where</span><ul class="subs"><li><a href="#v:UStoreMigration">UStoreMigration</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>] -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl</li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:MigrationBlocks">MigrationBlocks</a> (oldTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (preRemDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (preTouched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) (postRemDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (postTouched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) = <a href="#v:MigrationBlocks">MigrationBlocks</a> [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>]</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:MUStore">MUStore</a> (oldTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (remDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (touched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) = <a href="#v:MUStoreUnsafe">MUStoreUnsafe</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldTemplate)</li><li class="src short"><a href="#v:migrationToLambda">migrationToLambda</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTemplate newTemplate -&gt; <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldTemplate) (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newTemplate)</li><li class="src short"><a href="#v:mapMigrationCode">mapMigrationCode</a> :: (<span class="keyword">forall</span> i o. (i <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> o) -&gt; i <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> o) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns</li><li class="src short"><a href="#v:mkUStoreMigration">mkUStoreMigration</a> :: <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTempl newTempl (<a href="Lorentz-UStore-Migration-Diff.html#t:BuildDiff" title="Lorentz.UStore.Migration.Diff">BuildDiff</a> oldTempl newTempl) '[]) (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTempl newTempl '[] _1) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl</li><li class="src short"><a href="#v:migrationToScript">migrationToScript</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns</li><li class="src short"><a href="#v:migrationToScriptI">migrationToScriptI</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="../base-4.12.0.0/Data-Functor-Identity.html#t:Identity" title="Data.Functor.Identity">Identity</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns)</li><li class="src short"><span class="keyword">data</span> <a href="#t:MigrationBatching">MigrationBatching</a> (structure :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (batchInfo :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) = <a href="#v:MigrationBatching">MigrationBatching</a> ([<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>] -&gt; structure (batchInfo, <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a>))</li><li class="src short"><a href="#v:mbBatchesAsIs">mbBatchesAsIs</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> [] <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li class="src short"><a href="#v:mbNoBatching">mbNoBatching</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> <a href="../base-4.12.0.0/Data-Functor-Identity.html#t:Identity" title="Data.Functor.Identity">Identity</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li class="src short"><a href="#v:compileMigration">compileMigration</a> :: <a href="../base-4.12.0.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> t batchInfo -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> ot nt -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:UStoreMigrationCompiled">UStoreMigrationCompiled</a> (oldStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (structure :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (batchInfo :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) = <a href="#v:UStoreMigrationCompiled">UStoreMigrationCompiled</a> {<ul class="subs"><li><a href="#v:compiledMigrationContent">compiledMigrationContent</a> :: structure (batchInfo, <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</li></ul>}</li><li class="src short"><a href="#v:mkUStoreBatchedMigration">mkUStoreBatchedMigration</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBlocks" title="Lorentz.UStore.Migration.Base">MigrationBlocks</a> oldTempl newTempl (<a href="Lorentz-UStore-Migration-Diff.html#t:BuildDiff" title="Lorentz.UStore.Migration.Diff">BuildDiff</a> oldTempl newTempl) '[] '[] _1 -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl</li><li class="src short"><a href="#v:migrationToScripts">migrationToScripts</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> os ns t batchInfo -&gt; t (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns)</li><li class="src short"><a href="#v:migrationToScriptsList">migrationToScriptsList</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> os ns t batchInfo -&gt; [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns]</li><li class="src short"><a href="#v:migrationToInfo">migrationToInfo</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; t batchInfo</li><li class="src short"><a href="#v:migrationStagesNum">migrationStagesNum</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:buildMigrationPlan">buildMigrationPlan</a> :: (<a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../fmt-0.6.1.2/Fmt.html#t:Buildable" title="Fmt">Buildable</a> batchInfo) =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; <a href="../fmt-0.6.1.2/Fmt.html#t:Builder" title="Fmt">Builder</a></li><li class="src short"><a href="#v:manualWithOldUStore">manualWithOldUStore</a> :: ('[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldStore] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldStore]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore</li><li class="src short"><a href="#v:manualWithNewUStore">manualWithNewUStore</a> :: ('[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newStore] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newStore]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore</li><li class="src short"><a href="#v:manualConcatMigrationScripts">manualConcatMigrationScripts</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns] -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns</li><li class="src short"><a href="#v:manualMapMigrationScript">manualMapMigrationScript</a> :: (('[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>]) -&gt; '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore</li><li class="src short"><span class="keyword">data</span> <a href="#t:DMigrationActionType">DMigrationActionType</a><ul class="subs"><li>= <a href="#v:DAddAction">DAddAction</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li>| <a href="#v:DDelAction">DDelAction</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:DMigrationActionDesc">DMigrationActionDesc</a> = <a href="#v:DMigrationActionDesc">DMigrationActionDesc</a> {<ul class="subs"><li><a href="#v:manAction">manAction</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a></li><li><a href="#v:manField">manField</a> :: <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></li><li><a href="#v:manFieldType">manFieldType</a> :: <a href="../morley-1.0.0/Michelson-Typed-T.html#t:T" title="Michelson.Typed.T">T</a></li></ul>}</li><li class="src short"><a href="#v:attachMigrationActionName">attachMigrationActionName</a> :: <a href="../morley-1.0.0/Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> fieldTy) =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a> -&gt; <a href="Lorentz-Value.html#t:Label" title="Lorentz.Value">Label</a> fieldName -&gt; <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> fieldTy -&gt; s <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> s</li><li class="src short"><a href="#v:formMigrationAtom">formMigrationAtom</a> :: <a href="Lorentz-Prelude.html#t:Maybe" title="Lorentz.Prelude">Maybe</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> -&gt; <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1><code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code> utilities</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SomeUTemplate" class="def">SomeUTemplate</a> <a href="src/Lorentz.UStore.Migration.Base.html#SomeUTemplate" class="link">Source</a> <a href="#t:SomeUTemplate" class="selflink">#</a></p><div class="doc"><p>Dummy template for <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code>, use this when you want to forget exact template
 and make type of store homomorphic.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:UStore_" class="def">UStore_</a> = <a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> <a href="src/Lorentz.UStore.Migration.Base.html#UStore_" class="link">Source</a> <a href="#t:UStore_" class="selflink">#</a></p><div class="doc"><p>UStore with hidden template.</p></div></div><a href="#g:2" id="g:2"><h1>Basic migration primitives</h1></a><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:MigrationScript" class="def">MigrationScript</a> (oldStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Lorentz.UStore.Migration.Base.html#MigrationScript" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></p><div class="doc"><p>Code of migration for <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code>.</p><p>Invariant: preferably should fit into op size / gas limits (quite obvious).
 Often this stands for exactly one stage of migration (one Tezos transaction).</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MigrationScript" class="def">MigrationScript</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:unMigrationScript" class="def">unMigrationScript</a> :: <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:MigrationScript" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:CanCastTo:1"></span> <a href="Lorentz-Coercions.html#t:CanCastTo" title="Lorentz.Coercions">CanCastTo</a> (<a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> ot1) (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> nt1)) (<a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> ot2) (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> nt2)) =&gt; <a href="Lorentz-Coercions.html#t:CanCastTo" title="Lorentz.Coercions">CanCastTo</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> ot1 nt1 :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> ot2 nt2 :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-167" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:CanCastTo:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:castDummy">castDummy</a> :: <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> ot1 nt1) -&gt; <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> ot2 nt2) -&gt; () <a href="src/Lorentz.Coercions.html#castDummy" class="link">Source</a> <a href="#v:castDummy" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:Show:2"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-153" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:Generic:3"></span> <a href="Lorentz-Prelude.html#t:Generic" title="Lorentz.Prelude">Generic</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-153" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:Generic:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) x -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:Wrapped:4"></span> <a href="Lorentz-Coercions.html#t:Wrapped" title="Lorentz.Coercions">Wrapped</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-156" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:Wrapped:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Lorentz-Coercions.html#t:Unwrapped" title="Lorentz.Coercions">Unwrapped</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Unwrapped" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:_Wrapped-39-">_Wrapped'</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Iso-39-" title="Control.Lens.Type">Iso'</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) (<a href="Lorentz-Coercions.html#t:Unwrapped" title="Lorentz.Coercions">Unwrapped</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)) <a href="#v:_Wrapped-39-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:TypeHasDoc:5"></span> (<a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> oldStore, <a href="../base-4.12.0.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> newStore) =&gt; <a href="Lorentz-Doc.html#t:TypeHasDoc" title="Lorentz.Doc">TypeHasDoc</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-158" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:TypeHasDoc:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:typeDocName">typeDocName</a> :: <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) -&gt; <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> <a href="#v:typeDocName" class="selflink">#</a></p><p class="src"><a href="#v:typeDocMdDescription">typeDocMdDescription</a> :: <a href="Lorentz-Doc.html#t:Markdown" title="Lorentz.Doc">Markdown</a> <a href="#v:typeDocMdDescription" class="selflink">#</a></p><p class="src"><a href="#v:typeDocMdReference">typeDocMdReference</a> :: <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) -&gt; <a href="../morley-1.0.0/Michelson-Typed-Haskell-Doc.html#t:WithinParens" title="Michelson.Typed.Haskell.Doc">WithinParens</a> -&gt; <a href="Lorentz-Doc.html#t:Markdown" title="Lorentz.Doc">Markdown</a> <a href="#v:typeDocMdReference" class="selflink">#</a></p><p class="src"><a href="#v:typeDocDependencies">typeDocDependencies</a> :: <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) -&gt; [<a href="Lorentz-Doc.html#t:SomeTypeWithDoc" title="Lorentz.Doc">SomeTypeWithDoc</a>] <a href="#v:typeDocDependencies" class="selflink">#</a></p><p class="src"><a href="#v:typeDocHaskellRep">typeDocHaskellRep</a> :: <a href="../morley-1.0.0/Michelson-Typed-Haskell-Doc.html#t:TypeDocHaskellRep" title="Michelson.Typed.Haskell.Doc">TypeDocHaskellRep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) <a href="#v:typeDocHaskellRep" class="selflink">#</a></p><p class="src"><a href="#v:typeDocMichelsonRep">typeDocMichelsonRep</a> :: <a href="../morley-1.0.0/Michelson-Typed-Haskell-Doc.html#t:TypeDocMichelsonRep" title="Michelson.Typed.Haskell.Doc">TypeDocMichelsonRep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) <a href="#v:typeDocMichelsonRep" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:IsoValue:6"></span> <a href="Lorentz-Value.html#t:IsoValue" title="Lorentz.Value">IsoValue</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-154" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:IsoValue:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) :: <a href="../morley-1.0.0/Michelson-Typed-T.html#t:T" title="Michelson.Typed.T">T</a> <a href="#t:ToT" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toVal">toVal</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="Lorentz-Value.html#t:Value" title="Lorentz.Value">Value</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)) <a href="#v:toVal" class="selflink">#</a></p><p class="src"><a href="#v:fromVal">fromVal</a> :: <a href="Lorentz-Value.html#t:Value" title="Lorentz.Value">Value</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore <a href="#v:fromVal" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:HasTypeAnn:7"></span> <a href="Lorentz-TypeAnns.html#t:HasTypeAnn" title="Lorentz.TypeAnns">HasTypeAnn</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-154" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:HasTypeAnn:7"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getTypeAnn">getTypeAnn</a> :: <a href="../morley-1.0.0/Michelson-Typed-Annotation.html#t:Notes" title="Michelson.Typed.Annotation">Notes</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)) <a href="src/Lorentz.TypeAnns.html#getTypeAnn" class="link">Source</a> <a href="#v:getTypeAnn" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:Rep:8"></span> <span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-153" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:Rep:8"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) = <a href="../base-4.12.0.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;MigrationScript&quot; &quot;Lorentz.UStore.Migration.Base&quot; &quot;lorentz-0.1.0-34InOYPWuH88380O5o3fdq&quot; <a href="Lorentz-Value.html#v:True" title="Lorentz.Value">True</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;MigrationScript&quot; <a href="../base-4.12.0.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> <a href="Lorentz-Value.html#v:True" title="Lorentz.Value">True</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> (<a href="Lorentz-Prelude.html#v:Just" title="Lorentz.Prelude">Just</a> &quot;unMigrationScript&quot;) <a href="../base-4.12.0.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> <a href="../base-4.12.0.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> <a href="../base-4.12.0.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (<a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>))))</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:Unwrapped:9"></span> <span class="keyword">type</span> <a href="Lorentz-Coercions.html#t:Unwrapped" title="Lorentz.Coercions">Unwrapped</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-156" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:Unwrapped:9"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="Lorentz-Coercions.html#t:Unwrapped" title="Lorentz.Coercions">Unwrapped</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) = GUnwrapped (<a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore))</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationScript:ToT:10"></span> <span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-154" class="link">Source</a> <a href="#t:MigrationScript" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationScript:ToT:10"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore) = <a href="../morley-1.0.0/Michelson-Typed-Haskell-Value.html#t:GValueType" title="Michelson.Typed.Haskell.Value">GValueType</a> (<a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:maNameL" class="def">maNameL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> <a href="src/Lorentz.UStore.Migration.Base.html#maNameL" class="link">Source</a> <a href="#v:maNameL" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:maScriptL" class="def">maScriptL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a> <a href="src/Lorentz.UStore.Migration.Base.html#maScriptL" class="link">Source</a> <a href="#v:maScriptL" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:maActionsDescL" class="def">maActionsDescL</a> :: <a href="../lens-4.17.1/Control-Lens-Type.html#t:Lens-39-" title="Control.Lens.Type">Lens'</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>] <a href="src/Lorentz.UStore.Migration.Base.html#maActionsDescL" class="link">Source</a> <a href="#v:maActionsDescL" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MigrationScriptFrom" class="def">MigrationScriptFrom</a> oldStore = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> <a href="src/Lorentz.UStore.Migration.Base.html#MigrationScriptFrom" class="link">Source</a> <a href="#t:MigrationScriptFrom" class="selflink">#</a></p><div class="doc"><p>Corner case of <code><a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a></code> with some type argument unknown.</p><p>You can turn this into <code><a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a></code> using <code><a href="Lorentz-Coercions.html#v:checkedCoerce" title="Lorentz.Coercions">checkedCoerce</a></code>.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MigrationScriptTo" class="def">MigrationScriptTo</a> newStore = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> newStore <a href="src/Lorentz.UStore.Migration.Base.html#MigrationScriptTo" class="link">Source</a> <a href="#t:MigrationScriptTo" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MigrationScript_" class="def">MigrationScript_</a> = <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> <a href="Lorentz-UStore-Migration-Base.html#t:SomeUTemplate" title="Lorentz.UStore.Migration.Base">SomeUTemplate</a> <a href="src/Lorentz.UStore.Migration.Base.html#MigrationScript_" class="link">Source</a> <a href="#t:MigrationScript_" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MigrationAtom" class="def">MigrationAtom</a> <a href="src/Lorentz.UStore.Migration.Base.html#MigrationAtom" class="link">Source</a> <a href="#t:MigrationAtom" class="selflink">#</a></p><div class="doc"><p>Minimal possible piece of migration script.</p><p>Different atoms can be arbitrarily reordered and separated across migration
 stages, but each single atom is treated as a whole.</p><p>Splitting migration into atoms is responsibility of migration writer.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MigrationAtom" class="def">MigrationAtom</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:maName" class="def">maName</a> :: <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maScript" class="def">maScript</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maActionsDesc" class="def">maActionsDesc</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:MigrationAtom" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationAtom:Show:1"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-265" class="link">Source</a> <a href="#t:MigrationAtom" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MigrationAtom:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UStoreMigration" class="def">UStoreMigration</a> (oldTempl :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTempl :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <span class="keyword">where</span> <a href="src/Lorentz.UStore.Migration.Base.html#UStoreMigration" class="link">Source</a> <a href="#t:UStoreMigration" class="selflink">#</a></p><div class="doc"><p>Keeps information about migration between <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code>s with two given
 templates.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UStoreMigration" class="def">UStoreMigration</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>] -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:MigrationBlocks" class="def">MigrationBlocks</a> (oldTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (preRemDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (preTouched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) (postRemDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (postTouched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) <a href="src/Lorentz.UStore.Migration.Base.html#MigrationBlocks" class="link">Source</a> <a href="#t:MigrationBlocks" class="selflink">#</a></p><div class="doc"><p>A bunch of migration atoms produced by migration writer.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MigrationBlocks" class="def">MigrationBlocks</a> [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><details id="i:MigrationBlocks" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MigrationBlocks:MigrationFinishCheckPosition:1"></span> (<a href="Lorentz-UStore-Migration-Diff.html#t:RequireEmptyDiff" title="Lorentz.UStore.Migration.Diff">RequireEmptyDiff</a> d1, t1 ~ t2) =&gt; <a href="Lorentz-UStore-Migration-Blocks.html#t:MigrationFinishCheckPosition" title="Lorentz.UStore.Migration.Blocks">MigrationFinishCheckPosition</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationBlocks" title="Lorentz.UStore.Migration.Base">MigrationBlocks</a> o n d1 t1 ([] :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) t2)</span> <a href="src/Lorentz.UStore.Migration.Blocks.html#line-284" class="link">Source</a> <a href="#t:MigrationFinishCheckPosition" class="selflink">#</a></td><td class="doc"><p>This version can be used in <code>mkUStoreMultiMigration</code> as the last migration
 block.</p></td></tr><tr><td colspan="2"><details id="i:id:MigrationBlocks:MigrationFinishCheckPosition:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Blocks.html">Lorentz.UStore.Migration.Blocks</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:migrationFinish">migrationFinish</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBlocks" title="Lorentz.UStore.Migration.Base">MigrationBlocks</a> o n d1 t1 [] t2 <a href="src/Lorentz.UStore.Migration.Blocks.html#migrationFinish" class="link">Source</a> <a href="#v:migrationFinish" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:MUStore" class="def">MUStore</a> (oldTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newTemplate :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (remDiff :: [<a href="Lorentz-UStore-Migration-Diff.html#t:DiffItem" title="Lorentz.UStore.Migration.Diff">DiffItem</a>]) (touched :: [<a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>]) <a href="src/Lorentz.UStore.Migration.Base.html#MUStore" class="link">Source</a> <a href="#t:MUStore" class="selflink">#</a></p><div class="doc"><p>Wrapper over <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code> which is currently being migrated.</p><p>In type-level arguments it keeps</p><ul><li>Old and new <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code> templates - mostly for convenience of the implementation.</li><li>Remaining diff which yet should be covered. Here we track migration progress.
Once remaining diff is empty, migration is finished.</li><li>Names of fields which have already been touched by migration.
Required to make getters safe.</li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MUStoreUnsafe" class="def">MUStoreUnsafe</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldTemplate)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><details id="i:MUStore" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MUStore:Generic:1"></span> <a href="Lorentz-Prelude.html#t:Generic" title="Lorentz.Prelude">Generic</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-316" class="link">Source</a> <a href="#t:MUStore" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MUStore:Generic:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched -&gt; <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) x -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MUStore:IsoValue:2"></span> <a href="Lorentz-Value.html#t:IsoValue" title="Lorentz.Value">IsoValue</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-317" class="link">Source</a> <a href="#t:MUStore" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MUStore:IsoValue:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) :: <a href="../morley-1.0.0/Michelson-Typed-T.html#t:T" title="Michelson.Typed.T">T</a> <a href="#t:ToT" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toVal">toVal</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched -&gt; <a href="Lorentz-Value.html#t:Value" title="Lorentz.Value">Value</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)) <a href="#v:toVal" class="selflink">#</a></p><p class="src"><a href="#v:fromVal">fromVal</a> :: <a href="Lorentz-Value.html#t:Value" title="Lorentz.Value">Value</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched <a href="#v:fromVal" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MUStore:Rep:3"></span> <span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-316" class="link">Source</a> <a href="#t:MUStore" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MUStore:Rep:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) = <a href="../base-4.12.0.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;MUStore&quot; &quot;Lorentz.UStore.Migration.Base&quot; &quot;lorentz-0.1.0-34InOYPWuH88380O5o3fdq&quot; <a href="Lorentz-Value.html#v:True" title="Lorentz.Value">True</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;MUStoreUnsafe&quot; <a href="../base-4.12.0.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> <a href="Lorentz-Value.html#v:False" title="Lorentz.Value">False</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> (<a href="../base-4.12.0.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> (<a href="Lorentz-Prelude.html#v:Nothing" title="Lorentz.Prelude">Nothing</a> :: <a href="Lorentz-Prelude.html#t:Maybe" title="Lorentz.Prelude">Maybe</a> <a href="../base-4.12.0.0/GHC-TypeLits.html#t:Symbol" title="GHC.TypeLits">Symbol</a>) <a href="../base-4.12.0.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> <a href="../base-4.12.0.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> <a href="../base-4.12.0.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.12.0.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldTemplate))))</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MUStore:ToT:4"></span> <span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-317" class="link">Source</a> <a href="#t:MUStore" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MUStore:ToT:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched) = <a href="../morley-1.0.0/Michelson-Typed-Haskell-Value.html#t:GValueType" title="Michelson.Typed.Haskell.Value">GValueType</a> (<a href="../base-4.12.0.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTemplate newTemplate remDiff touched))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:migrationToLambda" class="def">migrationToLambda</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTemplate newTemplate -&gt; <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldTemplate) (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newTemplate) <a href="src/Lorentz.UStore.Migration.Base.html#migrationToLambda" class="link">Source</a> <a href="#v:migrationToLambda" class="selflink">#</a></p><div class="doc"><p>Turn <code>Migration</code> into a whole piece of code for transforming storage.</p><p>This is not want you'd want to use for contract deployment because of
 gas and operation size limits that Tezos applies to transactions.</p></div></div><div class="top"><p class="src"><a id="v:mapMigrationCode" class="def">mapMigrationCode</a> :: (<span class="keyword">forall</span> i o. (i <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> o) -&gt; i <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> o) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns <a href="src/Lorentz.UStore.Migration.Base.html#mapMigrationCode" class="link">Source</a> <a href="#v:mapMigrationCode" class="selflink">#</a></p><div class="doc"><p>Modify all code in migration.</p></div></div><a href="#g:3" id="g:3"><h2>Simple migrations</h2></a><div class="top"><p class="src"><a id="v:mkUStoreMigration" class="def">mkUStoreMigration</a> :: <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTempl newTempl (<a href="Lorentz-UStore-Migration-Diff.html#t:BuildDiff" title="Lorentz.UStore.Migration.Diff">BuildDiff</a> oldTempl newTempl) '[]) (<a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a> oldTempl newTempl '[] _1) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl <a href="src/Lorentz.UStore.Migration.Base.html#mkUStoreMigration" class="link">Source</a> <a href="#v:mkUStoreMigration" class="selflink">#</a></p><div class="doc"><p>Safe way to create migration scripts for <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code>.</p><p>You have to supply a code which would transform <code><a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a></code>,
 coverring required diff step-by-step.
 All basic instructions work, also use <code>migrate*</code> functions
 from this module to operate with <code><a href="Lorentz-UStore-Migration-Base.html#t:MUStore" title="Lorentz.UStore.Migration.Base">MUStore</a></code>.</p><p>This method produces a whole migration, it cannot be splitted in batches.
 In case if your migration is too big to be applied within a single
 transaction, use <code><a href="Lorentz-UStore-Migration-Base.html#v:mkUStoreBatchedMigration" title="Lorentz.UStore.Migration.Base">mkUStoreBatchedMigration</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:migrationToScript" class="def">migrationToScript</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns <a href="src/Lorentz.UStore.Migration.Base.html#migrationToScript" class="link">Source</a> <a href="#v:migrationToScript" class="selflink">#</a></p><div class="doc"><p>Get migration script in case of simple (non-batched) migration.</p></div></div><div class="top"><p class="src"><a id="v:migrationToScriptI" class="def">migrationToScriptI</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> os ns -&gt; <a href="../base-4.12.0.0/Data-Functor-Identity.html#t:Identity" title="Data.Functor.Identity">Identity</a> (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns) <a href="src/Lorentz.UStore.Migration.Base.html#migrationToScriptI" class="link">Source</a> <a href="#v:migrationToScriptI" class="selflink">#</a></p><div class="doc"><p>Get migration script in case of simple (non-batched) migration.</p></div></div><a href="#g:4" id="g:4"><h2>Batched migrations</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MigrationBatching" class="def">MigrationBatching</a> (structure :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (batchInfo :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Lorentz.UStore.Migration.Base.html#MigrationBatching" class="link">Source</a> <a href="#t:MigrationBatching" class="selflink">#</a></p><div class="doc"><p>Way of distributing migration atoms among batches.</p><p>This also participates in describing migration plan and should contain
 information which would clarify to a user why migration is splitted
 such a way. Objects of type <code>batchInfo</code> stand for information corresponding to
 a batch and may include e.g. names of taken actions and gas consumption.</p><p>Type argument <code>structure</code> stands for container where batches will be put to
 and is usually a list ('[]').</p><p>When writing an instance of this datatype, you should tend to produce
 as few batches as possible because Tezos transaction execution overhead
 is quite high; though these batches should still preferably fit into gas limit.</p><p>Note that we never fail here because reaching perfect consistency with Tezos
 gas model is beyond dreams for now, even if our model predicts that some
 migration atom cannot be fit into gas limit, Tezos node can think differently
 and accept the migration.
 If your batching function can make predictions about fitting into gas limit,
 consider including this information in <code>batchInfo</code> type.</p><p>See batching implementations in <a href="Lorentz-UStore-Migration-Batching.html">Lorentz.UStore.Migration.Batching</a> module.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MigrationBatching" class="def">MigrationBatching</a> ([<a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a>] -&gt; structure (batchInfo, <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript_" title="Lorentz.UStore.Migration.Base">MigrationScript_</a>))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:mbBatchesAsIs" class="def">mbBatchesAsIs</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> [] <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> <a href="src/Lorentz.UStore.Migration.Base.html#mbBatchesAsIs" class="link">Source</a> <a href="#v:mbBatchesAsIs" class="selflink">#</a></p><div class="doc"><p>Put each migration atom to a separate batch.</p><p>In most cases this is not what you want, but may be useful if e.g. you write
 your migration manually.</p></div></div><div class="top"><p class="src"><a id="v:mbNoBatching" class="def">mbNoBatching</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> <a href="../base-4.12.0.0/Data-Functor-Identity.html#t:Identity" title="Data.Functor.Identity">Identity</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> <a href="src/Lorentz.UStore.Migration.Base.html#mbNoBatching" class="link">Source</a> <a href="#v:mbNoBatching" class="selflink">#</a></p><div class="doc"><p>Put the whole migration into one batch.</p></div></div><div class="top"><p class="src"><a id="v:compileMigration" class="def">compileMigration</a> :: <a href="../base-4.12.0.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBatching" title="Lorentz.UStore.Migration.Base">MigrationBatching</a> t batchInfo -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> ot nt -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo <a href="src/Lorentz.UStore.Migration.Base.html#compileMigration" class="link">Source</a> <a href="#v:compileMigration" class="selflink">#</a></p><div class="doc"><p>Compile migration for use in production.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:UStoreMigrationCompiled" class="def">UStoreMigrationCompiled</a> (oldStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (newStore :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (structure :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (batchInfo :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Lorentz.UStore.Migration.Base.html#UStoreMigrationCompiled" class="link">Source</a> <a href="#t:UStoreMigrationCompiled" class="selflink">#</a></p><div class="doc"><p>Migration script splitted in batches.</p><p>This is an intermediate form of migration content and needed because
 compiling <code><a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a></code> is a potentially heavyweight operation,
 and after compilation is performed you may need to get various information like
 number of migration steps, migration script, migration plan and other.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UStoreMigrationCompiled" class="def">UStoreMigrationCompiled</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:compiledMigrationContent" class="def">compiledMigrationContent</a> :: structure (batchInfo, <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:mkUStoreBatchedMigration" class="def">mkUStoreBatchedMigration</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:MigrationBlocks" title="Lorentz.UStore.Migration.Base">MigrationBlocks</a> oldTempl newTempl (<a href="Lorentz-UStore-Migration-Diff.html#t:BuildDiff" title="Lorentz.UStore.Migration.Diff">BuildDiff</a> oldTempl newTempl) '[] '[] _1 -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigration" title="Lorentz.UStore.Migration.Base">UStoreMigration</a> oldTempl newTempl <a href="src/Lorentz.UStore.Migration.Base.html#mkUStoreBatchedMigration" class="link">Source</a> <a href="#v:mkUStoreBatchedMigration" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="Lorentz-UStore-Migration-Base.html#v:mkUStoreMigration" title="Lorentz.UStore.Migration.Base">mkUStoreMigration</a></code> which allows splitting migration in batches.</p><p>Here you supply a sequence of migration blocks which then are automatically
 distributed among migration stages.</p></div></div><div class="top"><p class="src"><a id="v:migrationToScripts" class="def">migrationToScripts</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> os ns t batchInfo -&gt; t (<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns) <a href="src/Lorentz.UStore.Migration.Base.html#migrationToScripts" class="link">Source</a> <a href="#v:migrationToScripts" class="selflink">#</a></p><div class="doc"><p>Get migration scripts, each to be executed in separate Tezos transaction.</p></div></div><div class="top"><p class="src"><a id="v:migrationToScriptsList" class="def">migrationToScriptsList</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> os ns t batchInfo -&gt; [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns] <a href="src/Lorentz.UStore.Migration.Base.html#migrationToScriptsList" class="link">Source</a> <a href="#v:migrationToScriptsList" class="selflink">#</a></p><div class="doc"><p>Get migration scripts as list.</p></div></div><div class="top"><p class="src"><a id="v:migrationToInfo" class="def">migrationToInfo</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; t batchInfo <a href="src/Lorentz.UStore.Migration.Base.html#migrationToInfo" class="link">Source</a> <a href="#v:migrationToInfo" class="selflink">#</a></p><div class="doc"><p>Get information about each batch.</p></div></div><div class="top"><p class="src"><a id="v:migrationStagesNum" class="def">migrationStagesNum</a> :: <a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Lorentz.UStore.Migration.Base.html#migrationStagesNum" class="link">Source</a> <a href="#v:migrationStagesNum" class="selflink">#</a></p><div class="doc"><p>Number of stages in migration.</p></div></div><div class="top"><p class="src"><a id="v:buildMigrationPlan" class="def">buildMigrationPlan</a> :: (<a href="../base-4.12.0.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../fmt-0.6.1.2/Fmt.html#t:Buildable" title="Fmt">Buildable</a> batchInfo) =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:UStoreMigrationCompiled" title="Lorentz.UStore.Migration.Base">UStoreMigrationCompiled</a> ot nt t batchInfo -&gt; <a href="../fmt-0.6.1.2/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="src/Lorentz.UStore.Migration.Base.html#buildMigrationPlan" class="link">Source</a> <a href="#v:buildMigrationPlan" class="selflink">#</a></p><div class="doc"><p>Render migration plan.</p></div></div><a href="#g:5" id="g:5"><h1>Manual migrations</h1></a><div class="top"><p class="src"><a id="v:manualWithOldUStore" class="def">manualWithOldUStore</a> :: ('[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldStore] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> oldStore]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore <a href="src/Lorentz.UStore.Migration.Base.html#manualWithOldUStore" class="link">Source</a> <a href="#v:manualWithOldUStore" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:manualWithNewUStore" class="def">manualWithNewUStore</a> :: ('[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newStore] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> newStore]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore <a href="src/Lorentz.UStore.Migration.Base.html#manualWithNewUStore" class="link">Source</a> <a href="#v:manualWithNewUStore" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:manualConcatMigrationScripts" class="def">manualConcatMigrationScripts</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns] -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> os ns <a href="src/Lorentz.UStore.Migration.Base.html#manualConcatMigrationScripts" class="link">Source</a> <a href="#v:manualConcatMigrationScripts" class="selflink">#</a></p><div class="doc"><p>Merge several migration scripts. Used in manual migrations.</p><p>This function is generally unsafe because resulting migration script can fail
 to fit into operation size limit.</p></div></div><div class="top"><p class="src"><a id="v:manualMapMigrationScript" class="def">manualMapMigrationScript</a> :: (('[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>]) -&gt; '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>] <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> '[<a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a>]) -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationScript" title="Lorentz.UStore.Migration.Base">MigrationScript</a> oldStore newStore <a href="src/Lorentz.UStore.Migration.Base.html#manualMapMigrationScript" class="link">Source</a> <a href="#v:manualMapMigrationScript" class="selflink">#</a></p></div><a href="#g:6" id="g:6"><h1>Extras</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DMigrationActionType" class="def">DMigrationActionType</a> <a href="src/Lorentz.UStore.Migration.Base.html#DMigrationActionType" class="link">Source</a> <a href="#t:DMigrationActionType" class="selflink">#</a></p><div class="doc"><p>An action on storage entry.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DAddAction" class="def">DAddAction</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></td><td class="doc"><p>Some sort of addition: &quot;init&quot;, &quot;set&quot;, &quot;overwrite&quot;, e.t.c.</p></td></tr><tr><td class="src"><a id="v:DDelAction" class="def">DDelAction</a></td><td class="doc"><p>Removal.</p></td></tr></table></div><div class="subs instances"><details id="i:DMigrationActionType" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionType:Show:1"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-212" class="link">Source</a> <a href="#t:DMigrationActionType" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionType:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionType:Buildable:2"></span> <a href="../fmt-0.6.1.2/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-214" class="link">Source</a> <a href="#t:DMigrationActionType" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionType:Buildable:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a> -&gt; <a href="../fmt-0.6.1.2/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DMigrationActionDesc" class="def">DMigrationActionDesc</a> <a href="src/Lorentz.UStore.Migration.Base.html#DMigrationActionDesc" class="link">Source</a> <a href="#t:DMigrationActionDesc" class="selflink">#</a></p><div class="doc"><p>Describes single migration action.</p><p>In most cases it is possible to derive reasonable description for migration
 atom automatically, this datatype exactly carries this information.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DMigrationActionDesc" class="def">DMigrationActionDesc</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:manAction" class="def">manAction</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a></dfn><div class="doc"><p>Action on field, e.g. &quot;set&quot;, &quot;remove&quot;, &quot;overwrite&quot;.</p></div></li><li><dfn class="src"><a id="v:manField" class="def">manField</a> :: <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a></dfn><div class="doc"><p>Name of affected field of <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code>.</p></div></li><li><dfn class="src"><a id="v:manFieldType" class="def">manFieldType</a> :: <a href="../morley-1.0.0/Michelson-Typed-T.html#t:T" title="Michelson.Typed.T">T</a></dfn><div class="doc"><p>Type of affected field of <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code> in new storage version.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:DMigrationActionDesc" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionDesc:Show:1"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-230" class="link">Source</a> <a href="#t:DMigrationActionDesc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionDesc:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionDesc:DocItem:2"></span> <a href="Lorentz-Doc.html#t:DocItem" title="Lorentz.Doc">DocItem</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-235" class="link">Source</a> <a href="#t:DMigrationActionDesc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionDesc:DocItem:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPosition" title="Lorentz.Doc">DocItemPosition</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> = (pos :: <a href="../base-4.12.0.0/GHC-TypeNats.html#t:Nat" title="GHC.TypeNats">Nat</a>) <a href="#t:DocItemPosition" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPlacement" title="Lorentz.Doc">DocItemPlacement</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> :: <a href="Lorentz-Doc.html#t:DocItemPlacementKind" title="Lorentz.Doc">DocItemPlacementKind</a> <a href="#t:DocItemPlacement" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:docItemSectionName">docItemSectionName</a> :: <a href="Lorentz-Prelude.html#t:Maybe" title="Lorentz.Prelude">Maybe</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> <a href="#v:docItemSectionName" class="selflink">#</a></p><p class="src"><a href="#v:docItemSectionDescription">docItemSectionDescription</a> :: <a href="Lorentz-Prelude.html#t:Maybe" title="Lorentz.Prelude">Maybe</a> <a href="Lorentz-Doc.html#t:Markdown" title="Lorentz.Doc">Markdown</a> <a href="#v:docItemSectionDescription" class="selflink">#</a></p><p class="src"><a href="#v:docItemSectionNameStyle">docItemSectionNameStyle</a> :: <a href="Lorentz-Doc.html#t:DocSectionNameStyle" title="Lorentz.Doc">DocSectionNameStyle</a> <a href="#v:docItemSectionNameStyle" class="selflink">#</a></p><p class="src"><a href="#v:docItemRef">docItemRef</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> -&gt; <a href="Lorentz-Doc.html#t:DocItemRef" title="Lorentz.Doc">DocItemRef</a> (<a href="Lorentz-Doc.html#t:DocItemPlacement" title="Lorentz.Doc">DocItemPlacement</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>) <a href="#v:docItemRef" class="selflink">#</a></p><p class="src"><a href="#v:docItemToMarkdown">docItemToMarkdown</a> :: <a href="../morley-1.0.0/Util-Markdown.html#t:HeaderLevel" title="Util.Markdown">HeaderLevel</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> -&gt; <a href="Lorentz-Doc.html#t:Markdown" title="Lorentz.Doc">Markdown</a> <a href="#v:docItemToMarkdown" class="selflink">#</a></p><p class="src"><a href="#v:docItemDependencies">docItemDependencies</a> :: <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> -&gt; [<a href="Lorentz-Doc.html#t:SomeDocDefinitionItem" title="Lorentz.Doc">SomeDocDefinitionItem</a>] <a href="#v:docItemDependencies" class="selflink">#</a></p><p class="src"><a href="#v:docItemsOrder">docItemsOrder</a> :: [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>] -&gt; [<a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a>] <a href="#v:docItemsOrder" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionDesc:DocItemPlacement:3"></span> <span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPlacement" title="Lorentz.Doc">DocItemPlacement</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-235" class="link">Source</a> <a href="#t:DMigrationActionDesc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionDesc:DocItemPlacement:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPlacement" title="Lorentz.Doc">DocItemPlacement</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> = <a href="Lorentz-Doc.html#v:DocItemInlined" title="Lorentz.Doc">DocItemInlined</a></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DMigrationActionDesc:DocItemPosition:4"></span> <span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPosition" title="Lorentz.Doc">DocItemPosition</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a></span> <a href="src/Lorentz.UStore.Migration.Base.html#line-236" class="link">Source</a> <a href="#t:DMigrationActionDesc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DMigrationActionDesc:DocItemPosition:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Lorentz-UStore-Migration-Base.html">Lorentz.UStore.Migration.Base</a></p> <div class="src"><span class="keyword">type</span> <a href="Lorentz-Doc.html#t:DocItemPosition" title="Lorentz.Doc">DocItemPosition</a> <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionDesc" title="Lorentz.UStore.Migration.Base">DMigrationActionDesc</a> = 105010</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:attachMigrationActionName" class="def">attachMigrationActionName</a> :: <a href="../morley-1.0.0/Michelson-Typed-Scope.html#t:SingI" title="Michelson.Typed.Scope">SingI</a> (<a href="Lorentz-Value.html#t:ToT" title="Lorentz.Value">ToT</a> fieldTy) =&gt; <a href="Lorentz-UStore-Migration-Base.html#t:DMigrationActionType" title="Lorentz.UStore.Migration.Base">DMigrationActionType</a> -&gt; <a href="Lorentz-Value.html#t:Label" title="Lorentz.Value">Label</a> fieldName -&gt; <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> fieldTy -&gt; s <a href="Lorentz-Base.html#t::-45--62-" title="Lorentz.Base">:-&gt;</a> s <a href="src/Lorentz.UStore.Migration.Base.html#attachMigrationActionName" class="link">Source</a> <a href="#v:attachMigrationActionName" class="selflink">#</a></p><div class="doc"><p>Add description of action, it will be used in rendering migration plan and
 some batching implementations.</p></div></div><a href="#g:7" id="g:7"><h1>Internals</h1></a><div class="top"><p class="src"><a id="v:formMigrationAtom" class="def">formMigrationAtom</a> :: <a href="Lorentz-Prelude.html#t:Maybe" title="Lorentz.Prelude">Maybe</a> <a href="Lorentz-Prelude.html#t:Text" title="Lorentz.Prelude">Text</a> -&gt; <a href="Lorentz-Base.html#t:Lambda" title="Lorentz.Base">Lambda</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> <a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a> -&gt; <a href="Lorentz-UStore-Migration-Base.html#t:MigrationAtom" title="Lorentz.UStore.Migration.Base">MigrationAtom</a> <a href="src/Lorentz.UStore.Migration.Base.html#formMigrationAtom" class="link">Source</a> <a href="#v:formMigrationAtom" class="selflink">#</a></p><div class="doc"><p>Create migration atom from code.</p><p>This is an internal function, should not be used for writing migrations.</p></div></div><h1>Orphan instances</h1><div id="section.orphans"><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:CanCastTo:CanCastTo:1"></span> SameUStoreTemplate template1 template2 =&gt; <a href="Lorentz-Coercions.html#t:CanCastTo" title="Lorentz.Coercions">CanCastTo</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> template1 :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> template2 :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>)</span> <a href="src/Lorentz.UStore.Migration.Base.html#line-132" class="link">Source</a> <a href="#v:-36-fCanCastToTYPETYPEUStoreUStore" class="selflink">#</a></td><td class="doc"><p>We allow casting between <code><a href="Lorentz-UStore-Migration-Base.html#t:UStore_" title="Lorentz.UStore.Migration.Base">UStore_</a></code> and <code><a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a></code> freely.</p></td></tr><tr><td colspan="2"><details id="i:o:ic:CanCastTo:CanCastTo:1"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:castDummy">castDummy</a> :: <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> template1) -&gt; <a href="Lorentz-Prelude.html#t:Proxy" title="Lorentz.Prelude">Proxy</a> (<a href="Lorentz-UStore-Types.html#t:UStore" title="Lorentz.UStore.Types">UStore</a> template2) -&gt; () <a href="src/Lorentz.Coercions.html#castDummy" class="link">Source</a> <a href="#v:castDummy" class="selflink">#</a></p></div></details></td></tr></table></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>