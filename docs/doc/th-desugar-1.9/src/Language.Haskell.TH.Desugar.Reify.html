<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Reify.hs

(c) Richard Eisenberg 2014
rae@cs.brynmawr.edu

Allows for reification from a list of declarations, without looking a name
up in the environment.
-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE CPP, GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Reify</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-comment">-- * Reification</span><span>
</span><a name="line-14"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithWarning"><span class="hs-identifier hs-var">reifyWithWarning</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier hs-var">reifyInDecs</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-comment">-- ** Fixity reification</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-identifier hs-var">qReifyFixity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reifyFixity</span><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-var">reifyFixityWithLocals</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier hs-var">reifyFixityInDecs</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-comment">-- * Datatype lookup</span><span>
</span><a name="line-20"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-comment">-- * Value and type lookup</span><span>
</span><a name="line-23"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier hs-var">lookupValueNameWithLocals</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier hs-var">lookupTypeNameWithLocals</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkDataNameWithLocals"><span class="hs-identifier hs-var">mkDataNameWithLocals</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkTypeNameWithLocals"><span class="hs-identifier hs-var">mkTypeNameWithLocals</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyNameSpace"><span class="hs-identifier hs-var">reifyNameSpace</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-comment">-- * Monad support</span><span>
</span><a name="line-28"></a><span>  </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#withLocalDeclarations"><span class="hs-identifier hs-var">withLocalDeclarations</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Writer</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.RWS</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-37"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><a name="line-39"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-41"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Monad.Fail</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Fail</span><span>
</span><a name="line-43"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Fail</span><span>
</span><a name="line-45"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.ExpandSyns</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">expandSyns</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Instances</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Syntax</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Like @reify@ from Template Haskell, but looks also in any not-yet-typechecked</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- declarations. To establish this list of not-yet-typechecked declarations,</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- use 'withLocalDeclarations'. Returns 'Nothing' if reification fails.</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- Note that no inferred type information is available from local declarations;</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- bottoms may be used if necessary.</span><span>
</span><a name="line-58"></a><span class="hs-identifier">reifyWithLocals_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193214"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193214"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Info</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><a name="reifyWithLocals_maybe"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier">reifyWithLocals_maybe</span></a></a><span> </span><a name="local-6989586621679193215"><a href="#local-6989586621679193215"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">qRecover</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier hs-var">reifyInDecs</span></a><span> </span><a href="#local-6989586621679193215"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">qReify</span><span> </span><a href="#local-6989586621679193215"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | Like 'reifyWithLocals_maybe', but throws an exception upon failure,</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- warning the user about separating splices.</span><span>
</span><a name="line-65"></a><span class="hs-identifier">reifyWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193213"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193213"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-66"></a><a name="reifyWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier">reifyWithLocals</span></a></a><span> </span><a name="local-6989586621679193216"><a href="#local-6989586621679193216"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-67"></a><span>  </span><a name="local-6989586621679193217"><a href="#local-6989586621679193217"><span class="hs-identifier">m_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a><span> </span><a href="#local-6989586621679193216"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193217"><span class="hs-identifier hs-var">m_info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-var">reifyFail</span></a><span> </span><a href="#local-6989586621679193216"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193218"><a href="#local-6989586621679193218"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193218"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Reify a declaration, warning the user about splices if the reify fails.</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- The warning says that reification can fail if you try to reify a type in</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- the same splice as it is declared.</span><span>
</span><a name="line-75"></a><span class="hs-identifier">reifyWithWarning</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Quasi</span><span> </span><a href="#local-6989586621679193212"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193212"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-76"></a><a name="reifyWithWarning"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithWarning"><span class="hs-identifier">reifyWithWarning</span></a></a><span> </span><a name="local-6989586621679193219"><a href="#local-6989586621679193219"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">qRecover</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-var">reifyFail</span></a><span> </span><a href="#local-6989586621679193219"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">qReify</span><span> </span><a href="#local-6989586621679193219"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Print out a warning about separating splices and fail.</span><span>
</span><a name="line-79"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-identifier">reifyFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fail.MonadFail</span><span> </span><a href="#local-6989586621679193210"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193210"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679193211"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-81"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-83"></a><span class="hs-cpp">#endif
</span><a name="reifyFail"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier">reifyFail</span></a></a><span> </span><a name="local-6989586621679193220"><a href="#local-6989586621679193220"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-identifier hs-var">Fail.fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Looking up &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679193220"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; in the list of available &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-86"></a><span>              </span><span class="hs-string">&quot;declarations failed.\nThis lookup fails if the declaration &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-87"></a><span>              </span><span class="hs-string">&quot;referenced was made in the same Template\nHaskell splice as the use &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-88"></a><span>              </span><span class="hs-string">&quot;of the declaration. If this is the case, put\nthe reference to &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-89"></a><span>              </span><span class="hs-string">&quot;the declaration in a new splice.&quot;</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- Utilities</span><span>
</span><a name="line-93"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Extract the @TyVarBndr@s and constructors given the @Name@ of a type</span><span>
</span><a name="line-96"></a><span class="hs-identifier">getDataD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193209"><span class="hs-identifier hs-type">q</span></a><span>
</span><a name="line-97"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>       </span><span class="hs-comment">-- ^ Print this out on failure</span><span>
</span><a name="line-98"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>         </span><span class="hs-comment">-- ^ Name of the datatype (@data@ or @newtype@) of interest</span><span>
</span><a name="line-99"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193209"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyVarBndr</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><a name="getDataD"><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier">getDataD</span></a></a><span> </span><a name="local-6989586621679193221"><a href="#local-6989586621679193221"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-6989586621679193222"><a href="#local-6989586621679193222"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-101"></a><span>  </span><a name="local-6989586621679193231"><a href="#local-6989586621679193231"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a><span> </span><a href="#local-6989586621679193222"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-102"></a><span>  </span><a name="local-6989586621679193233"><a href="#local-6989586621679193233"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193231"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-103"></a><span>           </span><span class="hs-identifier hs-var">TyConI</span><span> </span><a name="local-6989586621679193232"><a href="#local-6989586621679193232"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193232"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-104"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193224"><span class="hs-identifier hs-var">badDeclaration</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193233"><span class="hs-identifier hs-var">dec</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-106"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier hs-var">DataD</span><span> </span><a name="local-6989586621679193234"><a href="#local-6989586621679193234"><span class="hs-identifier">_cxt</span></a></a><span> </span><a name="local-6989586621679193235"><a href="#local-6989586621679193235"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679193236"><a href="#local-6989586621679193236"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193237"><a href="#local-6989586621679193237"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621679193238"><a href="#local-6989586621679193238"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679193239"><a href="#local-6989586621679193239"><span class="hs-identifier">_derivings</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193223"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679193236"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193237"><span class="hs-identifier hs-var">mk</span></a><span> </span><a href="#local-6989586621679193238"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-identifier hs-var">NewtypeD</span><span> </span><a name="local-6989586621679193240"><a href="#local-6989586621679193240"><span class="hs-identifier">_cxt</span></a></a><span> </span><a name="local-6989586621679193241"><a href="#local-6989586621679193241"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679193242"><a href="#local-6989586621679193242"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193243"><a href="#local-6989586621679193243"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621679193244"><a href="#local-6989586621679193244"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679193245"><a href="#local-6989586621679193245"><span class="hs-identifier">_derivings</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193223"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679193242"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193243"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193244"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_cxt</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_derivings</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_cxt</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_derivings</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193224"><span class="hs-identifier hs-var">badDeclaration</span></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>    </span><a name="local-6989586621679193223"><a href="#local-6989586621679193223"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679193225"><a href="#local-6989586621679193225"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193226"><a href="#local-6989586621679193226"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621679193227"><a href="#local-6989586621679193227"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-116"></a><span>      </span><a name="local-6989586621679193228"><a href="#local-6989586621679193228"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">runQ</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">expandSyns</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193226"><span class="hs-identifier hs-var">mk</span></a><span>
</span><a name="line-117"></a><span>      </span><a name="local-6989586621679193229"><a href="#local-6989586621679193229"><span class="hs-identifier">extra_tvbs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#mkExtraKindBindersGeneric"><span class="hs-identifier hs-var">mkExtraKindBindersGeneric</span></a><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a><span> </span><span class="hs-identifier hs-var">KindedTV</span><span> </span><a href="#local-6989586621679193228"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-118"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679193230"><a href="#local-6989586621679193230"><span class="hs-identifier">all_tvbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193225"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193229"><span class="hs-identifier hs-var">extra_tvbs</span></a><span>
</span><a name="line-119"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193230"><span class="hs-identifier hs-var">all_tvbs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193227"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>    </span><a name="local-6989586621679193224"><a href="#local-6989586621679193224"><span class="hs-identifier">badDeclaration</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-122"></a><span>          </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;The name (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679193222"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;) refers to something &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-123"></a><span>                 </span><span class="hs-string">&quot;other than a datatype. &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193221"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | From the name of a data constructor, retrive the datatype definition it</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- is a part of.</span><span>
</span><a name="line-127"></a><span class="hs-identifier">dataConNameToDataName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193208"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193208"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-128"></a><a name="dataConNameToDataName"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier">dataConNameToDataName</span></a></a><span> </span><a name="local-6989586621679193246"><a href="#local-6989586621679193246"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>  </span><a name="local-6989586621679193247"><a href="#local-6989586621679193247"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a><span> </span><a href="#local-6989586621679193246"><span class="hs-identifier hs-var">con_name</span></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193247"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-131"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier hs-var">DataConI</span><span> </span><a name="local-6989586621679193248"><a href="#local-6989586621679193248"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679193249"><a href="#local-6989586621679193249"><span class="hs-identifier">_type</span></a></a><span> </span><a name="local-6989586621679193250"><a href="#local-6989586621679193250"><span class="hs-identifier">parent_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193250"><span class="hs-identifier hs-var">parent_name</span></a><span>
</span><a name="line-133"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">_type</span><span> </span><span class="hs-identifier">parent_name</span><span> </span><span class="hs-identifier">_fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">parent_name</span><span>
</span><a name="line-135"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;The name &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679193246"><span class="hs-identifier hs-var">con_name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; does not appear to be &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-137"></a><span>                </span><span class="hs-string">&quot;a data constructor.&quot;</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | From the name of a data constructor, retrieve its definition as a @Con@</span><span>
</span><a name="line-140"></a><span class="hs-identifier">dataConNameToCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193207"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193207"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Con</span><span>
</span><a name="line-141"></a><a name="dataConNameToCon"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier">dataConNameToCon</span></a></a><span> </span><a name="local-6989586621679193251"><a href="#local-6989586621679193251"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-comment">-- we need to get the field ordering from the constructor. We must reify</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-comment">-- the constructor to get the tycon, and then reify the tycon to get the `Con`s</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-6989586621679193259"><a href="#local-6989586621679193259"><span class="hs-identifier">type_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a><span> </span><a href="#local-6989586621679193251"><span class="hs-identifier hs-var">con_name</span></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679193260"><a href="#local-6989586621679193260"><span class="hs-identifier">cons</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a><span> </span><span class="hs-string">&quot;This seems to be an error in GHC.&quot;</span><span> </span><a href="#local-6989586621679193259"><span class="hs-identifier hs-var">type_name</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679193261"><a href="#local-6989586621679193261"><span class="hs-identifier">m_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193251"><span class="hs-identifier hs-var">con_name</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679193252"><span class="hs-identifier hs-var">get_con_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193260"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-147"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193261"><span class="hs-identifier hs-var">m_con</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193262"><a href="#local-6989586621679193262"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193262"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a><span> </span><span class="hs-string">&quot;Datatype does not contain one of its own constructors.&quot;</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-6989586621679193252"><a href="#local-6989586621679193252"><span class="hs-identifier">get_con_name</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679193253"><a href="#local-6989586621679193253"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193253"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">get_con_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679193254"><a href="#local-6989586621679193254"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193254"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">get_con_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193255"><a href="#local-6989586621679193255"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193255"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">get_con_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193256"><a href="#local-6989586621679193256"><span class="hs-identifier">con</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193252"><span class="hs-identifier hs-var">get_con_name</span></a><span> </span><a href="#local-6989586621679193256"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-156"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">get_con_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GadtC</span><span> </span><a name="local-6989586621679193257"><a href="#local-6989586621679193257"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193257"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier">get_con_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><a name="local-6989586621679193258"><a href="#local-6989586621679193258"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193258"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-159"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-161"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- DsMonad</span><span>
</span><a name="line-163"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- | A 'DsMonad' stores some list of declarations that should be considered</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- in scope. 'DsM' is the prototypical inhabitant of 'DsMonad'.</span><span>
</span><a name="line-167"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Quasi</span><span> </span><a href="#local-6989586621679192443"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="DsMonad"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier">DsMonad</span></a></a><span> </span><a name="local-6989586621679192443"><a href="#local-6989586621679192443"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-168"></a><span>  </span><span class="hs-comment">-- | Produce a list of local declarations.</span><span>
</span><a name="line-169"></a><span>  </span><a name="localDeclarations"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679192443"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-172"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-173"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | A convenient implementation of the 'DsMonad' class. Use by calling</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- 'withLocalDeclarations'.</span><span>
</span><a name="line-178"></a><span class="hs-keyword">newtype</span><span> </span><a name="DsM"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier">DsM</span></a></a><span> </span><a name="local-6989586621679192283"><a href="#local-6989586621679192283"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679192284"><a href="#local-6989586621679192284"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DsM"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier">DsM</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679192283"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679192284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Quasi</span><span>
</span><a name="line-180"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fail.MonadFail</span><span>
</span><a name="line-182"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__ &gt;= 803
</span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span>
</span><a name="line-185"></a><span class="hs-cpp">#endif
</span><span>           </span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Quasi</span><span> </span><a href="#local-6989586621679193033"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="#local-6989586621679193033"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-var">DsM</span></a><span> </span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193031"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679193032"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679193031"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679192895"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679192896"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679192895"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-195"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679192592"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679192593"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679192593"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679192592"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679192444"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679192445"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679192446"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679192445"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679192447"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679192444"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-201"></a><span>  </span><a name="local-8214565720323967157"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier">localDeclarations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Add a list of declarations to be considered when reifying local</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- declarations.</span><span>
</span><a name="line-205"></a><span class="hs-identifier">withLocalDeclarations</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193205"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="#local-6989586621679193205"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679193206"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193205"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679193206"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-206"></a><a name="withLocalDeclarations"><a href="Language.Haskell.TH.Desugar.Reify.html#withLocalDeclarations"><span class="hs-identifier">withLocalDeclarations</span></a></a><span> </span><a name="local-6989586621679193263"><a href="#local-6989586621679193263"><span class="hs-identifier">new_decs</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-var">DsM</span></a><span> </span><a name="local-6989586621679193264"><a href="#local-6989586621679193264"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-207"></a><span>  </span><a name="local-6989586621679193265"><a href="#local-6989586621679193265"><span class="hs-identifier">orig_decs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-identifier">runReaderT</span><span> </span><a href="#local-6989586621679193264"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193265"><span class="hs-identifier hs-var">orig_decs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193263"><span class="hs-identifier hs-var">new_decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- Reifying local declarations</span><span>
</span><a name="line-212"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Look through a list of declarations and possibly return a relevant 'Info'</span><span>
</span><a name="line-215"></a><span class="hs-identifier">reifyInDecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-216"></a><a name="reifyInDecs"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier">reifyInDecs</span></a></a><span> </span><a name="local-6989586621679193266"><a href="#local-6989586621679193266"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193267"><a href="#local-6989586621679193267"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a><span> </span><a href="#local-6989586621679193266"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193267"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193267"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- | Look through a list of declarations and possibly return a fixity.</span><span>
</span><a name="line-219"></a><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Fixity</span><span>
</span><a name="line-220"></a><a name="reifyFixityInDecs"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier">reifyFixityInDecs</span></a></a><span> </span><a name="local-6989586621679193283"><a href="#local-6989586621679193283"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-var">match_fixity</span></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-222"></a><span>    </span><a name="local-6989586621679193284"><a href="#local-6989586621679193284"><span class="hs-identifier">match_fixity</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixD</span><span> </span><a name="local-6989586621679193285"><a href="#local-6989586621679193285"><span class="hs-identifier">fixity</span></a></a><span> </span><a name="local-6989586621679193286"><a href="#local-6989586621679193286"><span class="hs-identifier">n'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193283"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193286"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193285"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-223"></a><span>    </span><span class="hs-identifier">match_fixity</span><span> </span><span class="hs-identifier">_</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | A reified thing along with the name of that thing.</span><span>
</span><a name="line-226"></a><span class="hs-keyword">type</span><span> </span><a name="Named"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier">Named</span></a></a><span> </span><a name="local-6989586621679192282"><a href="#local-6989586621679192282"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679192282"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Info</span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><a name="reifyInDec"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier">reifyInDec</span></a></a><span> </span><a name="local-6989586621679193287"><a href="#local-6989586621679193287"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193288"><a href="#local-6989586621679193288"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunD</span><span> </span><a name="local-6989586621679193289"><a href="#local-6989586621679193289"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193289"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193289"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-var">mkVarI</span></a><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193288"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193290"><a href="#local-6989586621679193290"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193291"><a href="#local-6989586621679193291"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValD</span><span> </span><a name="local-6989586621679193292"><a href="#local-6989586621679193292"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193293"><a href="#local-6989586621679193293"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span> </span><a href="#local-6989586621679193290"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.elems</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a><span> </span><a href="#local-6989586621679193292"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193293"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-var">mkVarI</span></a><span> </span><a href="#local-6989586621679193290"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193291"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193294"><a href="#local-6989586621679193294"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><a name="local-6989586621679193295"><a href="#local-6989586621679193295"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataD</span><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193296"><a href="#local-6989586621679193296"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193294"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193296"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193296"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">TyConI</span><span> </span><a href="#local-6989586621679193295"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193297"><a href="#local-6989586621679193297"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><a name="local-6989586621679193298"><a href="#local-6989586621679193298"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193299"><a href="#local-6989586621679193299"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193297"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193299"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193299"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">TyConI</span><span> </span><a href="#local-6989586621679193298"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-identifier">dec</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-identifier">dec</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span class="hs-cpp">#endif
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193300"><a href="#local-6989586621679193300"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><a name="local-6989586621679193301"><a href="#local-6989586621679193301"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynD</span><span> </span><a name="local-6989586621679193302"><a href="#local-6989586621679193302"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193300"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193302"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193302"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">TyConI</span><span> </span><a href="#local-6989586621679193301"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193303"><a href="#local-6989586621679193303"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193304"><a href="#local-6989586621679193304"><span class="hs-identifier">decs</span></a></a><span> </span><a name="local-6989586621679193305"><a href="#local-6989586621679193305"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193306"><a href="#local-6989586621679193306"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193303"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193306"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193306"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ClassI</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#stripClassDec"><span class="hs-identifier hs-var">stripClassDec</span></a><span> </span><a href="#local-6989586621679193305"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a><span> </span><a href="#local-6989586621679193303"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193304"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193307"><a href="#local-6989586621679193307"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193308"><a href="#local-6989586621679193308"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForeignD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ImportF</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193309"><a href="#local-6989586621679193309"><span class="hs-identifier">n'</span></a></a><span> </span><a name="local-6989586621679193310"><a href="#local-6989586621679193310"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193307"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193309"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193309"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a><span> </span><a href="#local-6989586621679193307"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193308"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193310"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193311"><a href="#local-6989586621679193311"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193312"><a href="#local-6989586621679193312"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForeignD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExportF</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193313"><a href="#local-6989586621679193313"><span class="hs-identifier">n'</span></a></a><span> </span><a name="local-6989586621679193314"><a href="#local-6989586621679193314"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193311"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193313"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193313"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a><span> </span><a href="#local-6989586621679193311"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193312"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193314"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193315"><a href="#local-6989586621679193315"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193316"><a href="#local-6989586621679193316"><span class="hs-identifier">decs</span></a></a><span> </span><a name="local-6989586621679193317"><a href="#local-6989586621679193317"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">OpenTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeFamilyHead</span><span> </span><a name="local-6989586621679193318"><a href="#local-6989586621679193318"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193315"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193318"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-248"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193318"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">FamilyI</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#handleBug8884"><span class="hs-identifier hs-var">handleBug8884</span></a><span> </span><a href="#local-6989586621679193317"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a><span> </span><a href="#local-6989586621679193315"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193316"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193319"><a href="#local-6989586621679193319"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193320"><a href="#local-6989586621679193320"><span class="hs-identifier">decs</span></a></a><span> </span><a name="local-6989586621679193321"><a href="#local-6989586621679193321"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamilyD</span><span> </span><a name="local-6989586621679193322"><a href="#local-6989586621679193322"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193319"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193322"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193322"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">FamilyI</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#handleBug8884"><span class="hs-identifier hs-var">handleBug8884</span></a><span> </span><a href="#local-6989586621679193321"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a><span> </span><a href="#local-6989586621679193319"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193320"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193323"><a href="#local-6989586621679193323"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><a name="local-6989586621679193324"><a href="#local-6989586621679193324"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClosedTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeFamilyHead</span><span> </span><a name="local-6989586621679193325"><a href="#local-6989586621679193325"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193323"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193325"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-252"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193325"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">FamilyI</span><span> </span><a href="#local-6989586621679193324"><span class="hs-identifier hs-var">dec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FamilyI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">handleBug8884</span><span> </span><span class="hs-identifier">dec</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">findInstances</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 707
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FamilyI</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span class="hs-cpp">#endif
#endif
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193326"><a href="#local-6989586621679193326"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193327"><a href="#local-6989586621679193327"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatSynD</span><span> </span><a name="local-6989586621679193328"><a href="#local-6989586621679193328"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193326"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193328"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-263"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193328"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkPatSynI"><span class="hs-identifier hs-var">mkPatSynI</span></a><span> </span><a href="#local-6989586621679193326"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193327"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-266"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193329"><a href="#local-6989586621679193329"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193330"><a href="#local-6989586621679193330"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193331"><a href="#local-6989586621679193331"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193332"><a href="#local-6989586621679193332"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193333"><a href="#local-6989586621679193333"><span class="hs-identifier">_mk</span></a></a><span> </span><a name="local-6989586621679193334"><a href="#local-6989586621679193334"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193335"><a href="#local-6989586621679193335"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a><span> </span><a href="#local-6989586621679193329"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193330"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193331"><span class="hs-identifier hs-var">ty_name</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var">tvbToType</span></a><span> </span><a href="#local-6989586621679193332"><span class="hs-identifier hs-var">tvbs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193334"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193335"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-270"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193336"><a href="#local-6989586621679193336"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193337"><a href="#local-6989586621679193337"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193338"><a href="#local-6989586621679193338"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193339"><a href="#local-6989586621679193339"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193340"><a href="#local-6989586621679193340"><span class="hs-identifier">_mk</span></a></a><span> </span><a name="local-6989586621679193341"><a href="#local-6989586621679193341"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193342"><a href="#local-6989586621679193342"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a><span> </span><a href="#local-6989586621679193336"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193337"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193338"><span class="hs-identifier hs-var">ty_name</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var">tvbToType</span></a><span> </span><a href="#local-6989586621679193339"><span class="hs-identifier hs-var">tvbs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193341"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193342"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-273"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToType</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">cons</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><a name="line-277"></a><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToType</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><a name="line-280"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193343"><a href="#local-6989586621679193343"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193344"><a href="#local-6989586621679193344"><span class="hs-identifier">_decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193345"><a href="#local-6989586621679193345"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193346"><a href="#local-6989586621679193346"><span class="hs-identifier">tvbs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193347"><a href="#local-6989586621679193347"><span class="hs-identifier">sub_decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193348"><a href="#local-6989586621679193348"><span class="hs-identifier">n'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679193349"><a href="#local-6989586621679193349"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-var">findType</span></a><span> </span><a href="#local-6989586621679193343"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193347"><span class="hs-identifier hs-var">sub_decs</span></a><span>
</span><a name="line-284"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193348"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ClassOpI</span><span> </span><a href="#local-6989586621679193343"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#addClassCxt"><span class="hs-identifier hs-var">addClassCxt</span></a><span> </span><a href="#local-6989586621679193345"><span class="hs-identifier hs-var">ty_name</span></a><span> </span><a href="#local-6989586621679193346"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193349"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193345"><span class="hs-identifier hs-var">ty_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">sub_decs</span><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">findType</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">sub_decs</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">addClassCxt</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>                       </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-290"></a><span>                                </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">sub_decs</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span class="hs-cpp">#endif
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193350"><a href="#local-6989586621679193350"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193351"><a href="#local-6989586621679193351"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193352"><a href="#local-6989586621679193352"><span class="hs-identifier">sub_decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193353"><a href="#local-6989586621679193353"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a><span> </span><a href="#local-6989586621679193350"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193352"><span class="hs-identifier hs-var">sub_decs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193351"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193352"><span class="hs-identifier hs-var">sub_decs</span></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193353"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-295"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 711
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193354"><a href="#local-6989586621679193354"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193355"><a href="#local-6989586621679193355"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193356"><a href="#local-6989586621679193356"><span class="hs-identifier">sub_decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">sub_decs</span><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span class="hs-cpp">#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193360"><a href="#local-6989586621679193360"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193357"><span class="hs-identifier hs-var">reify_in_instance</span></a><span> </span><a href="#local-6989586621679193356"><span class="hs-identifier hs-var">sub_decs</span></a><span>
</span><a name="line-301"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193360"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-303"></a><span>    </span><a name="local-6989586621679193357"><a href="#local-6989586621679193357"><span class="hs-identifier">reify_in_instance</span></a></a><span> </span><a name="local-6989586621679193358"><a href="#local-6989586621679193358"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataInstD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a><span> </span><a href="#local-6989586621679193354"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193356"><span class="hs-identifier hs-var">sub_decs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193355"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193358"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-304"></a><span>    </span><span class="hs-identifier">reify_in_instance</span><span> </span><a name="local-6989586621679193359"><a href="#local-6989586621679193359"><span class="hs-identifier">dec</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeInstD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a><span> </span><a href="#local-6989586621679193354"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193356"><span class="hs-identifier hs-var">sub_decs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193355"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193359"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-305"></a><span>    </span><span class="hs-identifier">reify_in_instance</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-306"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193361"><a href="#local-6989586621679193361"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193362"><a href="#local-6989586621679193362"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193363"><a href="#local-6989586621679193363"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193364"><a href="#local-6989586621679193364"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193365"><a href="#local-6989586621679193365"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193366"><a href="#local-6989586621679193366"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a><span> </span><a href="#local-6989586621679193361"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193362"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193363"><span class="hs-identifier hs-var">ty_name</span></a><span> </span><a href="#local-6989586621679193364"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679193365"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193366"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-310"></a><span class="hs-identifier">reifyInDec</span><span> </span><a name="local-6989586621679193367"><a href="#local-6989586621679193367"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193368"><a href="#local-6989586621679193368"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193369"><a href="#local-6989586621679193369"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193370"><a href="#local-6989586621679193370"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193371"><a href="#local-6989586621679193371"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193372"><a href="#local-6989586621679193372"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a><span> </span><a href="#local-6989586621679193367"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193368"><span class="hs-identifier hs-var">decs</span></a><span> </span><a href="#local-6989586621679193369"><span class="hs-identifier hs-var">ty_name</span></a><span> </span><a href="#local-6989586621679193370"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193371"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193372"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-313"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><a name="line-317"></a><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><a name="line-320"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-322"></a><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Info</span><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><a name="maybeReifyCon"><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier">maybeReifyCon</span></a></a><span> </span><a name="local-6989586621679193373"><a href="#local-6989586621679193373"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193374"><a href="#local-6989586621679193374"><span class="hs-identifier">_decs</span></a></a><span> </span><a name="local-6989586621679193375"><a href="#local-6989586621679193375"><span class="hs-identifier">ty_name</span></a></a><span> </span><a name="local-6989586621679193376"><a href="#local-6989586621679193376"><span class="hs-identifier">ty_args</span></a></a><span> </span><a name="local-6989586621679193377"><a href="#local-6989586621679193377"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-327"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193392"><a href="#local-6989586621679193392"><span class="hs-identifier">n'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679193393"><a href="#local-6989586621679193393"><span class="hs-identifier">con</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#findCon"><span class="hs-identifier hs-var">findCon</span></a><span> </span><a href="#local-6989586621679193373"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193377"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-328"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193392"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">DataConI</span><span> </span><a href="#local-6989586621679193373"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-var">maybeForallT</span></a><span> </span><a href="#local-6989586621679193380"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679193379"><span class="hs-identifier hs-var">con_to_type</span></a><span> </span><a href="#local-6989586621679193393"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193375"><span class="hs-identifier hs-var">ty_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-identifier">cons</span><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">findCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">cons</span><span>
</span><a name="line-332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maybeForallT</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>                         </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">fixity</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-336"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193394"><a href="#local-6989586621679193394"><span class="hs-identifier">n'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679193395"><a href="#local-6989586621679193395"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#findRecSelector"><span class="hs-identifier hs-var">findRecSelector</span></a><span> </span><a href="#local-6989586621679193373"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193377"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-337"></a><span>      </span><span class="hs-comment">-- we don't try to ferret out naughty record selectors.</span><span>
</span><a name="line-338"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193394"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">VarI</span><span> </span><a href="#local-6989586621679193373"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-var">maybeForallT</span></a><span> </span><a href="#local-6989586621679193380"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193378"><span class="hs-identifier hs-var">result_ty</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679193395"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span class="hs-cpp">#else
</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maybeForallT</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkArrows</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">result_ty</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">fixity</span><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span class="hs-cpp">#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-344"></a><span>    </span><a name="local-6989586621679193378"><a href="#local-6989586621679193378"><span class="hs-identifier">result_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="#local-6989586621679193375"><span class="hs-identifier hs-var">ty_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193376"><span class="hs-identifier hs-var">ty_args</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span>    </span><a name="local-6989586621679193379"><a href="#local-6989586621679193379"><span class="hs-identifier">con_to_type</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193381"><a href="#local-6989586621679193381"><span class="hs-identifier">stys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>    </span><a href="#local-6989586621679193381"><span class="hs-identifier hs-var">stys</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679193378"><span class="hs-identifier hs-var">result_ty</span></a><span>
</span><a name="line-347"></a><span>    </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193382"><a href="#local-6989586621679193382"><span class="hs-identifier">vstys</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a><span> </span><a href="#local-6989586621679193382"><span class="hs-identifier hs-var">vstys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193378"><span class="hs-identifier hs-var">result_ty</span></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><a name="local-6989586621679193383"><a href="#local-6989586621679193383"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193384"><a href="#local-6989586621679193384"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193383"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193384"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193378"><span class="hs-identifier hs-var">result_ty</span></a><span>
</span><a name="line-349"></a><span>    </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallC</span><span> </span><a name="local-6989586621679193385"><a href="#local-6989586621679193385"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621679193386"><a href="#local-6989586621679193386"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679193387"><a href="#local-6989586621679193387"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679193385"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679193386"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193379"><span class="hs-identifier hs-var">con_to_type</span></a><span> </span><a href="#local-6989586621679193387"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GadtC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193388"><a href="#local-6989586621679193388"><span class="hs-identifier">stys</span></a></a><span> </span><a name="local-6989586621679193389"><a href="#local-6989586621679193389"><span class="hs-identifier">rty</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>    </span><a href="#local-6989586621679193388"><span class="hs-identifier hs-var">stys</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679193389"><span class="hs-identifier hs-var">rty</span></a><span>
</span><a name="line-352"></a><span>    </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193390"><a href="#local-6989586621679193390"><span class="hs-identifier">vstys</span></a></a><span> </span><a name="local-6989586621679193391"><a href="#local-6989586621679193391"><span class="hs-identifier">rty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a><span> </span><a href="#local-6989586621679193390"><span class="hs-identifier hs-var">vstys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193391"><span class="hs-identifier hs-var">rty</span></a><span>
</span><a name="line-353"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__ &lt; 711
</span><span>    </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span>
</span><a name="line-356"></a><span class="hs-cpp">#endif
</span><span>    </span><a name="local-6989586621679193380"><a href="#local-6989586621679193380"><span class="hs-identifier">tvbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">PlainTV</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">S.elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#freeNamesOfTypes"><span class="hs-identifier hs-var">freeNamesOfTypes</span></a><span> </span><a href="#local-6989586621679193376"><span class="hs-identifier hs-var">ty_args</span></a><span>
</span><a name="line-358"></a><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">mkVarI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-361"></a><a name="mkVarI"><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier">mkVarI</span></a></a><span> </span><a name="local-6989586621679193396"><a href="#local-6989586621679193396"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193397"><a href="#local-6989586621679193397"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a><span> </span><a href="#local-6989586621679193396"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193397"><span class="hs-identifier hs-var">decs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-var">no_type</span></a><span> </span><a href="#local-6989586621679193396"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-var">findType</span></a><span> </span><a href="#local-6989586621679193396"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193397"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">mkVarITy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-364"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><a name="mkVarITy"><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier">mkVarITy</span></a></a><span> </span><a name="local-6989586621679193398"><a href="#local-6989586621679193398"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193399"><a href="#local-6989586621679193399"><span class="hs-identifier">_decs</span></a></a><span> </span><a name="local-6989586621679193400"><a href="#local-6989586621679193400"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VarI</span><span> </span><a href="#local-6989586621679193398"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193400"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-366"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">mkVarITy</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-368"></a><span>                                        </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-371"></a><span class="hs-identifier">findType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><a name="findType"><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier">findType</span></a></a><span> </span><a name="local-6989586621679193401"><a href="#local-6989586621679193401"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193402"><span class="hs-identifier hs-var">match_type</span></a><span>
</span><a name="line-373"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-374"></a><span>    </span><a name="local-6989586621679193402"><a href="#local-6989586621679193402"><span class="hs-identifier">match_type</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigD</span><span> </span><a name="local-6989586621679193403"><a href="#local-6989586621679193403"><span class="hs-identifier">n'</span></a></a><span> </span><a name="local-6989586621679193404"><a href="#local-6989586621679193404"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193401"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193403"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193403"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193404"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-identifier">match_type</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-identifier">mkPatSynI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Info</span><span>
</span><a name="line-379"></a><a name="mkPatSynI"><a href="Language.Haskell.TH.Desugar.Reify.html#mkPatSynI"><span class="hs-identifier">mkPatSynI</span></a></a><span> </span><a name="local-6989586621679193405"><a href="#local-6989586621679193405"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193406"><a href="#local-6989586621679193406"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PatSynI</span><span> </span><a href="#local-6989586621679193405"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-var">no_type</span></a><span> </span><a href="#local-6989586621679193405"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#findPatSynType"><span class="hs-identifier hs-var">findPatSynType</span></a><span> </span><a href="#local-6989586621679193405"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679193406"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-identifier">findPatSynType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PatSynType</span><span>
</span><a name="line-382"></a><a name="findPatSynType"><a href="Language.Haskell.TH.Desugar.Reify.html#findPatSynType"><span class="hs-identifier">findPatSynType</span></a></a><span> </span><a name="local-6989586621679193407"><a href="#local-6989586621679193407"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193408"><span class="hs-identifier hs-var">match_pat_syn_type</span></a><span>
</span><a name="line-383"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-384"></a><span>    </span><a name="local-6989586621679193408"><a href="#local-6989586621679193408"><span class="hs-identifier">match_pat_syn_type</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatSynSigD</span><span> </span><a name="local-6989586621679193409"><a href="#local-6989586621679193409"><span class="hs-identifier">n'</span></a></a><span> </span><a name="local-6989586621679193410"><a href="#local-6989586621679193410"><span class="hs-identifier">psty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193407"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193409"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193410"><span class="hs-identifier hs-var">psty</span></a><span>
</span><a name="line-385"></a><span>    </span><span class="hs-identifier">match_pat_syn_type</span><span> </span><span class="hs-identifier">_</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-386"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-388"></a><span class="hs-identifier">no_type</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-389"></a><a name="no_type"><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier">no_type</span></a></a><span> </span><a name="local-6989586621679193411"><a href="#local-6989586621679193411"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;No type information found in local declaration for &quot;</span><span>
</span><a name="line-390"></a><span>                    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679193411"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-identifier">findInstances</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-393"></a><a name="findInstances"><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier">findInstances</span></a></a><span> </span><a name="local-6989586621679193412"><a href="#local-6989586621679193412"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier hs-var">stripInstanceDec</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679193413"><span class="hs-identifier hs-var">match_instance</span></a><span>
</span><a name="line-394"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-395"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 711
</span><span>    </span><a name="local-6989586621679193413"><a href="#local-6989586621679193413"><span class="hs-identifier">match_instance</span></a></a><span> </span><a name="local-6989586621679193415"><a href="#local-6989586621679193415"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193416"><a href="#local-6989586621679193416"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span class="hs-cpp">#endif
</span><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679193417"><a href="#local-6989586621679193417"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679193414"><span class="hs-identifier hs-var">ty_head</span></a><span> </span><a href="#local-6989586621679193416"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-401"></a><span>                                               </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193412"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193417"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193415"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-402"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><a name="local-6989586621679193418"><a href="#local-6989586621679193418"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193419"><a href="#local-6989586621679193419"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193412"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193419"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193418"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-404"></a><span>    </span><span class="hs-identifier">match_instance</span><span> </span><a name="local-6989586621679193420"><a href="#local-6989586621679193420"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193421"><a href="#local-6989586621679193421"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193412"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193421"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193420"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-405"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><a name="line-408"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__ &gt;= 707
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><a name="local-6989586621679193422"><a href="#local-6989586621679193422"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynInstD</span><span> </span><a name="local-6989586621679193423"><a href="#local-6989586621679193423"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193412"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193423"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193422"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-411"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><a name="line-413"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-415"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 711
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193424"><a href="#local-6989586621679193424"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span class="hs-cpp">#endif
</span><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679193413"><span class="hs-identifier hs-var">match_instance</span></a><span> </span><a href="#local-6989586621679193424"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-421"></a><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span>    </span><a name="local-6989586621679193414"><a href="#local-6989586621679193414"><span class="hs-identifier">ty_head</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193425"><a href="#local-6989586621679193425"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193414"><span class="hs-identifier hs-var">ty_head</span></a><span> </span><a href="#local-6989586621679193425"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-424"></a><span>    </span><span class="hs-identifier">ty_head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><a name="local-6989586621679193426"><a href="#local-6989586621679193426"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193414"><span class="hs-identifier hs-var">ty_head</span></a><span> </span><a href="#local-6989586621679193426"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-425"></a><span>    </span><span class="hs-identifier">ty_head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679193427"><a href="#local-6989586621679193427"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193414"><span class="hs-identifier hs-var">ty_head</span></a><span> </span><a href="#local-6989586621679193427"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-426"></a><span>    </span><span class="hs-identifier">ty_head</span><span> </span><a name="local-6989586621679193428"><a href="#local-6989586621679193428"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193428"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-identifier">stripClassDec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Dec</span><span>
</span><a name="line-429"></a><a name="stripClassDec"><a href="Language.Haskell.TH.Desugar.Reify.html#stripClassDec"><span class="hs-identifier">stripClassDec</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassD</span><span> </span><a name="local-6989586621679193429"><a href="#local-6989586621679193429"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679193430"><a href="#local-6989586621679193430"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193431"><a href="#local-6989586621679193431"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193432"><a href="#local-6989586621679193432"><span class="hs-identifier">fds</span></a></a><span> </span><a name="local-6989586621679193433"><a href="#local-6989586621679193433"><span class="hs-identifier">sub_decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ClassD</span><span> </span><a href="#local-6989586621679193429"><span class="hs-identifier hs-var">cxt</span></a><span> </span><a href="#local-6989586621679193430"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679193431"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193432"><span class="hs-identifier hs-var">fds</span></a><span> </span><a href="#local-6989586621679193434"><span class="hs-identifier hs-var">sub_decs'</span></a><span>
</span><a name="line-431"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-432"></a><span>    </span><a name="local-6989586621679193434"><a href="#local-6989586621679193434"><span class="hs-identifier">sub_decs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="#local-6989586621679193435"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679193433"><span class="hs-identifier hs-var">sub_decs</span></a><span>
</span><a name="line-433"></a><span>    </span><a name="local-6989586621679193435"><a href="#local-6989586621679193435"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigD</span><span> </span><a name="local-6989586621679193436"><a href="#local-6989586621679193436"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679193437"><a href="#local-6989586621679193437"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SigD</span><span> </span><a href="#local-6989586621679193436"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#addClassCxt"><span class="hs-identifier hs-var">addClassCxt</span></a><span> </span><a href="#local-6989586621679193430"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679193431"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193437"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-434"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679193438"><a href="#local-6989586621679193438"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">OpenTypeFamilyD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193438"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-436"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679193439"><a href="#local-6989586621679193439"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamilyD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193439"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-437"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-439"></a><span class="hs-identifier">stripClassDec</span><span> </span><a name="local-6989586621679193440"><a href="#local-6989586621679193440"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193440"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-identifier">addClassCxt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-442"></a><a name="addClassCxt"><a href="Language.Haskell.TH.Desugar.Reify.html#addClassCxt"><span class="hs-identifier">addClassCxt</span></a></a><span> </span><a name="local-6989586621679193441"><a href="#local-6989586621679193441"><span class="hs-identifier">class_name</span></a></a><span> </span><a name="local-6989586621679193442"><a href="#local-6989586621679193442"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193443"><a href="#local-6989586621679193443"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679193442"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193444"><span class="hs-identifier hs-var">class_cxt</span></a><span> </span><a href="#local-6989586621679193443"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-443"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-444"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 709
</span><span>    </span><span class="hs-identifier">class_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">class_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToType</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-446"></a><span class="hs-cpp">#else
</span><span>    </span><a name="local-6989586621679193444"><a href="#local-6989586621679193444"><span class="hs-identifier">class_cxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="#local-6989586621679193441"><span class="hs-identifier hs-var">class_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var">tvbToType</span></a><span> </span><a href="#local-6989586621679193442"><span class="hs-identifier hs-var">tvbs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-448"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-450"></a><span class="hs-identifier">stripInstanceDec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Dec</span><span>
</span><a name="line-451"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 711
</span><a name="stripInstanceDec"><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier">stripInstanceDec</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InstanceD</span><span> </span><a name="local-6989586621679193445"><a href="#local-6989586621679193445"><span class="hs-identifier">over</span></a></a><span> </span><a name="local-6989586621679193446"><a href="#local-6989586621679193446"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679193447"><a href="#local-6989586621679193447"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InstanceD</span><span> </span><a href="#local-6989586621679193445"><span class="hs-identifier hs-var">over</span></a><span> </span><a href="#local-6989586621679193446"><span class="hs-identifier hs-var">cxt</span></a><span> </span><a href="#local-6989586621679193447"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-453"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">stripInstanceDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-455"></a><span class="hs-cpp">#endif
</span><span class="hs-identifier">stripInstanceDec</span><span> </span><a name="local-6989586621679193448"><a href="#local-6989586621679193448"><span class="hs-identifier">dec</span></a></a><span>                       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193448"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-identifier">mkArrows</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-459"></a><a name="mkArrows"><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier">mkArrows</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621679193449"><a href="#local-6989586621679193449"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193449"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-460"></a><span class="hs-identifier">mkArrows</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193450"><a href="#local-6989586621679193450"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679193451"><a href="#local-6989586621679193451"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679193452"><a href="#local-6989586621679193452"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-identifier hs-var">ArrowT</span><span> </span><a href="#local-6989586621679193450"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a><span> </span><a href="#local-6989586621679193451"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621679193452"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-identifier">maybeForallT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Cxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-463"></a><a name="maybeForallT"><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier">maybeForallT</span></a></a><span> </span><a name="local-6989586621679193453"><a href="#local-6989586621679193453"><span class="hs-identifier">tvbs</span></a></a><span> </span><a name="local-6989586621679193454"><a href="#local-6989586621679193454"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679193455"><a href="#local-6989586621679193455"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-464"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679193453"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679193454"><span class="hs-identifier hs-var">cxt</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193455"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><a name="local-6989586621679193456"><a href="#local-6989586621679193456"><span class="hs-identifier">tvbs2</span></a></a><span> </span><a name="local-6989586621679193457"><a href="#local-6989586621679193457"><span class="hs-identifier">cxt2</span></a></a><span> </span><a name="local-6989586621679193458"><a href="#local-6989586621679193458"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679193455"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193453"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193456"><span class="hs-identifier hs-var">tvbs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193454"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679193457"><span class="hs-identifier hs-var">cxt2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193458"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-466"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679193453"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679193454"><span class="hs-identifier hs-var">cxt</span></a><span> </span><a href="#local-6989586621679193455"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-identifier">findCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Con</span><span class="hs-special">)</span><span>
</span><a name="line-469"></a><a name="findCon"><a href="Language.Haskell.TH.Desugar.Reify.html#findCon"><span class="hs-identifier">findCon</span></a></a><span> </span><a name="local-6989586621679193459"><a href="#local-6989586621679193459"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193460"><span class="hs-identifier hs-var">match_con</span></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-471"></a><span>    </span><span class="hs-identifier">match_con</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Con</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Con</span><span class="hs-special">)</span><span>
</span><a name="line-472"></a><span>    </span><a name="local-6989586621679193460"><a href="#local-6989586621679193460"><span class="hs-identifier">match_con</span></a></a><span> </span><a name="local-6989586621679193462"><a href="#local-6989586621679193462"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-473"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-474"></a><span>        </span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679193463"><a href="#local-6989586621679193463"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193459"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193463"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193463"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679193464"><a href="#local-6989586621679193464"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193459"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193464"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193464"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>        </span><span class="hs-identifier hs-var">InfixC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193465"><a href="#local-6989586621679193465"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193459"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193465"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193465"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span>        </span><span class="hs-identifier hs-var">ForallC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193466"><a href="#local-6989586621679193466"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193460"><span class="hs-identifier hs-var">match_con</span></a><span> </span><a href="#local-6989586621679193466"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-478"></a><span>                           </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193467"><a href="#local-6989586621679193467"><span class="hs-identifier">n'</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193467"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>                           </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-480"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>        </span><span class="hs-identifier hs-var">GadtC</span><span> </span><a name="local-6989586621679193468"><a href="#local-6989586621679193468"><span class="hs-identifier">nms</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193461"><span class="hs-identifier hs-var">gadt_case</span></a><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621679193468"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-482"></a><span>        </span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><a name="local-6989586621679193469"><a href="#local-6989586621679193469"><span class="hs-identifier">nms</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193461"><span class="hs-identifier hs-var">gadt_case</span></a><span> </span><a href="#local-6989586621679193462"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621679193469"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-483"></a><span class="hs-cpp">#endif
</span><span>        </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">gadt_case</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Con</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Con</span><span class="hs-special">)</span><span>
</span><a name="line-488"></a><span>    </span><a name="local-6989586621679193461"><a href="#local-6989586621679193461"><span class="hs-identifier">gadt_case</span></a></a><span> </span><a name="local-6989586621679193470"><a href="#local-6989586621679193470"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679193471"><a href="#local-6989586621679193471"><span class="hs-identifier">nms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193459"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193471"><span class="hs-identifier hs-var">nms</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-489"></a><span>                          </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679193472"><a href="#local-6989586621679193472"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193472"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193470"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>                          </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-491"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-493"></a><span class="hs-identifier">findRecSelector</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-494"></a><a name="findRecSelector"><a href="Language.Haskell.TH.Desugar.Reify.html#findRecSelector"><span class="hs-identifier">findRecSelector</span></a></a><span> </span><a name="local-6989586621679193473"><a href="#local-6989586621679193473"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193474"><span class="hs-identifier hs-var">match_con</span></a><span>
</span><a name="line-495"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-496"></a><span>    </span><a name="local-6989586621679193474"><a href="#local-6989586621679193474"><span class="hs-identifier">match_con</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193476"><a href="#local-6989586621679193476"><span class="hs-identifier">vstys</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193475"><span class="hs-identifier hs-var">match_rec_sel</span></a><span> </span><a href="#local-6989586621679193476"><span class="hs-identifier hs-var">vstys</span></a><span>
</span><a name="line-497"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-identifier">match_con</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193477"><a href="#local-6989586621679193477"><span class="hs-identifier">vstys</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><a href="#local-6989586621679193475"><span class="hs-identifier hs-var">match_rec_sel</span></a><span> </span><a href="#local-6989586621679193477"><span class="hs-identifier hs-var">vstys</span></a><span>
</span><a name="line-499"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">match_con</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193478"><a href="#local-6989586621679193478"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193474"><span class="hs-identifier hs-var">match_con</span></a><span> </span><a href="#local-6989586621679193478"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-501"></a><span>    </span><span class="hs-identifier">match_con</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>    </span><a name="local-6989586621679193475"><a href="#local-6989586621679193475"><span class="hs-identifier">match_rec_sel</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679193479"><a href="#local-6989586621679193479"><span class="hs-identifier">n'</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679193480"><a href="#local-6989586621679193480"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679193473"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679193479"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193479"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193480"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>    </span><span class="hs-identifier">match_rec_sel</span><span> </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-identifier">handleBug8884</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Dec</span><span>
</span><a name="line-507"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 707
</span><a name="handleBug8884"><a href="Language.Haskell.TH.Desugar.Reify.html#handleBug8884"><span class="hs-identifier">handleBug8884</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-509"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">handleBug8884</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">flav</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_kind</span><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">flav</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">stupid_kind</span><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-513"></a><span>    </span><span class="hs-identifier">kind_from_maybe</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">StarT</span><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier">tvb_kind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlainTV</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-515"></a><span>    </span><span class="hs-identifier">tvb_kind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">KindedTV</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">k</span><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span>    </span><span class="hs-identifier">result_kind</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">kind_from_maybe</span><span> </span><span class="hs-identifier">m_kind</span><span>
</span><a name="line-518"></a><span>    </span><span class="hs-identifier">args_kinds</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">kind_from_maybe</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">tvb_kind</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>    </span><span class="hs-identifier">stupid_kind</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkArrows</span><span> </span><span class="hs-identifier">args_kinds</span><span> </span><span class="hs-identifier">result_kind</span><span>
</span><a name="line-521"></a><span class="hs-identifier">handleBug8884</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dec</span><span>
</span><a name="line-522"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-524"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-525"></a><span class="hs-comment">-- Reifying fixities</span><span>
</span><a name="line-526"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-527"></a><span class="hs-comment">--</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- This section allows GHC 7.x to call reifyFixity</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 711
</span><span class="hs-identifier">qReifyFixity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Quasi</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Fixity</span><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span class="hs-identifier">qReifyFixity</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-533"></a><span>  </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">qReify</span><span> </span><span class="hs-identifier">name</span><span>
</span><a name="line-534"></a><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-535"></a><span>    </span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><a name="line-537"></a><span>    </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><a name="line-538"></a><span>    </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span class="hs-comment">{- | @reifyFixity nm@ attempts to find a fixity declaration for @nm@. For
example, if the function @foo@ has the fixity declaration @infixr 7 foo@, then
@reifyFixity 'foo@ would return @'Just' ('Fixity' 7 'InfixR')@. If the function
@bar@ does not have a fixity declaration, then @reifyFixity 'bar@ returns
'Nothing', so you may assume @bar@ has 'defaultFixity'.
-}</span><span>
</span><a name="line-546"></a><span class="hs-identifier">reifyFixity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Fixity</span><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span class="hs-identifier">reifyFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qReifyFixity</span><span>
</span><a name="line-548"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-550"></a><span class="hs-comment">-- | Like 'reifyWithLocals_maybe', but for fixities. Note that a return of</span><span>
</span><a name="line-551"></a><span class="hs-comment">-- @Nothing@ might mean that the name is not in scope, or it might mean</span><span>
</span><a name="line-552"></a><span class="hs-comment">-- that the name has no assigned fixity. (Use 'reifyWithLocals_maybe' if</span><span>
</span><a name="line-553"></a><span class="hs-comment">-- you really need to tell the difference.)</span><span>
</span><a name="line-554"></a><span class="hs-identifier">reifyFixityWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193204"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193204"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Fixity</span><span class="hs-special">)</span><span>
</span><a name="line-555"></a><a name="reifyFixityWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier">reifyFixityWithLocals</span></a></a><span> </span><a name="local-6989586621679193481"><a href="#local-6989586621679193481"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">qRecover</span><span>
</span><a name="line-556"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier hs-var">reifyFixityInDecs</span></a><span> </span><a href="#local-6989586621679193481"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">qReifyFixity</span><span> </span><a href="#local-6989586621679193481"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- Lookuping name value and type names</span><span>
</span><a name="line-561"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-562"></a><span>
</span><a name="line-563"></a><span class="hs-comment">-- | Like 'lookupValueName' from Template Haskell, but looks also in 'Names' of</span><span>
</span><a name="line-564"></a><span class="hs-comment">-- not-yet-typechecked declarations. To establish this list of not-yet-typechecked</span><span>
</span><a name="line-565"></a><span class="hs-comment">-- declarations, use 'withLocalDeclarations'. Returns 'Nothing' if no value</span><span>
</span><a name="line-566"></a><span class="hs-comment">-- with the same name can be found.</span><span>
</span><a name="line-567"></a><span class="hs-identifier">lookupValueNameWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193203"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193203"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-568"></a><a name="lookupValueNameWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier">lookupValueNameWithLocals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-var">lookupNameWithLocals</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span class="hs-comment">-- | Like 'lookupTypeName' from Template Haskell, but looks also in 'Names' of</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- not-yet-typechecked declarations. To establish this list of not-yet-typechecked</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- declarations, use 'withLocalDeclarations'. Returns 'Nothing' if no type</span><span>
</span><a name="line-573"></a><span class="hs-comment">-- with the same name can be found.</span><span>
</span><a name="line-574"></a><span class="hs-identifier">lookupTypeNameWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193202"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193202"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-575"></a><a name="lookupTypeNameWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier">lookupTypeNameWithLocals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-var">lookupNameWithLocals</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-identifier">lookupNameWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193201"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193201"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-578"></a><a name="lookupNameWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier">lookupNameWithLocals</span></a></a><span> </span><a name="local-6989586621679193482"><a href="#local-6989586621679193482"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679193483"><a href="#local-6989586621679193483"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-579"></a><span>    </span><a name="local-6989586621679193495"><a href="#local-6989586621679193495"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">qLookupName</span><span> </span><a href="#local-6989586621679193482"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679193483"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-580"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193495"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-581"></a><span>      </span><a name="local-6989586621679193496"><a href="#local-6989586621679193496"><span class="hs-identifier">j_name</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193496"><span class="hs-identifier hs-var">j_name</span></a><span>
</span><a name="line-582"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193485"><span class="hs-identifier hs-var">consult_locals</span></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-584"></a><span>    </span><a name="local-6989586621679193484"><a href="#local-6989586621679193484"><span class="hs-identifier">built_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkName</span><span> </span><a href="#local-6989586621679193483"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span>    </span><a name="local-6989586621679193485"><a href="#local-6989586621679193485"><span class="hs-identifier">consult_locals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-587"></a><span>      </span><a name="local-6989586621679193488"><a href="#local-6989586621679193488"><span class="hs-identifier">decs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a><span>
</span><a name="line-588"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679193489"><a href="#local-6989586621679193489"><span class="hs-identifier">mb_infos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a><span> </span><a href="#local-6989586621679193484"><span class="hs-identifier hs-var">built_name</span></a><span> </span><a href="#local-6989586621679193488"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193488"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-589"></a><span>          </span><a name="local-6989586621679193490"><a href="#local-6989586621679193490"><span class="hs-identifier">infos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><a href="#local-6989586621679193489"><span class="hs-identifier hs-var">mb_infos</span></a><span>
</span><a name="line-590"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679193482"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679193486"><span class="hs-identifier hs-var">find_type_name</span></a><span>
</span><a name="line-591"></a><span>                                 </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679193487"><span class="hs-identifier hs-var">find_value_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193490"><span class="hs-identifier hs-var">infos</span></a><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span>    </span><span class="hs-comment">-- These functions work over Named Infos so we can avoid performing</span><span>
</span><a name="line-594"></a><span>    </span><span class="hs-comment">-- tiresome pattern-matching to retrieve the name associated with each Info.</span><span>
</span><a name="line-595"></a><span>    </span><span class="hs-identifier">find_type_name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">find_value_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a><span> </span><span class="hs-identifier hs-type">Info</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-596"></a><span>    </span><a name="local-6989586621679193486"><a href="#local-6989586621679193486"><span class="hs-identifier">find_type_name</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679193491"><a href="#local-6989586621679193491"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679193492"><a href="#local-6989586621679193492"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-597"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a><span> </span><a href="#local-6989586621679193492"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-598"></a><span>        </span><span class="hs-identifier hs-var">TcClsName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193491"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-599"></a><span>        </span><span class="hs-identifier hs-var">VarName</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-600"></a><span>        </span><span class="hs-identifier hs-var">DataName</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span>    </span><a name="local-6989586621679193487"><a href="#local-6989586621679193487"><span class="hs-identifier">find_value_name</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679193493"><a href="#local-6989586621679193493"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679193494"><a href="#local-6989586621679193494"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-603"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a><span> </span><a href="#local-6989586621679193494"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-604"></a><span>        </span><span class="hs-identifier hs-var">VarName</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193493"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-605"></a><span>        </span><span class="hs-identifier hs-var">DataName</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193493"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-606"></a><span>        </span><span class="hs-identifier hs-var">TcClsName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-comment">-- | Like TH's @lookupValueName@, but if this name is not bound, then we assume</span><span>
</span><a name="line-609"></a><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><a name="line-610"></a><span class="hs-comment">--</span><span>
</span><a name="line-611"></a><span class="hs-comment">-- Unlike 'mkDataName', this also consults the local declarations in scope when</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- determining if the name is currently bound.</span><span>
</span><a name="line-613"></a><span class="hs-identifier">mkDataNameWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193200"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193200"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-614"></a><a name="mkDataNameWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#mkDataNameWithLocals"><span class="hs-identifier">mkDataNameWithLocals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier hs-var">lookupValueNameWithLocals</span></a><span> </span><span class="hs-identifier hs-var">mkNameG_d</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span class="hs-comment">-- | Like TH's @lookupTypeName@, but if this name is not bound, then we assume</span><span>
</span><a name="line-617"></a><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><a name="line-618"></a><span class="hs-comment">--</span><span>
</span><a name="line-619"></a><span class="hs-comment">-- Unlike 'mkTypeName', this also consults the local declarations in scope when</span><span>
</span><a name="line-620"></a><span class="hs-comment">-- determining if the name is currently bound.</span><span>
</span><a name="line-621"></a><span class="hs-identifier">mkTypeNameWithLocals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193199"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193199"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-622"></a><a name="mkTypeNameWithLocals"><a href="Language.Haskell.TH.Desugar.Reify.html#mkTypeNameWithLocals"><span class="hs-identifier">mkTypeNameWithLocals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier hs-var">lookupTypeNameWithLocals</span></a><span> </span><span class="hs-identifier hs-var">mkNameG_tc</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-comment">-- | Determines a `Name`'s 'NameSpace'. If the 'NameSpace' is attached to</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- the 'Name' itself (i.e., it is unambiguous), then that 'NameSpace' is</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- immediately returned. Otherwise, reification is used to lookup up the</span><span>
</span><a name="line-627"></a><span class="hs-comment">-- 'NameSpace' (consulting local declarations if necessary).</span><span>
</span><a name="line-628"></a><span class="hs-comment">--</span><span>
</span><a name="line-629"></a><span class="hs-comment">-- Note that if a 'Name' lives in two different 'NameSpaces' (which can</span><span>
</span><a name="line-630"></a><span class="hs-comment">-- genuinely happen--for instance, @'mkName' \&quot;==\&quot;@, where @==@ is both</span><span>
</span><a name="line-631"></a><span class="hs-comment">-- a function and a type family), then this function will simply return</span><span>
</span><a name="line-632"></a><span class="hs-comment">-- whichever 'NameSpace' is discovered first via reification. If you wish</span><span>
</span><a name="line-633"></a><span class="hs-comment">-- to find a 'Name' in a particular 'NameSpace', use the</span><span>
</span><a name="line-634"></a><span class="hs-comment">-- 'lookupValueNameWithLocals' or 'lookupTypeNameWithLocals' functions.</span><span>
</span><a name="line-635"></a><span class="hs-identifier">reifyNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a><span> </span><a href="#local-6989586621679193198"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193198"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">NameSpace</span><span class="hs-special">)</span><span>
</span><a name="line-636"></a><a name="reifyNameSpace"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyNameSpace"><span class="hs-identifier">reifyNameSpace</span></a></a><span> </span><a name="local-6989586621679193497"><a href="#local-6989586621679193497"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Name</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193498"><a href="#local-6989586621679193498"><span class="hs-identifier">nf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-637"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193498"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-638"></a><span>    </span><span class="hs-comment">-- NameGs are simple, as they have a NameSpace attached.</span><span>
</span><a name="line-639"></a><span>    </span><span class="hs-identifier hs-var">NameG</span><span> </span><a name="local-6989586621679193499"><a href="#local-6989586621679193499"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193499"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span>    </span><span class="hs-comment">-- For other names, we must use reification to determine what NameSpace</span><span>
</span><a name="line-642"></a><span>    </span><span class="hs-comment">-- it lives in (if any).</span><span>
</span><a name="line-643"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679193500"><a href="#local-6989586621679193500"><span class="hs-identifier">mb_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a><span> </span><a href="#local-6989586621679193497"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-644"></a><span>            </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a><span> </span><a href="#local-6989586621679193500"><span class="hs-identifier hs-var">mb_info</span></a><span>
</span><a name="line-645"></a><span>
</span><a name="line-646"></a><span class="hs-comment">-- | Determine a name's 'NameSpace' from its 'Info'.</span><span>
</span><a name="line-647"></a><span class="hs-identifier">infoNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Info</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NameSpace</span><span>
</span><a name="line-648"></a><a name="infoNameSpace"><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier">infoNameSpace</span></a></a><span> </span><a name="local-6989586621679193501"><a href="#local-6989586621679193501"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-649"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679193501"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-650"></a><span>    </span><span class="hs-identifier hs-var">ClassI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TcClsName</span><span>
</span><a name="line-651"></a><span>    </span><span class="hs-identifier hs-var">TyConI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TcClsName</span><span>
</span><a name="line-652"></a><span>    </span><span class="hs-identifier hs-var">FamilyI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TcClsName</span><span>
</span><a name="line-653"></a><span>    </span><span class="hs-identifier hs-var">PrimTyConI</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TcClsName</span><span>
</span><a name="line-654"></a><span>    </span><span class="hs-identifier hs-var">TyVarI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TcClsName</span><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span>    </span><span class="hs-identifier hs-var">ClassOpI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">VarName</span><span>
</span><a name="line-657"></a><span>    </span><span class="hs-identifier hs-var">VarI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">VarName</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span>    </span><span class="hs-identifier hs-var">DataConI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">DataName</span><span>
</span><a name="line-660"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>    </span><span class="hs-identifier hs-var">PatSynI</span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">DataName</span><span>
</span><a name="line-662"></a><span class="hs-cpp">#endif
</span></pre></body></html>